(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    113177,       2393]
NotebookOptionsPosition[    110100,       2291]
NotebookOutlinePosition[    110481,       2307]
CellTagsIndexPosition[    110438,       2304]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Klaus", "Title",
 CellChangeTimes->{{3.83474066012204*^9, 3.8347406618031206`*^9}}],

Cell["\<\
Quantum optical setup optimization assisted by propositional logic\
\>", "Subtitle",
 CellChangeTimes->{{3.834740676261134*^9, 3.8347406940175095`*^9}, {
  3.834749745004116*^9, 3.834749763726884*^9}}],

Cell[CellGroupData[{

Cell["Setting the problem", "Section",
 CellChangeTimes->{{3.828637692310732*^9, 3.8286376977252903`*^9}},
 ExpressionUUID -> "a07a82a8-17b9-4d0c-8e61-972f96da3089"],

Cell[CellGroupData[{

Cell["Target state", "Subsection",
 CellChangeTimes->{{3.834742121413145*^9, 3.834742124074437*^9}}],

Cell[TextData[{
 "We tested this algorithm to find the graph representation of the GHZ states \
of any number of parties and local dimension\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"|", 
       RowBox[{"GHZ", "(", 
        RowBox[{"n", ",", "d"}], ")"}]}], "\[RightAngleBracket]"}], "=", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        SqrtBox[
         SuperscriptBox["d", "n"]]], 
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], 
        RowBox[{"d", "-", "1"}]]}], "|", 
      RowBox[{
       RowBox[{
        SubscriptBox["i", "1"], "..."}], 
       RowBox[{"\[InvisiblePrefixScriptBase]", 
        SubscriptBox["i", "n"]}]}]}]}], "\[RightAngleBracket]"}], 
   TraditionalForm]],
  FormatType->"TraditionalForm"],
 " \nand highly entangled tri-partite states with different Schmidt Rank \
Vector (SRV). For states with an odd number of parties, we look for the \
heralded state, i.e., we tensor-product a |0\[RightAngleBracket] state."
}], "Text",
 CellChangeTimes->{{3.8347407986876917`*^9, 3.834740845484509*^9}, {
  3.834740894832101*^9, 3.834741016911101*^9}, {3.8347410485048285`*^9, 
  3.8347413720552435`*^9}, {3.834741840697282*^9, 3.834741852764527*^9}, {
  3.8347419718384714`*^9, 3.8347420016794214`*^9}, {3.8347421304911537`*^9, 
  3.8347421332087054`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GHZ", "[", 
   RowBox[{"n_", ",", "d_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ConstantArray", "[", 
     RowBox[{"i", ",", "n"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SRV544", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "1", ",", "3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SRV644", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "2"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SRV654", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SRV955", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "4", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "4", ",", "1"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8314618773947997`*^9, 3.831461983454973*^9}, {
   3.831462140539141*^9, 3.831462141528133*^9}, {3.831464062102363*^9, 
   3.8314640685973577`*^9}, {3.8314746955395184`*^9, 3.831474720553853*^9}, {
   3.831474809932808*^9, 3.8314748256632805`*^9}, {3.8314748764052606`*^9, 
   3.8314748968297462`*^9}, {3.8314749416320276`*^9, 
   3.8314749575904503`*^9}, {3.831474990627737*^9, 3.8314750695503225`*^9}, {
   3.831475897557233*^9, 3.831475918013197*^9}, {3.8314777606164436`*^9, 
   3.8314778187761655`*^9}, {3.8314780943898454`*^9, 3.831478094646113*^9}, 
   3.831493923139779*^9, {3.831577667307832*^9, 3.8315777086477785`*^9}, {
   3.8315780560916233`*^9, 3.831578110363468*^9}, {3.831584184412794*^9, 
   3.8315842463649263`*^9}, {3.831584613486063*^9, 3.8315846212609267`*^9}, {
   3.832010457321005*^9, 3.832010465688012*^9}, {3.832304667369259*^9, 
   3.8323047455344963`*^9}, {3.834741355003332*^9, 3.834741359354031*^9}, 
   3.834741396537224*^9, 3.8347421350281487`*^9}],

Cell["Select the target state:", "Text",
 CellChangeTimes->{{3.8347421469600663`*^9, 3.834742153475909*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"state", " ", "=", " ", 
   RowBox[{"GHZ", "[", 
    RowBox[{"4", ",", "3"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8347413878052826`*^9, 3.8347413945970373`*^9}, {
   3.8347416571388865`*^9, 3.8347417106750603`*^9}, {3.8347453332634225`*^9, 
   3.834745335728074*^9}, 3.8347495941092105`*^9, {3.8347498546400905`*^9, 
   3.8347498599265327`*^9}}],

Cell["\<\
The graph will contain as many vertices as number of parties (n) and the \
possible colors for each edge will be determined by the local dimension (d).\
\>", "Text",
 CellChangeTimes->{{3.834742165309769*^9, 3.8347422627650146`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "state", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], "\[NotEqual]", 
     "0"}], ",", 
    RowBox[{"state", " ", "=", 
     RowBox[{
      RowBox[{"Append", "[", "0", "]"}], "/@", "state"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<State basis elements: \>\"", ",", " ", "state"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pathmax", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"state", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmax", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", "state", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<number of parties (n) = \>\"", ",", " ", "pathmax"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", " ", 
  RowBox[{"\"\<number of colors (d) = \>\"", ",", " ", "cmax"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", " ", 
  RowBox[{"\"\<# basis elements = \>\"", ",", 
   RowBox[{"Length", "[", "state", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8285568905167108`*^9, 3.8285568924855337`*^9}, 
   3.8285569349300933`*^9, {3.8285601952623763`*^9, 3.8285602090625844`*^9}, 
   3.8285604746687813`*^9, {3.828560621695086*^9, 3.828560622071725*^9}, {
   3.828561235920785*^9, 3.828561249658967*^9}, {3.828561443170952*^9, 
   3.8285614621874886`*^9}, {3.8285619558737497`*^9, 3.8285619577332106`*^9}, 
   3.8285620081901217`*^9, 3.828564559934535*^9, {3.82856859847847*^9, 
   3.8285685989159913`*^9}, 3.8285714431452303`*^9, 3.8285716222457523`*^9, {
   3.8285719430910287`*^9, 3.828571946184923*^9}, 3.828573329677315*^9, {
   3.8286355322336693`*^9, 3.8286355385568933`*^9}, {3.8286355780366297`*^9, 
   3.8286355859249125`*^9}, {3.828636365532787*^9, 3.8286363656532164`*^9}, {
   3.828637291446828*^9, 3.828637291568937*^9}, {3.8286403949831953`*^9, 
   3.8286404019715652`*^9}, {3.828640702674228*^9, 3.8286407053482804`*^9}, {
   3.8286408378231354`*^9, 3.828640839956668*^9}, {3.8286411378970413`*^9, 
   3.8286411399004087`*^9}, {3.828641202498563*^9, 3.8286412042719536`*^9}, {
   3.8286969091022453`*^9, 3.828696945821905*^9}, {3.8286969891241283`*^9, 
   3.828697392107012*^9}, {3.8286989440382752`*^9, 3.828698981580079*^9}, {
   3.8287002705327725`*^9, 3.828700300250745*^9}, {3.828701780419053*^9, 
   3.8287018298270397`*^9}, {3.8287150871357946`*^9, 
   3.8287150952425933`*^9}, {3.8287151833595963`*^9, 3.8287152004341335`*^9}, 
   3.828715281790783*^9, {3.8287247414606876`*^9, 3.828724744883686*^9}, {
   3.828724937999462*^9, 3.8287249427709045`*^9}, {3.8287249842282963`*^9, 
   3.82872498682012*^9}, {3.828725038568946*^9, 3.8287250410515876`*^9}, {
   3.8287254534274125`*^9, 3.828725456064741*^9}, {3.8287261450637255`*^9, 
   3.8287261529013567`*^9}, {3.82872624504677*^9, 3.828726252695326*^9}, {
   3.828727861144233*^9, 3.8287278628005924`*^9}, {3.8308029166005745`*^9, 
   3.830802923005029*^9}, {3.830804290938986*^9, 3.8308043164416633`*^9}, {
   3.8308051070213714`*^9, 3.83080513189929*^9}, {3.830806212943901*^9, 
   3.830806314874281*^9}, {3.8308065738767104`*^9, 3.8308065784124928`*^9}, {
   3.8308066521579638`*^9, 3.8308066735163603`*^9}, {3.8308067525661383`*^9, 
   3.830806755453692*^9}, {3.8308069087204447`*^9, 3.830806927549199*^9}, {
   3.830854851633594*^9, 3.8308548753651886`*^9}, {3.8309464625398307`*^9, 
   3.83094656271091*^9}, {3.830948743099448*^9, 3.8309487549917064`*^9}, {
   3.830952033476364*^9, 3.8309520362360888`*^9}, {3.8310628995107536`*^9, 
   3.8310629119042187`*^9}, {3.831063205738948*^9, 3.8310632461664653`*^9}, {
   3.8311295924019375`*^9, 3.8311295930687747`*^9}, 3.831131835591666*^9, {
   3.831131896656737*^9, 3.8311319049473963`*^9}, {3.831148090767306*^9, 
   3.831148093782132*^9}, {3.8311481256991444`*^9, 3.8311481369550643`*^9}, {
   3.8311484975190887`*^9, 3.8311485087428207`*^9}, {3.831148671608079*^9, 
   3.8311486986848793`*^9}, {3.831151415029112*^9, 3.8311514189573407`*^9}, {
   3.8311516053387175`*^9, 3.8311516092016563`*^9}, 3.8311525751754727`*^9, {
   3.8311538106459227`*^9, 3.8311538168422594`*^9}, {3.831153858510036*^9, 
   3.831153890885989*^9}, 3.831154834691044*^9, {3.8312047782200584`*^9, 
   3.8312047910597973`*^9}, {3.8312057628780513`*^9, 3.831205780278996*^9}, {
   3.831207861708065*^9, 3.8312078676882615`*^9}, {3.8312079378660326`*^9, 
   3.8312079380429287`*^9}, {3.831207989274219*^9, 3.831207989399488*^9}, {
   3.831208678942237*^9, 3.831208679274067*^9}, {3.831209617689091*^9, 
   3.831209618900792*^9}, {3.8313060985510406`*^9, 3.831306100443753*^9}, {
   3.831310238706025*^9, 3.831310238955774*^9}, {3.83146197456402*^9, 
   3.8314620789035416`*^9}, 3.831462113821163*^9, {3.83146378908657*^9, 
   3.831463789388192*^9}, {3.83146427868756*^9, 3.831464279113372*^9}, {
   3.831465821587332*^9, 3.8314658397863054`*^9}, {3.831466048673684*^9, 
   3.831466048924904*^9}, 3.831474764024851*^9, {3.8314750188501105`*^9, 
   3.831475018983217*^9}, 3.8314759534446917`*^9, {3.8314778251142488`*^9, 
   3.8314778284699583`*^9}, {3.831479068899577*^9, 3.831479069221682*^9}, {
   3.8314939299792595`*^9, 3.8314939301392603`*^9}, {3.8315472457824316`*^9, 
   3.8315472476188307`*^9}, {3.8315479459651985`*^9, 
   3.8315479649810705`*^9}, {3.83154800696589*^9, 3.8315480071148148`*^9}, {
   3.8315482140657854`*^9, 3.8315482142568736`*^9}, {3.8315482629203167`*^9, 
   3.8315482701358395`*^9}, 3.8315486234478855`*^9, {3.8315495512352285`*^9, 
   3.8315495554321737`*^9}, {3.831549764492319*^9, 3.831549765092353*^9}, 
   3.831568040887986*^9, {3.83156808292037*^9, 3.8315680829828568`*^9}, 
   3.8315681352935305`*^9, {3.8315728790015936`*^9, 3.831572880614397*^9}, 
   3.8315730096078014`*^9, {3.8315730576570396`*^9, 3.831573058454728*^9}, {
   3.8315753571472034`*^9, 3.8315753696241903`*^9}, {3.8315754244774313`*^9, 
   3.831575424733043*^9}, {3.831577717436635*^9, 3.831577717705131*^9}, {
   3.8315791825739603`*^9, 3.831579187162383*^9}, {3.831584257822888*^9, 
   3.8315842583151054`*^9}, {3.8315846239521904`*^9, 
   3.8315846240267982`*^9}, {3.8320104757487087`*^9, 3.832010512026226*^9}, 
   3.832011211766298*^9, {3.832013623573371*^9, 3.8320136237139983`*^9}, {
   3.832014350417116*^9, 3.8320143506712203`*^9}, {3.832015088369503*^9, 
   3.832015096424452*^9}, 3.8320163262631025`*^9, {3.83230451604627*^9, 
   3.832304519139711*^9}, 3.832304716536887*^9, {3.832304758999318*^9, 
   3.8323047591278467`*^9}, {3.832304948758739*^9, 3.8323049490115643`*^9}, {
   3.834741401392434*^9, 3.8347415179955597`*^9}, {3.8347416149159403`*^9, 
   3.834741650272337*^9}, {3.834741872989637*^9, 3.8347418996649466`*^9}, {
   3.834741930927371*^9, 3.834741937920888*^9}, {3.8347420067503757`*^9, 
   3.834742108566307*^9}, {3.834742248766259*^9, 3.834742253855859*^9}},
 ExpressionUUID -> "9760a019-8346-4d65-ad46-21b7ce597fb3"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"State basis elements: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]}], "}"}]}],
  SequenceForm[
  "State basis elements: ", {{0, 0, 0, 0}, {1, 1, 1, 1}, {2, 2, 2, 2}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8286972389629955`*^9, {3.8286972771228876`*^9, 3.8286973040794477`*^9}, {
   3.828697373309499*^9, 3.8286973925091314`*^9}, 3.8286989826399317`*^9, {
   3.8287002858284025`*^9, 3.828700301034376*^9}, 3.82870183096319*^9, 
   3.8287116743725815`*^9, 3.82871388022532*^9, 3.828715207215643*^9, 
   3.8287152824393983`*^9, 3.8287196309079514`*^9, {3.8287247458948193`*^9, 
   3.828724763473403*^9}, 3.8287249536090803`*^9, 3.828724997162219*^9, 
   3.8287250436352215`*^9, 3.828725459464368*^9, 3.8287261581266375`*^9, 
   3.8287262584675083`*^9, 3.828727461969286*^9, {3.8287278632693453`*^9, 
   3.828727889741331*^9}, 3.8308029795401564`*^9, 3.8308043183214397`*^9, 
   3.830805132411755*^9, {3.8308062718652515`*^9, 3.8308063153526645`*^9}, 
   3.8308065801918716`*^9, 3.8308066741676474`*^9, 3.8308067572326503`*^9, 
   3.830806928573909*^9, 3.8308555105097895`*^9, 3.830946564499009*^9, 
   3.8309469090924644`*^9, 3.8309487569835896`*^9, 3.8309509453818245`*^9, 
   3.8310535802908506`*^9, 3.831062913123316*^9, {3.831063223671028*^9, 
   3.8310632468233347`*^9}, 3.8311138646693044`*^9, 3.831118129293767*^9, 
   3.8311318370271997`*^9, 3.8311319055455017`*^9, 3.8311332619140987`*^9, 
   3.831133345518193*^9, 3.8311334229801917`*^9, 3.8311478215450554`*^9, 
   3.8311480949171906`*^9, 3.8311481383761926`*^9, {3.8311486838139114`*^9, 
   3.8311486993177943`*^9}, 3.831149980730213*^9, 3.831151229334722*^9, 
   3.831151419914904*^9, 3.8311516096562243`*^9, 3.831152582896985*^9, {
   3.831153886653679*^9, 3.831153891614458*^9}, 3.8311548364967813`*^9, 
   3.83120479822985*^9, 3.831205412794499*^9, {3.831205783636875*^9, 
   3.831205797461563*^9}, {3.8312078799589863`*^9, 3.8312078881512084`*^9}, {
   3.8312079391892924`*^9, 3.8312079480897975`*^9}, 3.831207989808286*^9, 
   3.831208683961857*^9, 3.831209621676447*^9, 3.8313061057522097`*^9, 
   3.831310239487177*^9, 3.8313159936649237`*^9, {3.831462107708538*^9, 
   3.831462145014356*^9}, 3.831462844599182*^9, 3.8314637974128075`*^9, {
   3.831464284072832*^9, 3.8314642896120877`*^9}, {3.831465827551945*^9, 
   3.831465840984326*^9}, 3.8314660498471375`*^9, 3.8314747646708236`*^9, 
   3.8314748294774747`*^9, 3.831474899193644*^9, 3.8314749602787204`*^9, 
   3.831475078003682*^9, 3.8314759572746906`*^9, 3.8314778304345293`*^9, 
   3.8314781090598936`*^9, 3.831479070048974*^9, 3.831480914537033*^9, 
   3.831481027167573*^9, 3.831493930875705*^9, 3.831547248367175*^9, {
   3.8315479465112567`*^9, 3.8315479653116813`*^9}, 3.8315480075140095`*^9, 
   3.831548215450108*^9, 3.8315482707902765`*^9, 3.831548625053161*^9, 
   3.831549194519114*^9, 3.8315495561364827`*^9, 3.8315497653377748`*^9, 
   3.8315680413952236`*^9, 3.8315680833063707`*^9, 3.8315681366781416`*^9, 
   3.831572754319397*^9, 3.831572881123384*^9, 3.831573010746132*^9, 
   3.831573058799736*^9, {3.831575357567088*^9, 3.8315753699500065`*^9}, 
   3.8315754251099033`*^9, 3.831577730994399*^9, {3.831579187674114*^9, 
   3.831579215918906*^9}, 3.8315842589899874`*^9, 3.8315846244372106`*^9, 
   3.8320112132505207`*^9, 3.83201287693528*^9, 3.8320136350152354`*^9, 
   3.8320143515561147`*^9, 3.832015102756445*^9, 3.8320163312166023`*^9, 
   3.8323045207385387`*^9, 3.8323047179111094`*^9, {3.8323047538496337`*^9, 
   3.832304759804618*^9}, 3.8323049497387652`*^9, {3.834741902019503*^9, 
   3.8347419534961004`*^9}, {3.8347420775948153`*^9, 3.8347421109411635`*^9}, 
   3.8347453378750906`*^9, 3.83474924391693*^9, 3.8347496014238725`*^9, 
   3.8347497759705925`*^9, 3.834749865513006*^9, 3.8347499018263187`*^9},
 ExpressionUUID -> "61e90243-b10c-41b6-954c-8682893863a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"number of parties (n) = \"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["number of parties (n) = ", 4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8286972389629955`*^9, {3.8286972771228876`*^9, 3.8286973040794477`*^9}, {
   3.828697373309499*^9, 3.8286973925091314`*^9}, 3.8286989826399317`*^9, {
   3.8287002858284025`*^9, 3.828700301034376*^9}, 3.82870183096319*^9, 
   3.8287116743725815`*^9, 3.82871388022532*^9, 3.828715207215643*^9, 
   3.8287152824393983`*^9, 3.8287196309079514`*^9, {3.8287247458948193`*^9, 
   3.828724763473403*^9}, 3.8287249536090803`*^9, 3.828724997162219*^9, 
   3.8287250436352215`*^9, 3.828725459464368*^9, 3.8287261581266375`*^9, 
   3.8287262584675083`*^9, 3.828727461969286*^9, {3.8287278632693453`*^9, 
   3.828727889741331*^9}, 3.8308029795401564`*^9, 3.8308043183214397`*^9, 
   3.830805132411755*^9, {3.8308062718652515`*^9, 3.8308063153526645`*^9}, 
   3.8308065801918716`*^9, 3.8308066741676474`*^9, 3.8308067572326503`*^9, 
   3.830806928573909*^9, 3.8308555105097895`*^9, 3.830946564499009*^9, 
   3.8309469090924644`*^9, 3.8309487569835896`*^9, 3.8309509453818245`*^9, 
   3.8310535802908506`*^9, 3.831062913123316*^9, {3.831063223671028*^9, 
   3.8310632468233347`*^9}, 3.8311138646693044`*^9, 3.831118129293767*^9, 
   3.8311318370271997`*^9, 3.8311319055455017`*^9, 3.8311332619140987`*^9, 
   3.831133345518193*^9, 3.8311334229801917`*^9, 3.8311478215450554`*^9, 
   3.8311480949171906`*^9, 3.8311481383761926`*^9, {3.8311486838139114`*^9, 
   3.8311486993177943`*^9}, 3.831149980730213*^9, 3.831151229334722*^9, 
   3.831151419914904*^9, 3.8311516096562243`*^9, 3.831152582896985*^9, {
   3.831153886653679*^9, 3.831153891614458*^9}, 3.8311548364967813`*^9, 
   3.83120479822985*^9, 3.831205412794499*^9, {3.831205783636875*^9, 
   3.831205797461563*^9}, {3.8312078799589863`*^9, 3.8312078881512084`*^9}, {
   3.8312079391892924`*^9, 3.8312079480897975`*^9}, 3.831207989808286*^9, 
   3.831208683961857*^9, 3.831209621676447*^9, 3.8313061057522097`*^9, 
   3.831310239487177*^9, 3.8313159936649237`*^9, {3.831462107708538*^9, 
   3.831462145014356*^9}, 3.831462844599182*^9, 3.8314637974128075`*^9, {
   3.831464284072832*^9, 3.8314642896120877`*^9}, {3.831465827551945*^9, 
   3.831465840984326*^9}, 3.8314660498471375`*^9, 3.8314747646708236`*^9, 
   3.8314748294774747`*^9, 3.831474899193644*^9, 3.8314749602787204`*^9, 
   3.831475078003682*^9, 3.8314759572746906`*^9, 3.8314778304345293`*^9, 
   3.8314781090598936`*^9, 3.831479070048974*^9, 3.831480914537033*^9, 
   3.831481027167573*^9, 3.831493930875705*^9, 3.831547248367175*^9, {
   3.8315479465112567`*^9, 3.8315479653116813`*^9}, 3.8315480075140095`*^9, 
   3.831548215450108*^9, 3.8315482707902765`*^9, 3.831548625053161*^9, 
   3.831549194519114*^9, 3.8315495561364827`*^9, 3.8315497653377748`*^9, 
   3.8315680413952236`*^9, 3.8315680833063707`*^9, 3.8315681366781416`*^9, 
   3.831572754319397*^9, 3.831572881123384*^9, 3.831573010746132*^9, 
   3.831573058799736*^9, {3.831575357567088*^9, 3.8315753699500065`*^9}, 
   3.8315754251099033`*^9, 3.831577730994399*^9, {3.831579187674114*^9, 
   3.831579215918906*^9}, 3.8315842589899874`*^9, 3.8315846244372106`*^9, 
   3.8320112132505207`*^9, 3.83201287693528*^9, 3.8320136350152354`*^9, 
   3.8320143515561147`*^9, 3.832015102756445*^9, 3.8320163312166023`*^9, 
   3.8323045207385387`*^9, 3.8323047179111094`*^9, {3.8323047538496337`*^9, 
   3.832304759804618*^9}, 3.8323049497387652`*^9, {3.834741902019503*^9, 
   3.8347419534961004`*^9}, {3.8347420775948153`*^9, 3.8347421109411635`*^9}, 
   3.8347453378750906`*^9, 3.83474924391693*^9, 3.8347496014238725`*^9, 
   3.8347497759705925`*^9, 3.834749865513006*^9, 3.834749901834324*^9},
 ExpressionUUID -> "61e90243-b10c-41b6-954c-8682893863a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"number of colors (d) = \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["number of colors (d) = ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8286972389629955`*^9, {3.8286972771228876`*^9, 3.8286973040794477`*^9}, {
   3.828697373309499*^9, 3.8286973925091314`*^9}, 3.8286989826399317`*^9, {
   3.8287002858284025`*^9, 3.828700301034376*^9}, 3.82870183096319*^9, 
   3.8287116743725815`*^9, 3.82871388022532*^9, 3.828715207215643*^9, 
   3.8287152824393983`*^9, 3.8287196309079514`*^9, {3.8287247458948193`*^9, 
   3.828724763473403*^9}, 3.8287249536090803`*^9, 3.828724997162219*^9, 
   3.8287250436352215`*^9, 3.828725459464368*^9, 3.8287261581266375`*^9, 
   3.8287262584675083`*^9, 3.828727461969286*^9, {3.8287278632693453`*^9, 
   3.828727889741331*^9}, 3.8308029795401564`*^9, 3.8308043183214397`*^9, 
   3.830805132411755*^9, {3.8308062718652515`*^9, 3.8308063153526645`*^9}, 
   3.8308065801918716`*^9, 3.8308066741676474`*^9, 3.8308067572326503`*^9, 
   3.830806928573909*^9, 3.8308555105097895`*^9, 3.830946564499009*^9, 
   3.8309469090924644`*^9, 3.8309487569835896`*^9, 3.8309509453818245`*^9, 
   3.8310535802908506`*^9, 3.831062913123316*^9, {3.831063223671028*^9, 
   3.8310632468233347`*^9}, 3.8311138646693044`*^9, 3.831118129293767*^9, 
   3.8311318370271997`*^9, 3.8311319055455017`*^9, 3.8311332619140987`*^9, 
   3.831133345518193*^9, 3.8311334229801917`*^9, 3.8311478215450554`*^9, 
   3.8311480949171906`*^9, 3.8311481383761926`*^9, {3.8311486838139114`*^9, 
   3.8311486993177943`*^9}, 3.831149980730213*^9, 3.831151229334722*^9, 
   3.831151419914904*^9, 3.8311516096562243`*^9, 3.831152582896985*^9, {
   3.831153886653679*^9, 3.831153891614458*^9}, 3.8311548364967813`*^9, 
   3.83120479822985*^9, 3.831205412794499*^9, {3.831205783636875*^9, 
   3.831205797461563*^9}, {3.8312078799589863`*^9, 3.8312078881512084`*^9}, {
   3.8312079391892924`*^9, 3.8312079480897975`*^9}, 3.831207989808286*^9, 
   3.831208683961857*^9, 3.831209621676447*^9, 3.8313061057522097`*^9, 
   3.831310239487177*^9, 3.8313159936649237`*^9, {3.831462107708538*^9, 
   3.831462145014356*^9}, 3.831462844599182*^9, 3.8314637974128075`*^9, {
   3.831464284072832*^9, 3.8314642896120877`*^9}, {3.831465827551945*^9, 
   3.831465840984326*^9}, 3.8314660498471375`*^9, 3.8314747646708236`*^9, 
   3.8314748294774747`*^9, 3.831474899193644*^9, 3.8314749602787204`*^9, 
   3.831475078003682*^9, 3.8314759572746906`*^9, 3.8314778304345293`*^9, 
   3.8314781090598936`*^9, 3.831479070048974*^9, 3.831480914537033*^9, 
   3.831481027167573*^9, 3.831493930875705*^9, 3.831547248367175*^9, {
   3.8315479465112567`*^9, 3.8315479653116813`*^9}, 3.8315480075140095`*^9, 
   3.831548215450108*^9, 3.8315482707902765`*^9, 3.831548625053161*^9, 
   3.831549194519114*^9, 3.8315495561364827`*^9, 3.8315497653377748`*^9, 
   3.8315680413952236`*^9, 3.8315680833063707`*^9, 3.8315681366781416`*^9, 
   3.831572754319397*^9, 3.831572881123384*^9, 3.831573010746132*^9, 
   3.831573058799736*^9, {3.831575357567088*^9, 3.8315753699500065`*^9}, 
   3.8315754251099033`*^9, 3.831577730994399*^9, {3.831579187674114*^9, 
   3.831579215918906*^9}, 3.8315842589899874`*^9, 3.8315846244372106`*^9, 
   3.8320112132505207`*^9, 3.83201287693528*^9, 3.8320136350152354`*^9, 
   3.8320143515561147`*^9, 3.832015102756445*^9, 3.8320163312166023`*^9, 
   3.8323045207385387`*^9, 3.8323047179111094`*^9, {3.8323047538496337`*^9, 
   3.832304759804618*^9}, 3.8323049497387652`*^9, {3.834741902019503*^9, 
   3.8347419534961004`*^9}, {3.8347420775948153`*^9, 3.8347421109411635`*^9}, 
   3.8347453378750906`*^9, 3.83474924391693*^9, 3.8347496014238725`*^9, 
   3.8347497759705925`*^9, 3.834749865513006*^9, 3.8347499018423195`*^9},
 ExpressionUUID -> "61e90243-b10c-41b6-954c-8682893863a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# basis elements = \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["# basis elements = ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8286972389629955`*^9, {3.8286972771228876`*^9, 3.8286973040794477`*^9}, {
   3.828697373309499*^9, 3.8286973925091314`*^9}, 3.8286989826399317`*^9, {
   3.8287002858284025`*^9, 3.828700301034376*^9}, 3.82870183096319*^9, 
   3.8287116743725815`*^9, 3.82871388022532*^9, 3.828715207215643*^9, 
   3.8287152824393983`*^9, 3.8287196309079514`*^9, {3.8287247458948193`*^9, 
   3.828724763473403*^9}, 3.8287249536090803`*^9, 3.828724997162219*^9, 
   3.8287250436352215`*^9, 3.828725459464368*^9, 3.8287261581266375`*^9, 
   3.8287262584675083`*^9, 3.828727461969286*^9, {3.8287278632693453`*^9, 
   3.828727889741331*^9}, 3.8308029795401564`*^9, 3.8308043183214397`*^9, 
   3.830805132411755*^9, {3.8308062718652515`*^9, 3.8308063153526645`*^9}, 
   3.8308065801918716`*^9, 3.8308066741676474`*^9, 3.8308067572326503`*^9, 
   3.830806928573909*^9, 3.8308555105097895`*^9, 3.830946564499009*^9, 
   3.8309469090924644`*^9, 3.8309487569835896`*^9, 3.8309509453818245`*^9, 
   3.8310535802908506`*^9, 3.831062913123316*^9, {3.831063223671028*^9, 
   3.8310632468233347`*^9}, 3.8311138646693044`*^9, 3.831118129293767*^9, 
   3.8311318370271997`*^9, 3.8311319055455017`*^9, 3.8311332619140987`*^9, 
   3.831133345518193*^9, 3.8311334229801917`*^9, 3.8311478215450554`*^9, 
   3.8311480949171906`*^9, 3.8311481383761926`*^9, {3.8311486838139114`*^9, 
   3.8311486993177943`*^9}, 3.831149980730213*^9, 3.831151229334722*^9, 
   3.831151419914904*^9, 3.8311516096562243`*^9, 3.831152582896985*^9, {
   3.831153886653679*^9, 3.831153891614458*^9}, 3.8311548364967813`*^9, 
   3.83120479822985*^9, 3.831205412794499*^9, {3.831205783636875*^9, 
   3.831205797461563*^9}, {3.8312078799589863`*^9, 3.8312078881512084`*^9}, {
   3.8312079391892924`*^9, 3.8312079480897975`*^9}, 3.831207989808286*^9, 
   3.831208683961857*^9, 3.831209621676447*^9, 3.8313061057522097`*^9, 
   3.831310239487177*^9, 3.8313159936649237`*^9, {3.831462107708538*^9, 
   3.831462145014356*^9}, 3.831462844599182*^9, 3.8314637974128075`*^9, {
   3.831464284072832*^9, 3.8314642896120877`*^9}, {3.831465827551945*^9, 
   3.831465840984326*^9}, 3.8314660498471375`*^9, 3.8314747646708236`*^9, 
   3.8314748294774747`*^9, 3.831474899193644*^9, 3.8314749602787204`*^9, 
   3.831475078003682*^9, 3.8314759572746906`*^9, 3.8314778304345293`*^9, 
   3.8314781090598936`*^9, 3.831479070048974*^9, 3.831480914537033*^9, 
   3.831481027167573*^9, 3.831493930875705*^9, 3.831547248367175*^9, {
   3.8315479465112567`*^9, 3.8315479653116813`*^9}, 3.8315480075140095`*^9, 
   3.831548215450108*^9, 3.8315482707902765`*^9, 3.831548625053161*^9, 
   3.831549194519114*^9, 3.8315495561364827`*^9, 3.8315497653377748`*^9, 
   3.8315680413952236`*^9, 3.8315680833063707`*^9, 3.8315681366781416`*^9, 
   3.831572754319397*^9, 3.831572881123384*^9, 3.831573010746132*^9, 
   3.831573058799736*^9, {3.831575357567088*^9, 3.8315753699500065`*^9}, 
   3.8315754251099033`*^9, 3.831577730994399*^9, {3.831579187674114*^9, 
   3.831579215918906*^9}, 3.8315842589899874`*^9, 3.8315846244372106`*^9, 
   3.8320112132505207`*^9, 3.83201287693528*^9, 3.8320136350152354`*^9, 
   3.8320143515561147`*^9, 3.832015102756445*^9, 3.8320163312166023`*^9, 
   3.8323045207385387`*^9, 3.8323047179111094`*^9, {3.8323047538496337`*^9, 
   3.832304759804618*^9}, 3.8323049497387652`*^9, {3.834741902019503*^9, 
   3.8347419534961004`*^9}, {3.8347420775948153`*^9, 3.8347421109411635`*^9}, 
   3.8347453378750906`*^9, 3.83474924391693*^9, 3.8347496014238725`*^9, 
   3.8347497759705925`*^9, 3.834749865513006*^9, 3.8347499018423195`*^9},
 ExpressionUUID -> "61e90243-b10c-41b6-954c-8682893863a9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate all Perfect Matchings (PM)", "Subsection",
 CellChangeTimes->{{3.831062992045633*^9, 3.831062993547321*^9}, {
  3.831129758035858*^9, 3.8311297663083076`*^9}, {3.8311483038593845`*^9, 
  3.831148311202926*^9}, {3.831460653895191*^9, 3.8314606574323273`*^9}, {
  3.834742267424892*^9, 3.834742272991848*^9}, {3.834742725897707*^9, 
  3.834742726969103*^9}, {3.8347429527796125`*^9, 3.834742953041315*^9}}],

Cell["\<\
- A Perfect Matching (PM) is an independent edge set that contains all \
vertices of the graph.
- In our problem, the color of each vertex is determined by the color of the \
incident edge. 
- Edges can be bicolored, which implies that a single edge can impose the \
same color in the connected vertices or two different colors.
- The vertex color combination determines the basis element generated. For \
example, a color combination of [blue, blue, red, green] generates the state \
|1102\[RightAngleBracket] (if we make the assigment red \[Rule] |0\
\[RightAngleBracket], blue \[Rule] |1\[RightAngleBracket] and greeen \[Rule] \
|2\[RightAngleBracket]).
- For each color combination, there can be more than one possible PM that \
generates it. The basis state amplitude will be determined by the sum of all \
PM that generate that state.\
\>", "Text",
 CellChangeTimes->{{3.8347424479868326`*^9, 3.834742453543836*^9}, {
  3.8347425047094803`*^9, 3.834742578128398*^9}, {3.83474260962731*^9, 
  3.8347427240484037`*^9}, {3.834742756512756*^9, 3.8347429313374805`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"t0", " ", "=", " ", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Name", " ", "the", " ", "vertices", " ", "with", " ", "letters"}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"set", "=", 
    RowBox[{"FromLetterNumber", "[", 
     RowBox[{"Range", "[", "pathmax", "]"}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Generate", " ", "all", " ", "possible", " ", "Perfect", " ", "Matchings", 
    " ", 
    RowBox[{"(", 
     RowBox[{"without", " ", "colors"}], ")"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PMpaths", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Flatten", ",", 
        RowBox[{"{", 
         RowBox[{"Union", "[", 
          RowBox[{"Sort", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sort", "/@", 
               RowBox[{"Partition", "[", 
                RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "/@", 
             RowBox[{"Permutations", "[", 
              RowBox[{"set", ",", 
               RowBox[{"{", "pathmax", "}"}]}], "]"}]}], ")"}]}], "]"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "3"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Generate", " ", "all", " ", "possible", " ", "color", " ", "combinations",
     " ", "of", " ", "the", " ", "vertices"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cols", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Range", "[", "cmax", "]"}], "-", "1"}], ",", 
     RowBox[{"{", "pathmax", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VertexColorings", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"cols", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"Ordering", "@", "#"}]}], "]"}], "]"}], "&"}], "/@", 
       "PMpaths"}], ",", "1"}], "]"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "List", " ", "with", " ", "all", " ", "vertex", " ", "colorings", " ", 
     "obtained", " ", "from", " ", "all", " ", "PM"}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Unique", " ", "vertex", " ", "colorings"}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "deleting"}], " ", "the", " ", 
      "duplicates"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"UniqueVertexColorings", "=", 
    RowBox[{"DeleteDuplicates", "[", "VertexColorings", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Assign", " ", "a", " ", "vertex", " ", "coloring", " ", "to", " ", "each",
     " ", "PM"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AllColoredPMsEasyEncoding", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"cols", "[", 
            RowBox[{"[", "#2", "]"}], "]"}], ",", 
           RowBox[{"PMpaths", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], ",", 
        RowBox[{"Length", "/@", 
         RowBox[{"{", 
          RowBox[{"PMpaths", ",", "cols"}], "}"}]}]}], "]"}], ",", "1"}], 
     "]"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Divide", " ", "the", " ", "PM", " ", "into", " ", "pairs", " ", 
    RowBox[{"(", 
     RowBox[{
     "that", " ", "will", " ", "correspond", " ", "to", " ", "the", " ", 
      "edge", " ", "weights"}], ")"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AllWeightsEasyEncoding", "=", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"TakeDrop", "[", 
               RowBox[{"#", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "/", "2"}]}], "]"}], 
              "&"}], "@", 
             RowBox[{"Partition", "[", 
              RowBox[{"#", ",", "2"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "2", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}]}], "}"}]}], "]"}], "&"}], ",", 
         "AllColoredPMsEasyEncoding"}], "]"}], ",", "1"}], "]"}], "]"}]}], 
   ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Translate", " ", "the", " ", "lists", " ", "into", " ", "weights"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"pathmax", "\[Equal]", "4"}], ",", 
    RowBox[{"replace", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "a1_", ",", "a2_", ",",
         "a3_", ",", "a4_"}], "}"}], "\[Rule]", 
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"c1", ",", "c2", ",", "a1", ",", "a2"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"c3", ",", "c4", ",", "a3", ",", "a4"}], "]"}]}]}]}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"pathmax", "\[Equal]", "6"}], ",", 
    RowBox[{"replace", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",",
         "a1_", ",", "a2_", ",", "a3_", ",", "a4_", ",", "a5_", ",", "a6_"}], 
       "}"}], "\[Rule]", 
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"c1", ",", "c2", ",", "a1", ",", "a2"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"c3", ",", "c4", ",", "a3", ",", "a4"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"c5", ",", "c6", ",", "a5", ",", "a6"}], "]"}]}]}]}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"pathmax", "\[Equal]", "8"}], ",", 
    RowBox[{"replace", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",",
         "c7_", ",", "c8_", ",", "a1_", ",", "a2_", ",", "a3_", ",", "a4_", 
        ",", "a5_", ",", "a6_", ",", "a7_", ",", "a8_"}], "}"}], "\[Rule]", 
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"c1", ",", "c2", ",", "a1", ",", "a2"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"c3", ",", "c4", ",", "a3", ",", "a4"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"c5", ",", "c6", ",", "a5", ",", "a6"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"c7", ",", "c8", ",", "a7", ",", "a8"}], "]"}]}]}]}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"pathmax", ">", "8"}], ",", 
    RowBox[{"Print", "[", "\"\<Write the replacement!\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllColoredPMs", " ", "=", 
   RowBox[{"AllColoredPMsEasyEncoding", "//.", "replace"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AllWeights", "=", 
    RowBox[{"AllWeightsEasyEncoding", "//.", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c1_", ",", "c2_", ",", "a1_", ",", "a2_"}], "}"}], "\[Rule]", 
      RowBox[{"w", "[", 
       RowBox[{"c1", ",", "c2", ",", "a1", ",", "a2"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", " ", "=", " ", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimePMgeneration", "=", 
   RowBox[{"t1", "-", "t0"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.830955378229126*^9, 3.830955403535102*^9}, {
   3.8310544603609095`*^9, 3.8310545941245127`*^9}, {3.8310547305195436`*^9, 
   3.831054744727934*^9}, {3.831054786338956*^9, 3.831054893177637*^9}, {
   3.8310549425679665`*^9, 3.831054954462621*^9}, {3.831056534656253*^9, 
   3.8310565468009377`*^9}, {3.8311297753751054`*^9, 
   3.8311298037027073`*^9}, {3.8311318550722294`*^9, 
   3.8311318581939774`*^9}, {3.8311481056668963`*^9, 
   3.8311481139653783`*^9}, {3.831148161197668*^9, 3.8311481853647747`*^9}, {
   3.8311483263895392`*^9, 3.8311484213691287`*^9}, 3.8311484532051306`*^9, {
   3.8311487262474904`*^9, 3.8311487271458435`*^9}, {3.8313061203962727`*^9, 
   3.8313061221383977`*^9}, {3.8314607048070884`*^9, 
   3.8314607140212345`*^9}, {3.831462160556904*^9, 3.8314621699803476`*^9}, {
   3.831546276257436*^9, 3.8315462925295825`*^9}, {3.8347422873814144`*^9, 
   3.834742437865074*^9}, {3.83474296399945*^9, 3.834743307001506*^9}}],

Cell["\<\
Now we have the list with all possible PM with their corresponding weights \
and all possible color combinations created by the edges.
The next step consist of identifying those PM that generate the same basis \
elements and split those basis elements that appear in the target state.\
\>", "Text",
 CellChangeTimes->{{3.8347433170476794`*^9, 3.8347434212210503`*^9}, {
  3.834743625399601*^9, 3.834743652625965*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", " ", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllColoredPMsOrdered", "=", 
   RowBox[{"AllColoredPMs", "[", 
    RowBox[{"[", 
     RowBox[{"Ordering", "@", "VertexColorings"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VertexColoringsOrdered", "=", 
    RowBox[{"Sort", "[", "VertexColorings", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Position", " ", "in", " ", "the", " ", "ordered", " ", "list", " ", "of", 
    " ", "those", " ", "PM", " ", "that", " ", "generate", " ", "an", " ", 
    "element", " ", "of", " ", "the", " ", "target", " ", "state"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PosState", " ", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"VertexColoringsOrdered", ",", 
         RowBox[{"state", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "state", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Sum", " ", "each", " ", "combination", " ", "of", " ", "PM", " ", "that", 
    " ", "generate", " ", "each", " ", "basis", " ", "element", " ", "from", 
    " ", "the", " ", "target", " ", "state"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StateColoringW", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"AllColoredPMsOrdered", "[", 
         RowBox[{"[", 
          RowBox[{"PosState", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"PosState", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", "state", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeat", " ", "the", " ", "process", " ", "to", " ", "identify", " ", 
    "those", " ", "PM", " ", "that", " ", "generate", " ", "states", " ", 
    "that", " ", "do", " ", "not", " ", "belong", " ", "to", " ", "the", " ", 
    "target", " ", "state"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NoState", "=", 
   RowBox[{"Complement", "[", 
    RowBox[{"UniqueVertexColorings", ",", "state"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PosObstructions", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{"VertexColoringsOrdered", ",", 
        RowBox[{"NoState", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "NoState", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConstraintsList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"AllColoredPMsOrdered", "[", 
      RowBox[{"[", 
       RowBox[{"PosObstructions", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "NoState", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"PosObstructions", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConstraintsListW", "=", 
    RowBox[{"Total", "[", 
     RowBox[{"ConstraintsList", ",", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", " ", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"TimePMstate", "=", 
   RowBox[{"t1", "-", "t0"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.830955378229126*^9, 3.830955403535102*^9}, {
   3.8310544603609095`*^9, 3.8310545941245127`*^9}, {3.8310547305195436`*^9, 
   3.831054744727934*^9}, {3.831054786338956*^9, 3.831054893177637*^9}, {
   3.8310549425679665`*^9, 3.831054954462621*^9}, {3.831056534656253*^9, 
   3.8310565468009377`*^9}, {3.8311297753751054`*^9, 
   3.8311298037027073`*^9}, {3.8311318550722294`*^9, 
   3.8311318581939774`*^9}, {3.8311481056668963`*^9, 
   3.8311481139653783`*^9}, {3.831148161197668*^9, 3.8311481853647747`*^9}, {
   3.8311483263895392`*^9, 3.8311484213691287`*^9}, 3.8311484532051306`*^9, {
   3.8311487262474904`*^9, 3.8311487271458435`*^9}, {3.8313061203962727`*^9, 
   3.8313061221383977`*^9}, {3.8314607048070884`*^9, 
   3.8314607140212345`*^9}, {3.831462160556904*^9, 3.8314621699803476`*^9}, {
   3.831546276257436*^9, 3.8315462925295825`*^9}, {3.8347422873814144`*^9, 
   3.834742437865074*^9}, {3.83474296399945*^9, 3.834743307001506*^9}, {
   3.8347434245228853`*^9, 3.834743518632822*^9}, {3.8347435701196847`*^9, 
   3.8347436056566725`*^9}, 3.834743658695713*^9, 3.834743877452259*^9, {
   3.8347439231272936`*^9, 3.8347439380953045`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Number of PM: \>\"", ",", 
    RowBox[{"Length", "[", "PMpaths", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Number of PM with all color combinations: \>\"", ",", 
    RowBox[{"Length", "[", "AllColoredPMs", "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Number of different PM (= # of basis elements): \>\"", ",", 
    RowBox[{"Length", "[", "UniqueVertexColorings", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Total number of weights (edges): \>\"", ",", 
    RowBox[{"Length", "[", "AllWeights", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimePM", "=", 
   RowBox[{"TimePMgeneration", "+", "TimePMstate"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\[CapitalDelta]t = \>\"", ",", 
   RowBox[{"TimePM", "/", "60"}], ",", "\"\< min\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.830955378229126*^9, 3.830955403535102*^9}, {
   3.8310544603609095`*^9, 3.8310545941245127`*^9}, {3.8310547305195436`*^9, 
   3.831054744727934*^9}, {3.831054786338956*^9, 3.831054893177637*^9}, {
   3.8310549425679665`*^9, 3.831054954462621*^9}, {3.831056534656253*^9, 
   3.8310565468009377`*^9}, {3.8311297753751054`*^9, 
   3.8311298037027073`*^9}, {3.8311318550722294`*^9, 
   3.8311318581939774`*^9}, {3.8311481056668963`*^9, 
   3.8311481139653783`*^9}, {3.831148161197668*^9, 3.8311481853647747`*^9}, {
   3.8311483263895392`*^9, 3.8311484213691287`*^9}, 3.8311484532051306`*^9, {
   3.8311487262474904`*^9, 3.8311487271458435`*^9}, {3.8313061203962727`*^9, 
   3.8313061221383977`*^9}, {3.8314607048070884`*^9, 
   3.8314607140212345`*^9}, {3.831462160556904*^9, 3.8314621699803476`*^9}, {
   3.831546276257436*^9, 3.8315462925295825`*^9}, {3.8347422873814144`*^9, 
   3.834742437865074*^9}, {3.83474296399945*^9, 3.834743307001506*^9}, {
   3.8347434245228853`*^9, 3.834743518632822*^9}, {3.8347435701196847`*^9, 
   3.8347436056566725`*^9}, {3.834743658695713*^9, 3.834743699285816*^9}, {
   3.834743744400165*^9, 3.8347438157805853`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of PM: \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["Number of PM: ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.830955405654499*^9, 3.83105362097977*^9, 3.8310543263660083`*^9, {
   3.8310544714274936`*^9, 3.8310545216237926`*^9}, 3.83105459554259*^9, 
   3.8310547461210537`*^9, 3.831054830106498*^9, 3.8310548946280994`*^9, 
   3.8310549556348796`*^9, 3.8310565513557973`*^9, 3.8310629162231216`*^9, 
   3.831063252377555*^9, 3.8311138707237444`*^9, 3.8311183977113285`*^9, 
   3.831129805678748*^9, {3.831131847284964*^9, 3.8311318602373743`*^9}, 
   3.8311319191759233`*^9, 3.831133473786459*^9, 3.831147847649993*^9, {
   3.8311479726170545`*^9, 3.8311479768129406`*^9}, 3.8311481151797204`*^9, 
   3.8311482126789694`*^9, 3.8311484234392715`*^9, 3.8311484566349444`*^9, 
   3.8311487287980785`*^9, 3.8311499837319055`*^9, 3.831151232862553*^9, 
   3.8311514224410715`*^9, 3.8311516140472126`*^9, 3.831152590695135*^9, 
   3.831153897600876*^9, 3.831154839989297*^9, 3.8312048115261374`*^9, 
   3.8312054157499714`*^9, 3.831205798286539*^9, 3.831207891940325*^9, {
   3.831207941932094*^9, 3.831207950449979*^9}, 3.831207992263749*^9, 
   3.8312086868677855`*^9, 3.8312096363288403`*^9, 3.831306123185975*^9, 
   3.831310242781699*^9, 3.8313159969663277`*^9, 3.831462243140153*^9, 
   3.8314628446612597`*^9, 3.8314638013195677`*^9, 3.8314642944584713`*^9, 
   3.831465844317498*^9, 3.8314660527353535`*^9, 3.8314747672658963`*^9, 
   3.8314748343802924`*^9, 3.831474901097126*^9, 3.831474962390933*^9, 
   3.8314751054569483`*^9, 3.8314759595809565`*^9, 3.83147786079325*^9, 
   3.8314781128954234`*^9, 3.831480917291664*^9, 3.8314810294644823`*^9, 
   3.831493934640747*^9, 3.8315472505306168`*^9, {3.831547948743785*^9, 
   3.8315479680616093`*^9}, 3.8315480099028435`*^9, 3.831548217775883*^9, 
   3.831548273039153*^9, 3.831548627744137*^9, 3.8315491975097055`*^9, 
   3.8315495586121006`*^9, 3.8315497675071406`*^9, 3.831568043690432*^9, 
   3.831568085819112*^9, 3.8315681390793767`*^9, 3.8315727567209244`*^9, 
   3.831572883420952*^9, 3.831573012506134*^9, 3.831573060954092*^9, {
   3.831575359359621*^9, 3.8315753717654977`*^9}, 3.8315754270853796`*^9, 
   3.8315777344796567`*^9, {3.8315791897911525`*^9, 3.831579219569466*^9}, 
   3.831584261775098*^9, 3.8315846266214867`*^9, 3.8320112187626877`*^9, 
   3.8320128783674498`*^9, 3.832013637441184*^9, 3.8320143544592505`*^9, 
   3.832015105429619*^9, 3.832016333242647*^9, 3.8323045272283688`*^9, 
   3.832304770579279*^9, 3.832304952407858*^9, 3.8347437210529895`*^9, 
   3.8347438170479336`*^9, 3.8347439430299635`*^9, 3.83474534611788*^9, 
   3.8347492441261806`*^9, 3.8347496018606224`*^9, 3.834749776282624*^9, 
   3.8347498657225714`*^9, 3.8347499020343204`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of PM with all color combinations: \"\>", 
   "\[InvisibleSpace]", "243"}],
  SequenceForm["Number of PM with all color combinations: ", 243],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.830955405654499*^9, 3.83105362097977*^9, 3.8310543263660083`*^9, {
   3.8310544714274936`*^9, 3.8310545216237926`*^9}, 3.83105459554259*^9, 
   3.8310547461210537`*^9, 3.831054830106498*^9, 3.8310548946280994`*^9, 
   3.8310549556348796`*^9, 3.8310565513557973`*^9, 3.8310629162231216`*^9, 
   3.831063252377555*^9, 3.8311138707237444`*^9, 3.8311183977113285`*^9, 
   3.831129805678748*^9, {3.831131847284964*^9, 3.8311318602373743`*^9}, 
   3.8311319191759233`*^9, 3.831133473786459*^9, 3.831147847649993*^9, {
   3.8311479726170545`*^9, 3.8311479768129406`*^9}, 3.8311481151797204`*^9, 
   3.8311482126789694`*^9, 3.8311484234392715`*^9, 3.8311484566349444`*^9, 
   3.8311487287980785`*^9, 3.8311499837319055`*^9, 3.831151232862553*^9, 
   3.8311514224410715`*^9, 3.8311516140472126`*^9, 3.831152590695135*^9, 
   3.831153897600876*^9, 3.831154839989297*^9, 3.8312048115261374`*^9, 
   3.8312054157499714`*^9, 3.831205798286539*^9, 3.831207891940325*^9, {
   3.831207941932094*^9, 3.831207950449979*^9}, 3.831207992263749*^9, 
   3.8312086868677855`*^9, 3.8312096363288403`*^9, 3.831306123185975*^9, 
   3.831310242781699*^9, 3.8313159969663277`*^9, 3.831462243140153*^9, 
   3.8314628446612597`*^9, 3.8314638013195677`*^9, 3.8314642944584713`*^9, 
   3.831465844317498*^9, 3.8314660527353535`*^9, 3.8314747672658963`*^9, 
   3.8314748343802924`*^9, 3.831474901097126*^9, 3.831474962390933*^9, 
   3.8314751054569483`*^9, 3.8314759595809565`*^9, 3.83147786079325*^9, 
   3.8314781128954234`*^9, 3.831480917291664*^9, 3.8314810294644823`*^9, 
   3.831493934640747*^9, 3.8315472505306168`*^9, {3.831547948743785*^9, 
   3.8315479680616093`*^9}, 3.8315480099028435`*^9, 3.831548217775883*^9, 
   3.831548273039153*^9, 3.831548627744137*^9, 3.8315491975097055`*^9, 
   3.8315495586121006`*^9, 3.8315497675071406`*^9, 3.831568043690432*^9, 
   3.831568085819112*^9, 3.8315681390793767`*^9, 3.8315727567209244`*^9, 
   3.831572883420952*^9, 3.831573012506134*^9, 3.831573060954092*^9, {
   3.831575359359621*^9, 3.8315753717654977`*^9}, 3.8315754270853796`*^9, 
   3.8315777344796567`*^9, {3.8315791897911525`*^9, 3.831579219569466*^9}, 
   3.831584261775098*^9, 3.8315846266214867`*^9, 3.8320112187626877`*^9, 
   3.8320128783674498`*^9, 3.832013637441184*^9, 3.8320143544592505`*^9, 
   3.832015105429619*^9, 3.832016333242647*^9, 3.8323045272283688`*^9, 
   3.832304770579279*^9, 3.832304952407858*^9, 3.8347437210529895`*^9, 
   3.8347438170479336`*^9, 3.8347439430299635`*^9, 3.83474534611788*^9, 
   3.8347492441261806`*^9, 3.8347496018606224`*^9, 3.834749776282624*^9, 
   3.8347498657225714`*^9, 3.8347499020423217`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of different PM (= # of basis elements): \"\>", 
   "\[InvisibleSpace]", "81"}],
  SequenceForm["Number of different PM (= # of basis elements): ", 81],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.830955405654499*^9, 3.83105362097977*^9, 3.8310543263660083`*^9, {
   3.8310544714274936`*^9, 3.8310545216237926`*^9}, 3.83105459554259*^9, 
   3.8310547461210537`*^9, 3.831054830106498*^9, 3.8310548946280994`*^9, 
   3.8310549556348796`*^9, 3.8310565513557973`*^9, 3.8310629162231216`*^9, 
   3.831063252377555*^9, 3.8311138707237444`*^9, 3.8311183977113285`*^9, 
   3.831129805678748*^9, {3.831131847284964*^9, 3.8311318602373743`*^9}, 
   3.8311319191759233`*^9, 3.831133473786459*^9, 3.831147847649993*^9, {
   3.8311479726170545`*^9, 3.8311479768129406`*^9}, 3.8311481151797204`*^9, 
   3.8311482126789694`*^9, 3.8311484234392715`*^9, 3.8311484566349444`*^9, 
   3.8311487287980785`*^9, 3.8311499837319055`*^9, 3.831151232862553*^9, 
   3.8311514224410715`*^9, 3.8311516140472126`*^9, 3.831152590695135*^9, 
   3.831153897600876*^9, 3.831154839989297*^9, 3.8312048115261374`*^9, 
   3.8312054157499714`*^9, 3.831205798286539*^9, 3.831207891940325*^9, {
   3.831207941932094*^9, 3.831207950449979*^9}, 3.831207992263749*^9, 
   3.8312086868677855`*^9, 3.8312096363288403`*^9, 3.831306123185975*^9, 
   3.831310242781699*^9, 3.8313159969663277`*^9, 3.831462243140153*^9, 
   3.8314628446612597`*^9, 3.8314638013195677`*^9, 3.8314642944584713`*^9, 
   3.831465844317498*^9, 3.8314660527353535`*^9, 3.8314747672658963`*^9, 
   3.8314748343802924`*^9, 3.831474901097126*^9, 3.831474962390933*^9, 
   3.8314751054569483`*^9, 3.8314759595809565`*^9, 3.83147786079325*^9, 
   3.8314781128954234`*^9, 3.831480917291664*^9, 3.8314810294644823`*^9, 
   3.831493934640747*^9, 3.8315472505306168`*^9, {3.831547948743785*^9, 
   3.8315479680616093`*^9}, 3.8315480099028435`*^9, 3.831548217775883*^9, 
   3.831548273039153*^9, 3.831548627744137*^9, 3.8315491975097055`*^9, 
   3.8315495586121006`*^9, 3.8315497675071406`*^9, 3.831568043690432*^9, 
   3.831568085819112*^9, 3.8315681390793767`*^9, 3.8315727567209244`*^9, 
   3.831572883420952*^9, 3.831573012506134*^9, 3.831573060954092*^9, {
   3.831575359359621*^9, 3.8315753717654977`*^9}, 3.8315754270853796`*^9, 
   3.8315777344796567`*^9, {3.8315791897911525`*^9, 3.831579219569466*^9}, 
   3.831584261775098*^9, 3.8315846266214867`*^9, 3.8320112187626877`*^9, 
   3.8320128783674498`*^9, 3.832013637441184*^9, 3.8320143544592505`*^9, 
   3.832015105429619*^9, 3.832016333242647*^9, 3.8323045272283688`*^9, 
   3.832304770579279*^9, 3.832304952407858*^9, 3.8347437210529895`*^9, 
   3.8347438170479336`*^9, 3.8347439430299635`*^9, 3.83474534611788*^9, 
   3.8347492441261806`*^9, 3.8347496018606224`*^9, 3.834749776282624*^9, 
   3.8347498657225714`*^9, 3.8347499020503263`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total number of weights (edges): \"\>", "\[InvisibleSpace]", 
   "54"}],
  SequenceForm["Total number of weights (edges): ", 54],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.830955405654499*^9, 3.83105362097977*^9, 3.8310543263660083`*^9, {
   3.8310544714274936`*^9, 3.8310545216237926`*^9}, 3.83105459554259*^9, 
   3.8310547461210537`*^9, 3.831054830106498*^9, 3.8310548946280994`*^9, 
   3.8310549556348796`*^9, 3.8310565513557973`*^9, 3.8310629162231216`*^9, 
   3.831063252377555*^9, 3.8311138707237444`*^9, 3.8311183977113285`*^9, 
   3.831129805678748*^9, {3.831131847284964*^9, 3.8311318602373743`*^9}, 
   3.8311319191759233`*^9, 3.831133473786459*^9, 3.831147847649993*^9, {
   3.8311479726170545`*^9, 3.8311479768129406`*^9}, 3.8311481151797204`*^9, 
   3.8311482126789694`*^9, 3.8311484234392715`*^9, 3.8311484566349444`*^9, 
   3.8311487287980785`*^9, 3.8311499837319055`*^9, 3.831151232862553*^9, 
   3.8311514224410715`*^9, 3.8311516140472126`*^9, 3.831152590695135*^9, 
   3.831153897600876*^9, 3.831154839989297*^9, 3.8312048115261374`*^9, 
   3.8312054157499714`*^9, 3.831205798286539*^9, 3.831207891940325*^9, {
   3.831207941932094*^9, 3.831207950449979*^9}, 3.831207992263749*^9, 
   3.8312086868677855`*^9, 3.8312096363288403`*^9, 3.831306123185975*^9, 
   3.831310242781699*^9, 3.8313159969663277`*^9, 3.831462243140153*^9, 
   3.8314628446612597`*^9, 3.8314638013195677`*^9, 3.8314642944584713`*^9, 
   3.831465844317498*^9, 3.8314660527353535`*^9, 3.8314747672658963`*^9, 
   3.8314748343802924`*^9, 3.831474901097126*^9, 3.831474962390933*^9, 
   3.8314751054569483`*^9, 3.8314759595809565`*^9, 3.83147786079325*^9, 
   3.8314781128954234`*^9, 3.831480917291664*^9, 3.8314810294644823`*^9, 
   3.831493934640747*^9, 3.8315472505306168`*^9, {3.831547948743785*^9, 
   3.8315479680616093`*^9}, 3.8315480099028435`*^9, 3.831548217775883*^9, 
   3.831548273039153*^9, 3.831548627744137*^9, 3.8315491975097055`*^9, 
   3.8315495586121006`*^9, 3.8315497675071406`*^9, 3.831568043690432*^9, 
   3.831568085819112*^9, 3.8315681390793767`*^9, 3.8315727567209244`*^9, 
   3.831572883420952*^9, 3.831573012506134*^9, 3.831573060954092*^9, {
   3.831575359359621*^9, 3.8315753717654977`*^9}, 3.8315754270853796`*^9, 
   3.8315777344796567`*^9, {3.8315791897911525`*^9, 3.831579219569466*^9}, 
   3.831584261775098*^9, 3.8315846266214867`*^9, 3.8320112187626877`*^9, 
   3.8320128783674498`*^9, 3.832013637441184*^9, 3.8320143544592505`*^9, 
   3.832015105429619*^9, 3.832016333242647*^9, 3.8323045272283688`*^9, 
   3.832304770579279*^9, 3.832304952407858*^9, 3.8347437210529895`*^9, 
   3.8347438170479336`*^9, 3.8347439430299635`*^9, 3.83474534611788*^9, 
   3.8347492441261806`*^9, 3.8347496018606224`*^9, 3.834749776282624*^9, 
   3.8347498657225714`*^9, 3.8347499020503263`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[CapitalDelta]t = \"\>", "\[InvisibleSpace]", 
   "0.0009327716666666667`5.89844159395261", 
   "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "\[CapitalDelta]t = ", 0.0009327716666666667`5.89844159395261, " min"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.830955405654499*^9, 3.83105362097977*^9, 3.8310543263660083`*^9, {
   3.8310544714274936`*^9, 3.8310545216237926`*^9}, 3.83105459554259*^9, 
   3.8310547461210537`*^9, 3.831054830106498*^9, 3.8310548946280994`*^9, 
   3.8310549556348796`*^9, 3.8310565513557973`*^9, 3.8310629162231216`*^9, 
   3.831063252377555*^9, 3.8311138707237444`*^9, 3.8311183977113285`*^9, 
   3.831129805678748*^9, {3.831131847284964*^9, 3.8311318602373743`*^9}, 
   3.8311319191759233`*^9, 3.831133473786459*^9, 3.831147847649993*^9, {
   3.8311479726170545`*^9, 3.8311479768129406`*^9}, 3.8311481151797204`*^9, 
   3.8311482126789694`*^9, 3.8311484234392715`*^9, 3.8311484566349444`*^9, 
   3.8311487287980785`*^9, 3.8311499837319055`*^9, 3.831151232862553*^9, 
   3.8311514224410715`*^9, 3.8311516140472126`*^9, 3.831152590695135*^9, 
   3.831153897600876*^9, 3.831154839989297*^9, 3.8312048115261374`*^9, 
   3.8312054157499714`*^9, 3.831205798286539*^9, 3.831207891940325*^9, {
   3.831207941932094*^9, 3.831207950449979*^9}, 3.831207992263749*^9, 
   3.8312086868677855`*^9, 3.8312096363288403`*^9, 3.831306123185975*^9, 
   3.831310242781699*^9, 3.8313159969663277`*^9, 3.831462243140153*^9, 
   3.8314628446612597`*^9, 3.8314638013195677`*^9, 3.8314642944584713`*^9, 
   3.831465844317498*^9, 3.8314660527353535`*^9, 3.8314747672658963`*^9, 
   3.8314748343802924`*^9, 3.831474901097126*^9, 3.831474962390933*^9, 
   3.8314751054569483`*^9, 3.8314759595809565`*^9, 3.83147786079325*^9, 
   3.8314781128954234`*^9, 3.831480917291664*^9, 3.8314810294644823`*^9, 
   3.831493934640747*^9, 3.8315472505306168`*^9, {3.831547948743785*^9, 
   3.8315479680616093`*^9}, 3.8315480099028435`*^9, 3.831548217775883*^9, 
   3.831548273039153*^9, 3.831548627744137*^9, 3.8315491975097055`*^9, 
   3.8315495586121006`*^9, 3.8315497675071406`*^9, 3.831568043690432*^9, 
   3.831568085819112*^9, 3.8315681390793767`*^9, 3.8315727567209244`*^9, 
   3.831572883420952*^9, 3.831573012506134*^9, 3.831573060954092*^9, {
   3.831575359359621*^9, 3.8315753717654977`*^9}, 3.8315754270853796`*^9, 
   3.8315777344796567`*^9, {3.8315791897911525`*^9, 3.831579219569466*^9}, 
   3.831584261775098*^9, 3.8315846266214867`*^9, 3.8320112187626877`*^9, 
   3.8320128783674498`*^9, 3.832013637441184*^9, 3.8320143544592505`*^9, 
   3.832015105429619*^9, 3.832016333242647*^9, 3.8323045272283688`*^9, 
   3.832304770579279*^9, 3.832304952407858*^9, 3.8347437210529895`*^9, 
   3.8347438170479336`*^9, 3.8347439430299635`*^9, 3.83474534611788*^9, 
   3.8347492441261806`*^9, 3.8347496018606224`*^9, 3.834749776282624*^9, 
   3.8347498657225714`*^9, 3.834749902058324*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Logic", "Subsection",
 CellChangeTimes->{{3.828637707638624*^9, 3.828637708242789*^9}},
 ExpressionUUID -> "82c10cfd-d648-4854-8a7c-a7bbd312d660"],

Cell[TextData[{
 "Each PM is composed by its edges weights. If one of the weights is zero, \
then there is no PM. This can be encoded into a logic statement where each \
weight can take the boolean value of True (if it is different from zero) or \
False (if it is zero). If only one weight is False, then the full PM is \
False. The logical clause that encodes each PM is thus\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["w", "1"], "\[And]", 
      SubscriptBox["w", "2"], "\[And]"}], "..."}], "\[And]", 
    SubscriptBox["w", 
     RowBox[{"n", "/", "2"}]]}], TraditionalForm]]],
 "\n\nThe clauses for this problem are divided into two types:\n\n- State \
clauses: we need at least one PM that generate each basis element that appear \
in the target state. Therefore, for each of these elements,\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["PM", "1"], "\[Or]", 
       SubscriptBox["PM", "2"], "\[Or]"}], "..."}], "\[Or]", 
     SubscriptBox["PM", "p"]}], "=", "True"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", \n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox["PM", "1"], "\[Or]", 
            SubscriptBox["PM", "2"], "\[Or]"}], "..."}], "\[Or]", 
          SubscriptBox["PM", "p"]}], ")"}], 
        RowBox[{"basis", " ", 
         SubscriptBox["element", "1"]}]], "\[And]"}], "..."}], "\[And]", 
     SubscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["PM", "1"], "\[Or]", 
          SubscriptBox["PM", "2"], "\[Or]"}], "..."}], "\[Or]", 
        SubscriptBox["PM", "p"]}], ")"}], 
      RowBox[{"basis", " ", 
       SubscriptBox["element", "L"]}]]}], "=", "True"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n\n- Obstruction clauses: we can not encode the possible interference \
between different PM, but we can impose that for each basis element that do \
not appear in the target state, if all PM except one are False, then the \
remaining one has to be False as well. This is equivalent to the following \
clause\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["PM", "1"], "\[And]", 
        OverscriptBox[
         SubscriptBox["PM", "2"], "_"], "\[And]"}], "..."}], "\[And]", 
      OverscriptBox[
       SubscriptBox["PM", "p"], "_"]}], ")"}], "=", "False"}], 
   TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n\nThis clause shows that if all PM except one are False (therefore, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["PM", "_"], "=", "True"}], TraditionalForm]]],
 ") then, to obtain False, the remaining PM must be False. We have to ask the \
same for all combinations of all PM except one being False.\nSince we want to \
solve this problem using a SAT solver (correct outputs evaluate to True), we \
will ask for the negation of each of these clauses (so the expression will be \
True when the requirements are fulfilled).\nOther possibilities, like two of \
the PM exist, evaluate the expression to True, since we do not know if it is \
possible a numerical cancelation between the weights."
}], "Text",
 CellChangeTimes->{{3.834744080767655*^9, 3.834744106641702*^9}, {
  3.8347441744648285`*^9, 3.834744355528432*^9}, {3.8347444035060773`*^9, 
  3.8347451438965597`*^9}, {3.8347451798566723`*^9, 3.8347451998387637`*^9}, {
  3.8347459660109987`*^9, 3.834746181538862*^9}, {3.834746362369418*^9, 
  3.834746469375759*^9}},
 TextAlignment->Left],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"t1", " ", "=", " ", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"State", " ", "clauses"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StateColoring", "=", 
    RowBox[{
     RowBox[{"StateColoringW", "/.", 
      RowBox[{"{", 
       RowBox[{"Times", "\[Rule]", "And"}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{"Plus", "\[Rule]", "Or"}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Obstruction", " ", "clauses"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ObstructionFunction", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"MapAt", "[", 
         RowBox[{"Not", ",", 
          RowBox[{"(", 
           RowBox[{"Not", "/@", 
            RowBox[{"(", 
             RowBox[{"#", "/.", 
              RowBox[{"{", 
               RowBox[{"Times", "\[Rule]", "And"}], "}"}]}], ")"}]}], ")"}], 
          ",", "i"}], "]"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"Plus", "\[Rule]", "And"}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "PMpaths", "]"}]}], "}"}]}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Obstruction", " ", "=", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{"(", 
      RowBox[{"ObstructionFunction", "/@", "ConstraintsList"}], ")"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Total", " ", "clauses"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Klauses", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Total", "[", "StateColoring", "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"Plus", "\[Rule]", "And"}], "}"}]}], ")"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"Not", "/@", "Obstruction"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"Plus", "\[Rule]", "And"}], "}"}]}], ")"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", " ", "=", " ", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Total number of clauses: \>\"", ",", " ", 
   RowBox[{
    RowBox[{"Length", "[", "StateColoring", "]"}], "+", 
    RowBox[{"Length", "[", 
     RowBox[{"Flatten", "[", "Obstruction", "]"}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Total number of obstructions: \>\"", ",", " ", 
   RowBox[{"Length", "[", 
    RowBox[{"Flatten", "[", "Obstruction", "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeKlauses", "=", 
   RowBox[{"(", 
    RowBox[{"t0", "-", "t1"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\[CapitalDelta]t = \>\"", ",", 
   RowBox[{"TimeKlauses", "/", "60"}], ",", "\"\< min\>\""}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.831059135988624*^9, 3.8310591597807274`*^9}, {
   3.831059233147565*^9, 3.8310592897367573`*^9}, {3.8310593199275208`*^9, 
   3.8310593291814218`*^9}, {3.8310599103223686`*^9, 3.831059910507539*^9}, {
   3.8310625320083647`*^9, 3.831062710431288*^9}, {3.8311302134972353`*^9, 
   3.831130232476247*^9}, {3.831130299832204*^9, 3.8311303423065143`*^9}, {
   3.831130375441205*^9, 3.831130422176016*^9}, 3.831130455074936*^9, {
   3.831130552177726*^9, 3.831130552335964*^9}, {3.8311306016967716`*^9, 
   3.8311306029800935`*^9}, {3.831130980208892*^9, 3.8311309897143707`*^9}, {
   3.8311311913350573`*^9, 3.831131206637516*^9}, {3.8311314229948816`*^9, 
   3.8311314548988285`*^9}, {3.831131510721588*^9, 3.831131521688359*^9}, {
   3.8311317111401815`*^9, 3.8311317433137283`*^9}, {3.831131778284724*^9, 
   3.8311317805856504`*^9}, {3.8311321395009923`*^9, 
   3.8311321413315916`*^9}, {3.8311322022866645`*^9, 3.831132230413149*^9}, {
   3.831132276951795*^9, 3.8311322985607557`*^9}, {3.8311329320172153`*^9, 
   3.8311329505464783`*^9}, {3.8311330212656393`*^9, 3.831133039977806*^9}, {
   3.831148874378708*^9, 3.831148878209306*^9}, {3.831149089368143*^9, 
   3.831149092676135*^9}, {3.8311493952093124`*^9, 3.8311494430904455`*^9}, {
   3.8311494802960835`*^9, 3.8311495480861244`*^9}, {3.831149722425914*^9, 
   3.831149742132253*^9}, {3.8311498410751867`*^9, 3.8311498510079165`*^9}, {
   3.8311501573072133`*^9, 3.8311501592329473`*^9}, {3.8311503067273874`*^9, 
   3.8311503130039344`*^9}, {3.831150790058716*^9, 3.831150797340901*^9}, {
   3.8311510018872957`*^9, 3.8311510235688486`*^9}, {3.831151074585258*^9, 
   3.831151077244302*^9}, {3.831151191431346*^9, 3.831151197375412*^9}, 
   3.831151482559017*^9, {3.8311525974608603`*^9, 3.8311526105052643`*^9}, {
   3.831208703322982*^9, 3.8312087374740057`*^9}, {3.8313061142671967`*^9, 
   3.831306116377751*^9}, {3.831460695618352*^9, 3.8314606997982016`*^9}, {
   3.831486451979162*^9, 3.831486476164006*^9}, {3.8347438860590935`*^9, 
   3.834743886965946*^9}, {3.8347439596050453`*^9, 3.8347440008381777`*^9}, {
   3.834744036559851*^9, 3.834744057483046*^9}, {3.834745242116027*^9, 
   3.8347452546943073`*^9}, {3.8347454493126965`*^9, 
   3.8347454509524117`*^9}, {3.834746209359201*^9, 3.834746257779213*^9}, {
   3.834746466634221*^9, 3.834746537127431*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total number of clauses: \"\>", "\[InvisibleSpace]", "237"}],
  SequenceForm["Total number of clauses: ", 237],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8311495504181447`*^9, 3.8311498534897757`*^9, 3.8311499934300814`*^9, 
   3.8311501612994757`*^9, 3.8311503141122255`*^9, 3.8311507989657984`*^9, 
   3.831151024670587*^9, 3.8311510864221754`*^9, {3.831151204419138*^9, 
   3.831151210056799*^9}, 3.8311512421038113`*^9, 3.8311514540192814`*^9, 
   3.831151509263491*^9, 3.8311516196486845`*^9, 3.8311526121430326`*^9, 
   3.831153901847838*^9, 3.8311548454119177`*^9, 3.831204942050864*^9, 
   3.8312054195276327`*^9, 3.831205801310563*^9, 3.8312078956184225`*^9, {
   3.8312079838227987`*^9, 3.8312079952321463`*^9}, 3.831208773081914*^9, 
   3.831209641818919*^9, 3.8313061713144627`*^9, 3.831310244912937*^9, 
   3.8313159991045933`*^9, 3.83146224762948*^9, 3.8314628474041104`*^9, 
   3.831463804238323*^9, 3.83146429756949*^9, 3.8314658466657047`*^9, 
   3.83146609551538*^9, 3.831474770137847*^9, 3.8314748370623293`*^9, 
   3.8314749037711754`*^9, 3.8314749650271945`*^9, 3.831475108121333*^9, 
   3.8314759620505915`*^9, 3.8314778634106073`*^9, 3.8314781154797482`*^9, 
   3.83148091996122*^9, 3.831481031130595*^9, 3.831486265409855*^9, 
   3.83148647824447*^9, 3.831494003245455*^9, 3.831575204488969*^9, {
   3.831575362061023*^9, 3.8315753738138514`*^9}, 3.831575429038741*^9, 
   3.831577019311116*^9, 3.8315777433899517`*^9, {3.831579204440149*^9, 
   3.8315792307922077`*^9}, 3.831584265368087*^9, 3.8315846766979394`*^9, 
   3.832011220694343*^9, 3.8320128802522483`*^9, 3.832013639539221*^9, 
   3.832014356768571*^9, 3.8320151403124323`*^9, 3.8320163433220835`*^9, 
   3.8323045326274853`*^9, 3.8323047756653814`*^9, 3.8323049973281064`*^9, 
   3.8347440602098045`*^9, 3.8347453522819147`*^9, 3.8347454513283887`*^9, 
   3.8347465391831055`*^9, 3.8347492442222147`*^9, 3.8347496020137157`*^9, 
   3.8347497764185925`*^9, 3.8347498658185697`*^9, 3.8347499021303205`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total number of obstructions: \"\>", "\[InvisibleSpace]", 
   "234"}],
  SequenceForm["Total number of obstructions: ", 234],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8311495504181447`*^9, 3.8311498534897757`*^9, 3.8311499934300814`*^9, 
   3.8311501612994757`*^9, 3.8311503141122255`*^9, 3.8311507989657984`*^9, 
   3.831151024670587*^9, 3.8311510864221754`*^9, {3.831151204419138*^9, 
   3.831151210056799*^9}, 3.8311512421038113`*^9, 3.8311514540192814`*^9, 
   3.831151509263491*^9, 3.8311516196486845`*^9, 3.8311526121430326`*^9, 
   3.831153901847838*^9, 3.8311548454119177`*^9, 3.831204942050864*^9, 
   3.8312054195276327`*^9, 3.831205801310563*^9, 3.8312078956184225`*^9, {
   3.8312079838227987`*^9, 3.8312079952321463`*^9}, 3.831208773081914*^9, 
   3.831209641818919*^9, 3.8313061713144627`*^9, 3.831310244912937*^9, 
   3.8313159991045933`*^9, 3.83146224762948*^9, 3.8314628474041104`*^9, 
   3.831463804238323*^9, 3.83146429756949*^9, 3.8314658466657047`*^9, 
   3.83146609551538*^9, 3.831474770137847*^9, 3.8314748370623293`*^9, 
   3.8314749037711754`*^9, 3.8314749650271945`*^9, 3.831475108121333*^9, 
   3.8314759620505915`*^9, 3.8314778634106073`*^9, 3.8314781154797482`*^9, 
   3.83148091996122*^9, 3.831481031130595*^9, 3.831486265409855*^9, 
   3.83148647824447*^9, 3.831494003245455*^9, 3.831575204488969*^9, {
   3.831575362061023*^9, 3.8315753738138514`*^9}, 3.831575429038741*^9, 
   3.831577019311116*^9, 3.8315777433899517`*^9, {3.831579204440149*^9, 
   3.8315792307922077`*^9}, 3.831584265368087*^9, 3.8315846766979394`*^9, 
   3.832011220694343*^9, 3.8320128802522483`*^9, 3.832013639539221*^9, 
   3.832014356768571*^9, 3.8320151403124323`*^9, 3.8320163433220835`*^9, 
   3.8323045326274853`*^9, 3.8323047756653814`*^9, 3.8323049973281064`*^9, 
   3.8347440602098045`*^9, 3.8347453522819147`*^9, 3.8347454513283887`*^9, 
   3.8347465391831055`*^9, 3.8347492442222147`*^9, 3.8347496020137157`*^9, 
   3.8347497764185925`*^9, 3.8347498658185697`*^9, 3.8347499021303205`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[CapitalDelta]t = \"\>", "\[InvisibleSpace]", 
   "0.00026617`5.654855348479319", "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm["\[CapitalDelta]t = ", 0.00026617`5.654855348479319, " min"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8311495504181447`*^9, 3.8311498534897757`*^9, 3.8311499934300814`*^9, 
   3.8311501612994757`*^9, 3.8311503141122255`*^9, 3.8311507989657984`*^9, 
   3.831151024670587*^9, 3.8311510864221754`*^9, {3.831151204419138*^9, 
   3.831151210056799*^9}, 3.8311512421038113`*^9, 3.8311514540192814`*^9, 
   3.831151509263491*^9, 3.8311516196486845`*^9, 3.8311526121430326`*^9, 
   3.831153901847838*^9, 3.8311548454119177`*^9, 3.831204942050864*^9, 
   3.8312054195276327`*^9, 3.831205801310563*^9, 3.8312078956184225`*^9, {
   3.8312079838227987`*^9, 3.8312079952321463`*^9}, 3.831208773081914*^9, 
   3.831209641818919*^9, 3.8313061713144627`*^9, 3.831310244912937*^9, 
   3.8313159991045933`*^9, 3.83146224762948*^9, 3.8314628474041104`*^9, 
   3.831463804238323*^9, 3.83146429756949*^9, 3.8314658466657047`*^9, 
   3.83146609551538*^9, 3.831474770137847*^9, 3.8314748370623293`*^9, 
   3.8314749037711754`*^9, 3.8314749650271945`*^9, 3.831475108121333*^9, 
   3.8314759620505915`*^9, 3.8314778634106073`*^9, 3.8314781154797482`*^9, 
   3.83148091996122*^9, 3.831481031130595*^9, 3.831486265409855*^9, 
   3.83148647824447*^9, 3.831494003245455*^9, 3.831575204488969*^9, {
   3.831575362061023*^9, 3.8315753738138514`*^9}, 3.831575429038741*^9, 
   3.831577019311116*^9, 3.8315777433899517`*^9, {3.831579204440149*^9, 
   3.8315792307922077`*^9}, 3.831584265368087*^9, 3.8315846766979394`*^9, 
   3.832011220694343*^9, 3.8320128802522483`*^9, 3.832013639539221*^9, 
   3.832014356768571*^9, 3.8320151403124323`*^9, 3.8320163433220835`*^9, 
   3.8323045326274853`*^9, 3.8323047756653814`*^9, 3.8323049973281064`*^9, 
   3.8347440602098045`*^9, 3.8347453522819147`*^9, 3.8347454513283887`*^9, 
   3.8347465391831055`*^9, 3.8347492442222147`*^9, 3.8347496020137157`*^9, 
   3.8347497764185925`*^9, 3.8347498658185697`*^9, 3.834749902138352*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute the weights that generate the state ", "Subsection",
 CellChangeTimes->{{3.8286377239247093`*^9, 3.828637733206765*^9}, {
   3.831204898768972*^9, 3.831204923258934*^9}, 3.8314607298970003`*^9, {
   3.834748305151391*^9, 3.8347483203799458`*^9}},
 ExpressionUUID -> "170a78b5-0857-495f-a736-8e69215ad9ae"],

Cell["\<\
To compute what are the weights that generate the state. We will use this \
function at the very end of Klaus algorithm.\
\>", "Text",
 CellChangeTimes->{{3.834748345976244*^9, 3.8347483840950017`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AllPMs", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"ConstraintsListW", ",", "StateColoringW"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fidelity", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"Total", "[", "StateColoringW", "]"}], "]"}], "^", "2"}], 
    RowBox[{
     RowBox[{"Length", "[", "StateColoringW", "]"}], 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"Abs", "[", "AllPMs", "]"}], "^", "2"}], "]"}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TotalLoss", "=", 
   RowBox[{"(", 
    RowBox[{"1", "-", "Fidelity"}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8286373098489923`*^9, 3.828637319359046*^9}, {
   3.82863738118167*^9, 3.8286373816161313`*^9}, {3.8286376433758774`*^9, 
   3.8286376447775545`*^9}, {3.8286377130567408`*^9, 3.828637714511885*^9}, {
   3.828698661426916*^9, 3.82869866558639*^9}, {3.830804365581701*^9, 
   3.830804373625125*^9}, 3.8308044801060658`*^9, 3.8308050443302555`*^9, 
   3.8309467893991475`*^9, {3.8309470386315193`*^9, 3.830947085961702*^9}, {
   3.8309472105854864`*^9, 3.8309472142466245`*^9}, {3.8311333001789665`*^9, 
   3.8311333099776373`*^9}, {3.8311334937456512`*^9, 
   3.8311334999386935`*^9}, {3.8314607330874147`*^9, 
   3.8314607565626693`*^9}, {3.8347483281831017`*^9, 3.834748330781062*^9}},
 ExpressionUUID -> "8696a7b3-2525-46ec-922b-87c912bbce2d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SAT", "Section",
 CellChangeTimes->{{3.8311513841001673`*^9, 3.831151387477419*^9}, 
   3.8347465788320065`*^9}],

Cell["\<\
We can check if the problem with the full connected graph is Satisfible.
Since we have assumed bicolored edges, the result will always be True, since \
the full-connected graph (all weights = True) is a solution.
The SAT instance with the biggest number of False edges will be the minimal \
solution. However, finding those instances require on average more time than \
the heuristic algorithm that we propose in the next section.\
\>", "Text",
 CellChangeTimes->{{3.834746625190811*^9, 3.834746797940159*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"t0", " ", "=", " ", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SatisfiableQ", "[", 
  RowBox[{"Klauses", ",", " ", 
   RowBox[{"BooleanVariables", "[", "Klauses", "]"}], ",", 
   RowBox[{"Method", "\[Rule]", "\"\<SAT\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", " ", "=", " ", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeFullSAT", "=", 
   RowBox[{"t1", "-", "t0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\[CapitalDelta]t = \>\"", ",", 
   RowBox[{"TimeFullSAT", "/", "60"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.831151392061366*^9, 3.8311513976733274`*^9}, {
  3.83115143489968*^9, 3.8311514629893117`*^9}, {3.834746602949561*^9, 
  3.8347466172181935`*^9}, {3.834746816077131*^9, 3.8347468587894115`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.831151398166104*^9, 3.831151585064329*^9, 
  3.831151659447939*^9, 3.831209686866721*^9, 3.831306939835101*^9, 
  3.8347468605510435`*^9, 3.8347492510868425`*^9, 3.834749602153723*^9, 
  3.8347497765546217`*^9, 3.834749902266325*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[CapitalDelta]t = \"\>", "\[InvisibleSpace]", 
   "0.0001333366666666667`5.354645837714248"}],
  SequenceForm["\[CapitalDelta]t = ", 0.0001333366666666667`5.354645837714248],
  Editable->False]], "Print",
 CellChangeTimes->{3.8311515850695357`*^9, 3.8311516594560413`*^9, 
  3.831209686872889*^9, 3.8313069398432465`*^9, 3.8347468605593367`*^9, 
  3.8347492510948477`*^9, 3.834749602160469*^9, 3.8347497765625896`*^9, 
  3.834749902266325*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Klaus algorithm", "Section",
 CellChangeTimes->{{3.830802959598922*^9, 3.8308029638814487`*^9}, {
   3.834746871417601*^9, 3.8347468747855406`*^9}, 3.8347472603896985`*^9}],

Cell["\<\
The full-connected graph is satisfible but we aim to find the minimal graph \
in terms of the number of edres that can generate the target state. The goal \
is not to find a solution but rather interpret and understand a solution.
To that aim, we propose an heuristic algorithm, called Klaus.

0. Klaus starts from the full-connected graph. The available edges are all \
possible edges.
1. Deletes one edge from the available edges at random.
2. Checks if the logic is still satifiable assigning False to those deleted \
edges and True to the rest of them.
3. If it is, then this edge is \[OpenCurlyDoubleQuote]deleted\
\[CloseCurlyDoubleQuote] (set to False). If it\[CloseCurlyQuote]s not, then \
this edge is removed from the pool of available edges.
4. It repeats the process from 1) until it depletes all available edges.
5. Once it finds a minimal set of edges for which the logic is satisfible, \
then it proceeds to find the weights of these edges to generate the target \
state by minimizing the infidelity loss function.\
\>", "Text",
 CellChangeTimes->{{3.8347471333341675`*^9, 3.834747258180236*^9}, {
  3.834747402858841*^9, 3.834747625522441*^9}, {3.8347476905113754`*^9, 
  3.834747720174451*^9}, {3.834748231641591*^9, 3.8347482750705576`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BestKlauses", " ", "=", "  ", "Klauses"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReplacementList", "=", 
    RowBox[{"{", "}"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BestCurrentWeights", "=", "AllWeights"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CurrentWeights", "=", "BestCurrentWeights"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AvailableWeights", " ", "=", " ", "CurrentWeights"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "AvailableWeights", "]"}], ">", "0"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Select", " ", "one", " ", "edge", " ", "at", " ", "random", " ", "from",
       " ", "the", " ", "pool", " ", "of", " ", "available", " ", "edges"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"falsetmp", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "AvailableWeights", "]"}]}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"deleteedge", "=", 
      RowBox[{"AvailableWeights", "[", 
       RowBox[{"[", "falsetmp", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "This", " ", "edge", " ", "will", " ", "not", " ", "be", " ", 
        "available", " ", "for", " ", "the", " ", "next", " ", "iteration"}], 
       ",", " ", 
       RowBox[{
       "either", " ", "because", " ", "it", " ", "can", " ", "be", " ", "set",
         " ", "to", " ", "False", " ", "or", " ", "because", " ", "it", " ", 
        "has", " ", "to", " ", "exist", " ", "or", " ", "the", " ", 
        "expression", " ", "will", " ", "not", " ", "be", " ", 
        "satisfiable"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"AvailableWeights", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"AvailableWeights", ",", "deleteedge"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "We", " ", "impose", " ", "that", " ", "edge", " ", "as", " ", "False", 
       " ", "and", " ", "compute", " ", "the", " ", "total", " ", "logical", 
       " ", "expression", " ", "from", " ", "the", " ", "previous", " ", 
       "iteration"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CurrentKlauses", "=", 
      RowBox[{"BestKlauses", "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"deleteedge", "\[Rule]", "False"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "the", " ", "expression", " ", "is", " ", 
       "still", " ", "satisfiable"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"logicVal", "=", 
      RowBox[{"SatisfiableQ", "[", 
       RowBox[{"CurrentKlauses", ",", 
        RowBox[{"BooleanVariables", "[", "CurrentKlauses", "]"}], ",", 
        RowBox[{"Method", "\[Rule]", "\"\<SAT\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"logicVal", "\[Equal]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Remove", " ", "it", " ", 
         RowBox[{"(", 
          RowBox[{
          "append", " ", "it", " ", "to", " ", "the", " ", "ReplacementList", 
           " ", "where", " ", "previous", " ", "removed", " ", "edges", " ", 
           "are"}], " "}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"ReplacementList", ",", "deleteedge"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CurrentWeights", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"AllWeights", ",", "ReplacementList"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"BestReplacementList", "=", "ReplacementList"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"BestCurrentWeights", "=", "CurrentWeights"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"BestKlauses", "=", "CurrentKlauses"}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"if", " ", "logicVal"}], " ", "=", " ", "False"}], ",", " ", 
        RowBox[{
         RowBox[{
         "that", " ", "weight", " ", "is", " ", "necessary", " ", "to", " ", 
          "SAT"}], "=", 
         RowBox[{
          RowBox[{"True", "!"}], " ", "keep", " ", "it"}]}], ",", " ", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", 
          RowBox[{"it", "'"}]}], "s", " ", "not", " ", "available", " ", 
         "for", " ", "removing", " ", 
         RowBox[{"it", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TimeLogicOpt", "=", 
    RowBox[{"t1", "-", "t0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Logic reduction completed.\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Solution = \>\"", ",", 
    RowBox[{"Length", "[", "BestCurrentWeights", "]"}], ",", "\"\</\>\"", ",", 
    RowBox[{"Length", "[", "AllWeights", "]"}], ",", 
    "\"\< weights, \[CapitalDelta]t = \>\"", ",", 
    RowBox[{"TimeLogicOpt", "/", "60"}], ",", " ", "\"\< min\>\""}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Once", " ", "we", " ", "have", " ", "the", " ", "logical", " ", 
     "minimal", " ", "solution"}], ",", " ", 
    RowBox[{
    "we", " ", "minimize", " ", "the", " ", "infidelity", " ", "of", " ", 
     "the", " ", "state", " ", "generated", " ", "by", " ", "the", " ", 
     "remaining", " ", "PM", " ", 
     RowBox[{"w", ".", "r", ".", "t", ".", " ", "the"}], " ", "target", " ", 
     "state", " ", "to", " ", "obtain", " ", "the", " ", "weights"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Deleted", " ", "edges", " ", "will", " ", "be", " ", "set", " ", "with", 
    " ", "0", " ", "weights"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CurrentLoss", "=", 
   RowBox[{"TotalLoss", "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{"BestReplacementList", "\[Rule]", "0"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initvar", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"BestCurrentWeights", ",", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"Length", "[", "BestCurrentWeights", "]"}]}], "]"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sol", "=", 
    RowBox[{"FindMinimum", "[", 
     RowBox[{"CurrentLoss", ",", "initvar", ",", 
      RowBox[{"AccuracyGoal", "\[Rule]", "3"}], ",", 
      RowBox[{"PrecisionGoal", "\[Rule]", "3"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TimeOpt", "=", 
    RowBox[{"t1", "-", "t0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fid", " ", "=", 
   RowBox[{
    RowBox[{"Fidelity", "//.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
    RowBox[{"Thread", "[", 
     RowBox[{"BestReplacementList", "\[Rule]", "0"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Optimization completed. \>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", " ", 
    RowBox[{
    "\"\<Fidelity = \>\"", ",", "fid", ",", " ", 
     "\"\<, \[CapitalDelta]t = \>\"", ",", 
     RowBox[{"TimeOpt", "/", "60"}], ",", " ", "\"\< min\>\""}], "]"}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"fid", "<", "0.9"}], ",", " ", 
     RowBox[{
     "Print", "[", 
      "\"\<Logic failed. A crucial edge was deleted. Try again.\>\"", "]"}], 
     ",", 
     RowBox[{"Print", "[", "\"\<Target state found!\>\"", "]"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Print", " ", "the", " ", "solution"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coef", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"AllColoredPMs", "//.", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
     RowBox[{"Thread", "[", 
      RowBox[{"ReplacementList", "\[Rule]", "0"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonzero", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"AllColoredPMs", "//.", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
       RowBox[{"Thread", "[", 
        RowBox[{"ReplacementList", "\[Rule]", "0"}], "]"}]}], "]"}], "[", 
     "\"\<NonzeroPositions\>\"", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"norm", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"coef", "[", 
       RowBox[{"[", 
        RowBox[{"nonzero", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "^", "2"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "nonzero", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resstate", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"coeftmp", " ", "=", " ", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"coef", "[", 
          RowBox[{"[", 
           RowBox[{"nonzero", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "/", 
         RowBox[{"Sqrt", "[", "norm", "]"}]}], ",", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "3"}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"coeftmp", "\[NotEqual]", "0"}], ",", 
       RowBox[{"resstate", " ", "=", 
        RowBox[{
         RowBox[{"resstate", "+", 
          RowBox[{"coeftmp", 
           RowBox[{"(", 
            RowBox[{"AllColoredPMs", "[", 
             RowBox[{"[", 
              RowBox[{"nonzero", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ")"}]}]}], "//.", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"cc1_", ",", "cc2_", ",", "a_", ",", "b_"}], "]"}], 
          "\[Rule]", 
          RowBox[{
           RowBox[{"a", "[", "cc1", "]"}], "*", 
           RowBox[{"b", "[", "cc2", "]"}]}]}]}]}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "nonzero", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Target state =\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "state", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Obtained state = \>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Chop", "[", "resstate", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Graph weights:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"sol", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Total time optimization = \>\"", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"TimeLogicOpt", "+", "TimeOpt"}], ")"}], "/", "60"}], ",", 
   "\"\< min\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Total time(problem generation + optimization) = \>\"", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
     "TimePM", "+", "TimeKlauses", "+", "TimeLogicOpt", "+", "TimeOpt"}], 
     ")"}], "/", "60"}], ",", "\"\< min\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.8308034883771353`*^9, 3.830803640037247*^9}, {
   3.830803700314139*^9, 3.8308038542768235`*^9}, {3.830803916736555*^9, 
   3.8308039963028917`*^9}, {3.830804042303156*^9, 3.830804045838134*^9}, {
   3.8308040867200756`*^9, 3.8308041613702717`*^9}, {3.83080420043372*^9, 
   3.8308042680112267`*^9}, 3.8308044155050507`*^9, {3.8308045524433775`*^9, 
   3.8308046814520235`*^9}, {3.83080472345652*^9, 3.8308048057563353`*^9}, {
   3.8308048834954576`*^9, 3.8308049172208004`*^9}, {3.8308050023701735`*^9, 
   3.830805023515823*^9}, {3.8308070093992047`*^9, 3.8308070538202057`*^9}, {
   3.830946669914465*^9, 3.8309466715198975`*^9}, {3.8309467178627634`*^9, 
   3.830946769477664*^9}, {3.830946853107229*^9, 3.8309468561630015`*^9}, {
   3.83094700544755*^9, 3.830947008516204*^9}, {3.8309472995341387`*^9, 
   3.830947301168871*^9}, {3.8309473920348067`*^9, 3.8309476353277807`*^9}, {
   3.830947830910516*^9, 3.8309478316838093`*^9}, {3.8309486273887925`*^9, 
   3.830948638922086*^9}, {3.8309489417642803`*^9, 3.8309489879668694`*^9}, {
   3.8309510516165276`*^9, 3.8309510804751215`*^9}, {3.8309511263737392`*^9, 
   3.830951229385968*^9}, 3.831133086828349*^9, 3.831133163961599*^9, 
   3.831133514845869*^9, 3.831151265301836*^9, {3.8311513371676226`*^9, 
   3.831151356063946*^9}, {3.831151712100889*^9, 3.8311517491331306`*^9}, {
   3.831151833537751*^9, 3.831151862308417*^9}, {3.831151931886153*^9, 
   3.8311519320281906`*^9}, {3.8311521954776044`*^9, 
   3.8311522340132265`*^9}, {3.831152273936866*^9, 3.8311522910491047`*^9}, {
   3.831152621631105*^9, 3.8311526234752636`*^9}, {3.8311527929830575`*^9, 
   3.8311528459181623`*^9}, {3.8311528767656827`*^9, 3.831152891127142*^9}, {
   3.83115486402612*^9, 3.8311548778991294`*^9}, {3.8312079232165756`*^9, 
   3.831207923758317*^9}, {3.831306166342755*^9, 3.8313061916527886`*^9}, {
   3.831306223507221*^9, 3.8313062323084326`*^9}, {3.8313062658434067`*^9, 
   3.8313063182537236`*^9}, {3.831306460604813*^9, 3.8313065752894745`*^9}, {
   3.831306674267243*^9, 3.831306785802181*^9}, {3.8313068222816467`*^9, 
   3.8313069292752457`*^9}, {3.8313102696005754`*^9, 
   3.8313104295424957`*^9}, {3.8313104788237314`*^9, 
   3.8313105980251036`*^9}, {3.831310649772814*^9, 3.8313106558233356`*^9}, {
   3.8313107098963394`*^9, 3.831310768224683*^9}, {3.8347468776694264`*^9, 
   3.8347468991323056`*^9}, {3.8347484174705424`*^9, 
   3.8347487306227493`*^9}, {3.834748770805995*^9, 3.8347488580753202`*^9}, {
   3.834748888265519*^9, 3.834749217634731*^9}, {3.834749265698225*^9, 
   3.834749289745623*^9}, {3.834749323702216*^9, 3.834749496978363*^9}, {
   3.834749534634535*^9, 3.834749562804103*^9}, {3.8347496680786676`*^9, 
   3.834749704310213*^9}, {3.8347497908910794`*^9, 3.8347497994005427`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Logic reduction completed.\"\>"], "Print",
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024050865`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Solution = \"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"/\"\>", "\[InvisibleSpace]", "54", 
   "\[InvisibleSpace]", "\<\" weights, \[CapitalDelta]t = \"\>", 
   "\[InvisibleSpace]", "0.001378875`6.369221141476196", 
   "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "Solution = ", 6, "/", 54, " weights, \[CapitalDelta]t = ", 
   0.001378875`6.369221141476196, " min"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.834749902413082*^9}}],

Cell[BoxData["\<\"Optimization completed. \"\>"], "Print",
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.83474990246908*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fidelity = \"\>", "\[InvisibleSpace]", "0.9999991123329718`", 
   "\[InvisibleSpace]", "\<\", \[CapitalDelta]t = \"\>", "\[InvisibleSpace]", 
   "0.00040001`5.831767092433911", "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "Fidelity = ", 0.9999991123329718, ", \[CapitalDelta]t = ", 
   0.00040001`5.831767092433911, " min"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.834749902477083*^9}}],

Cell[BoxData["\<\"Target state found!\"\>"], "Print",
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.834749902477083*^9}}],

Cell[BoxData["\<\"Target state =\"\>"], "Print",
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024850845`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024850845`*^9}}],

Cell[BoxData["\<\"Obtained state = \"\>"], "Print",
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.834749902493081*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.576702590187258`", " ", 
   RowBox[{"\<\"a\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.5773139099974642`", " ", 
   RowBox[{"\<\"a\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "1", "]"}]}], "+", 
  RowBox[{"0.5780335386417879`", " ", 
   RowBox[{"\<\"a\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "2", "]"}]}]}]], "Print",
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499025010805`*^9}}],

Cell[BoxData["\<\"Graph weights:\"\>"], "Print",
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499025090804`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "0", ",", "\<\"a\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", "0.6559245744734337`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "0", ",", "\<\"b\"\>", ",", "\<\"c\"\>"}], "]"}], 
    "\[Rule]", "0.831031006535999`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "1", ",", "\<\"a\"\>", ",", "\<\"c\"\>"}], "]"}], 
    "\[Rule]", "0.9648652131601759`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "1", ",", "\<\"b\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", "0.5655416584736846`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"2", ",", "2", ",", "\<\"a\"\>", ",", "\<\"b\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "0.7075229872074765`"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"2", ",", "2", ",", "\<\"c\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "0.7722034035688973`"}]}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499025170827`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time optimization = \"\>", "\[InvisibleSpace]", 
   "0.001778885`6.1788141212687835", "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "Total time optimization = ", 0.001778885`6.1788141212687835, " min"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499025170827`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time(problem generation + optimization) = \"\>", 
   "\[InvisibleSpace]", "0.0029778266666666667`6.0046256542824405", 
   "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "Total time(problem generation + optimization) = ", 
   0.0029778266666666667`6.0046256542824405, " min"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499025250807`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 956},
WindowMargins->{{-11, Automatic}, {Automatic, -11}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.0 para Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 89, 1, 150, "Title"],
Cell[672, 25, 211, 4, 84, "Subtitle"],
Cell[CellGroupData[{
Cell[908, 33, 165, 2, 106, "Section"],
Cell[CellGroupData[{
Cell[1098, 39, 100, 1, 72, "Subsection"],
Cell[1201, 42, 1355, 34, 161, "Text"],
Cell[2559, 78, 3637, 95, 162, "Input"],
Cell[6199, 175, 108, 1, 45, "Text"],
Cell[6310, 178, 391, 8, 45, "Input"],
Cell[6704, 188, 243, 4, 45, "Text"],
Cell[CellGroupData[{
Cell[6972, 196, 7140, 116, 220, "Input"],
Cell[CellGroupData[{
Cell[14137, 316, 4143, 63, 34, "Print"],
Cell[18283, 381, 3823, 54, 34, "Print"],
Cell[22109, 437, 3823, 54, 34, "Print"],
Cell[25935, 493, 3815, 54, 34, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29811, 554, 419, 5, 72, "Subsection"],
Cell[30233, 561, 1081, 18, 188, "Text"],
Cell[31317, 581, 8753, 233, 800, "Input"],
Cell[40073, 816, 427, 7, 74, "Text"],
Cell[40503, 825, 5436, 136, 481, "Input"],
Cell[CellGroupData[{
Cell[45964, 965, 2189, 43, 191, "Input"],
Cell[CellGroupData[{
Cell[48178, 1012, 2813, 41, 34, "Print"],
Cell[50994, 1055, 2877, 42, 34, "Print"],
Cell[53874, 1099, 2887, 42, 34, "Print"],
Cell[56764, 1143, 2857, 42, 34, "Print"],
Cell[59624, 1187, 2951, 44, 34, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62636, 1238, 152, 2, 72, "Subsection"],
Cell[62791, 1242, 3732, 93, 687, "Text"],
Cell[CellGroupData[{
Cell[66548, 1339, 5524, 124, 510, "Input"],
Cell[CellGroupData[{
Cell[72097, 1467, 2052, 30, 34, "Print"],
Cell[74152, 1499, 2066, 31, 34, "Print"],
Cell[76221, 1532, 2137, 31, 34, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[78419, 1570, 319, 4, 72, "Subsection"],
Cell[78741, 1576, 212, 4, 45, "Text"],
Cell[78956, 1582, 1468, 33, 139, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[80473, 1621, 118, 2, 106, "Section"],
Cell[80594, 1625, 520, 8, 131, "Text"],
Cell[CellGroupData[{
Cell[81139, 1637, 901, 20, 162, "Input"],
Cell[82043, 1659, 286, 4, 45, "Output"],
Cell[82332, 1665, 493, 9, 34, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[82874, 1680, 178, 2, 106, "Section"],
Cell[83055, 1684, 1269, 21, 330, "Text"],
Cell[CellGroupData[{
Cell[84349, 1709, 15611, 373, 2163, "Input"],
Cell[CellGroupData[{
Cell[99985, 2086, 532, 7, 34, "Print"],
Cell[100520, 2095, 946, 17, 34, "Print"],
Cell[101469, 2114, 527, 7, 34, "Print"],
Cell[101999, 2123, 885, 15, 34, "Print"],
Cell[102887, 2140, 523, 7, 34, "Print"],
Cell[103413, 2149, 520, 7, 34, "Print"],
Cell[103936, 2158, 761, 15, 34, "Print"],
Cell[104700, 2175, 521, 7, 34, "Print"],
Cell[105224, 2184, 1187, 23, 34, "Print"],
Cell[106414, 2209, 520, 7, 34, "Print"],
Cell[106937, 2218, 1493, 35, 34, "Print"],
Cell[108433, 2255, 770, 13, 34, "Print"],
Cell[109206, 2270, 842, 15, 34, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

