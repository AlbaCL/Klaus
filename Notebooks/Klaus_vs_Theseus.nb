(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    188371,       4288]
NotebookOptionsPosition[    181287,       4050]
NotebookOutlinePosition[    181666,       4066]
CellTagsIndexPosition[    181623,       4063]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Klaus vs Theseus", "Title",
 InitializationCell->True,
 CellChangeTimes->{{3.83474066012204*^9, 3.8347406618031206`*^9}, {
  3.8348251738616643`*^9, 3.834825175636065*^9}}],

Cell["Benchmarking the two algorithms and their combination", "Subtitle",
 InitializationCell->True,
 CellChangeTimes->{{3.834740676261134*^9, 3.8347406940175095`*^9}, {
  3.834749745004116*^9, 3.834749763726884*^9}, {3.834825179076508*^9, 
  3.83482518449337*^9}, {3.834829624870829*^9, 3.8348296272333794`*^9}}],

Cell[CellGroupData[{

Cell["Setting the problem", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.828637692310732*^9, 3.8286376977252903`*^9}},
 ExpressionUUID -> "a07a82a8-17b9-4d0c-8e61-972f96da3089"],

Cell[CellGroupData[{

Cell["Target state", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.834742121413145*^9, 3.834742124074437*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GHZ", "[", 
   RowBox[{"n_", ",", "d_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ConstantArray", "[", 
     RowBox[{"i", ",", "n"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SRV544", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "1", ",", "3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SRV644", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "2"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SRV654", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SRV955", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "4", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "4", ",", "1"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8314618773947997`*^9, 3.831461983454973*^9}, {
   3.831462140539141*^9, 3.831462141528133*^9}, {3.831464062102363*^9, 
   3.8314640685973577`*^9}, {3.8314746955395184`*^9, 3.831474720553853*^9}, {
   3.831474809932808*^9, 3.8314748256632805`*^9}, {3.8314748764052606`*^9, 
   3.8314748968297462`*^9}, {3.8314749416320276`*^9, 
   3.8314749575904503`*^9}, {3.831474990627737*^9, 3.8314750695503225`*^9}, {
   3.831475897557233*^9, 3.831475918013197*^9}, {3.8314777606164436`*^9, 
   3.8314778187761655`*^9}, {3.8314780943898454`*^9, 3.831478094646113*^9}, 
   3.831493923139779*^9, {3.831577667307832*^9, 3.8315777086477785`*^9}, {
   3.8315780560916233`*^9, 3.831578110363468*^9}, {3.831584184412794*^9, 
   3.8315842463649263`*^9}, {3.831584613486063*^9, 3.8315846212609267`*^9}, {
   3.832010457321005*^9, 3.832010465688012*^9}, {3.832304667369259*^9, 
   3.8323047455344963`*^9}, {3.834741355003332*^9, 3.834741359354031*^9}, 
   3.834741396537224*^9, 3.8347421350281487`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"state", " ", "=", "SRV654"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8347413878052826`*^9, 3.8347413945970373`*^9}, {
   3.8347416571388865`*^9, 3.8347417106750603`*^9}, {3.8347453332634225`*^9, 
   3.834745335728074*^9}, 3.8347495941092105`*^9, {3.8347498546400905`*^9, 
   3.8347498599265327`*^9}, 3.834829145510394*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "state", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], "\[NotEqual]", 
     "0"}], ",", 
    RowBox[{"state", " ", "=", 
     RowBox[{
      RowBox[{"Append", "[", "0", "]"}], "/@", "state"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<State basis elements: \>\"", ",", " ", "state"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pathmax", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"state", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmax", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", "state", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<number of parties (n) = \>\"", ",", " ", "pathmax"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", " ", 
  RowBox[{"\"\<number of colors (d) = \>\"", ",", " ", "cmax"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", " ", 
  RowBox[{"\"\<# basis elements = \>\"", ",", 
   RowBox[{"Length", "[", "state", "]"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8285568905167108`*^9, 3.8285568924855337`*^9}, 
   3.8285569349300933`*^9, {3.8285601952623763`*^9, 3.8285602090625844`*^9}, 
   3.8285604746687813`*^9, {3.828560621695086*^9, 3.828560622071725*^9}, {
   3.828561235920785*^9, 3.828561249658967*^9}, {3.828561443170952*^9, 
   3.8285614621874886`*^9}, {3.8285619558737497`*^9, 3.8285619577332106`*^9}, 
   3.8285620081901217`*^9, 3.828564559934535*^9, {3.82856859847847*^9, 
   3.8285685989159913`*^9}, 3.8285714431452303`*^9, 3.8285716222457523`*^9, {
   3.8285719430910287`*^9, 3.828571946184923*^9}, 3.828573329677315*^9, {
   3.8286355322336693`*^9, 3.8286355385568933`*^9}, {3.8286355780366297`*^9, 
   3.8286355859249125`*^9}, {3.828636365532787*^9, 3.8286363656532164`*^9}, {
   3.828637291446828*^9, 3.828637291568937*^9}, {3.8286403949831953`*^9, 
   3.8286404019715652`*^9}, {3.828640702674228*^9, 3.8286407053482804`*^9}, {
   3.8286408378231354`*^9, 3.828640839956668*^9}, {3.8286411378970413`*^9, 
   3.8286411399004087`*^9}, {3.828641202498563*^9, 3.8286412042719536`*^9}, {
   3.8286969091022453`*^9, 3.828696945821905*^9}, {3.8286969891241283`*^9, 
   3.828697392107012*^9}, {3.8286989440382752`*^9, 3.828698981580079*^9}, {
   3.8287002705327725`*^9, 3.828700300250745*^9}, {3.828701780419053*^9, 
   3.8287018298270397`*^9}, {3.8287150871357946`*^9, 
   3.8287150952425933`*^9}, {3.8287151833595963`*^9, 3.8287152004341335`*^9}, 
   3.828715281790783*^9, {3.8287247414606876`*^9, 3.828724744883686*^9}, {
   3.828724937999462*^9, 3.8287249427709045`*^9}, {3.8287249842282963`*^9, 
   3.82872498682012*^9}, {3.828725038568946*^9, 3.8287250410515876`*^9}, {
   3.8287254534274125`*^9, 3.828725456064741*^9}, {3.8287261450637255`*^9, 
   3.8287261529013567`*^9}, {3.82872624504677*^9, 3.828726252695326*^9}, {
   3.828727861144233*^9, 3.8287278628005924`*^9}, {3.8308029166005745`*^9, 
   3.830802923005029*^9}, {3.830804290938986*^9, 3.8308043164416633`*^9}, {
   3.8308051070213714`*^9, 3.83080513189929*^9}, {3.830806212943901*^9, 
   3.830806314874281*^9}, {3.8308065738767104`*^9, 3.8308065784124928`*^9}, {
   3.8308066521579638`*^9, 3.8308066735163603`*^9}, {3.8308067525661383`*^9, 
   3.830806755453692*^9}, {3.8308069087204447`*^9, 3.830806927549199*^9}, {
   3.830854851633594*^9, 3.8308548753651886`*^9}, {3.8309464625398307`*^9, 
   3.83094656271091*^9}, {3.830948743099448*^9, 3.8309487549917064`*^9}, {
   3.830952033476364*^9, 3.8309520362360888`*^9}, {3.8310628995107536`*^9, 
   3.8310629119042187`*^9}, {3.831063205738948*^9, 3.8310632461664653`*^9}, {
   3.8311295924019375`*^9, 3.8311295930687747`*^9}, 3.831131835591666*^9, {
   3.831131896656737*^9, 3.8311319049473963`*^9}, {3.831148090767306*^9, 
   3.831148093782132*^9}, {3.8311481256991444`*^9, 3.8311481369550643`*^9}, {
   3.8311484975190887`*^9, 3.8311485087428207`*^9}, {3.831148671608079*^9, 
   3.8311486986848793`*^9}, {3.831151415029112*^9, 3.8311514189573407`*^9}, {
   3.8311516053387175`*^9, 3.8311516092016563`*^9}, 3.8311525751754727`*^9, {
   3.8311538106459227`*^9, 3.8311538168422594`*^9}, {3.831153858510036*^9, 
   3.831153890885989*^9}, 3.831154834691044*^9, {3.8312047782200584`*^9, 
   3.8312047910597973`*^9}, {3.8312057628780513`*^9, 3.831205780278996*^9}, {
   3.831207861708065*^9, 3.8312078676882615`*^9}, {3.8312079378660326`*^9, 
   3.8312079380429287`*^9}, {3.831207989274219*^9, 3.831207989399488*^9}, {
   3.831208678942237*^9, 3.831208679274067*^9}, {3.831209617689091*^9, 
   3.831209618900792*^9}, {3.8313060985510406`*^9, 3.831306100443753*^9}, {
   3.831310238706025*^9, 3.831310238955774*^9}, {3.83146197456402*^9, 
   3.8314620789035416`*^9}, 3.831462113821163*^9, {3.83146378908657*^9, 
   3.831463789388192*^9}, {3.83146427868756*^9, 3.831464279113372*^9}, {
   3.831465821587332*^9, 3.8314658397863054`*^9}, {3.831466048673684*^9, 
   3.831466048924904*^9}, 3.831474764024851*^9, {3.8314750188501105`*^9, 
   3.831475018983217*^9}, 3.8314759534446917`*^9, {3.8314778251142488`*^9, 
   3.8314778284699583`*^9}, {3.831479068899577*^9, 3.831479069221682*^9}, {
   3.8314939299792595`*^9, 3.8314939301392603`*^9}, {3.8315472457824316`*^9, 
   3.8315472476188307`*^9}, {3.8315479459651985`*^9, 
   3.8315479649810705`*^9}, {3.83154800696589*^9, 3.8315480071148148`*^9}, {
   3.8315482140657854`*^9, 3.8315482142568736`*^9}, {3.8315482629203167`*^9, 
   3.8315482701358395`*^9}, 3.8315486234478855`*^9, {3.8315495512352285`*^9, 
   3.8315495554321737`*^9}, {3.831549764492319*^9, 3.831549765092353*^9}, 
   3.831568040887986*^9, {3.83156808292037*^9, 3.8315680829828568`*^9}, 
   3.8315681352935305`*^9, {3.8315728790015936`*^9, 3.831572880614397*^9}, 
   3.8315730096078014`*^9, {3.8315730576570396`*^9, 3.831573058454728*^9}, {
   3.8315753571472034`*^9, 3.8315753696241903`*^9}, {3.8315754244774313`*^9, 
   3.831575424733043*^9}, {3.831577717436635*^9, 3.831577717705131*^9}, {
   3.8315791825739603`*^9, 3.831579187162383*^9}, {3.831584257822888*^9, 
   3.8315842583151054`*^9}, {3.8315846239521904`*^9, 
   3.8315846240267982`*^9}, {3.8320104757487087`*^9, 3.832010512026226*^9}, 
   3.832011211766298*^9, {3.832013623573371*^9, 3.8320136237139983`*^9}, {
   3.832014350417116*^9, 3.8320143506712203`*^9}, {3.832015088369503*^9, 
   3.832015096424452*^9}, 3.8320163262631025`*^9, {3.83230451604627*^9, 
   3.832304519139711*^9}, 3.832304716536887*^9, {3.832304758999318*^9, 
   3.8323047591278467`*^9}, {3.832304948758739*^9, 3.8323049490115643`*^9}, {
   3.834741401392434*^9, 3.8347415179955597`*^9}, {3.8347416149159403`*^9, 
   3.834741650272337*^9}, {3.834741872989637*^9, 3.8347418996649466`*^9}, {
   3.834741930927371*^9, 3.834741937920888*^9}, {3.8347420067503757`*^9, 
   3.834742108566307*^9}, {3.834742248766259*^9, 3.834742253855859*^9}},
 ExpressionUUID -> "9760a019-8346-4d65-ad46-21b7ce597fb3"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"State basis elements: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "3", ",", "0"}], "}"}]}], "}"}]}],
  SequenceForm[
  "State basis elements: ", {{0, 0, 0, 0}, {1, 1, 1, 0}, {2, 2, 2, 0}, {3, 3, 
   0, 0}, {4, 4, 0, 0}, {5, 1, 3, 0}}],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8286972389629955`*^9, {3.8286972771228876`*^9, 3.8286973040794477`*^9}, {
   3.828697373309499*^9, 3.8286973925091314`*^9}, 3.8286989826399317`*^9, {
   3.8287002858284025`*^9, 3.828700301034376*^9}, 3.82870183096319*^9, 
   3.8287116743725815`*^9, 3.82871388022532*^9, 3.828715207215643*^9, 
   3.8287152824393983`*^9, 3.8287196309079514`*^9, {3.8287247458948193`*^9, 
   3.828724763473403*^9}, 3.8287249536090803`*^9, 3.828724997162219*^9, 
   3.8287250436352215`*^9, 3.828725459464368*^9, 3.8287261581266375`*^9, 
   3.8287262584675083`*^9, 3.828727461969286*^9, {3.8287278632693453`*^9, 
   3.828727889741331*^9}, 3.8308029795401564`*^9, 3.8308043183214397`*^9, 
   3.830805132411755*^9, {3.8308062718652515`*^9, 3.8308063153526645`*^9}, 
   3.8308065801918716`*^9, 3.8308066741676474`*^9, 3.8308067572326503`*^9, 
   3.830806928573909*^9, 3.8308555105097895`*^9, 3.830946564499009*^9, 
   3.8309469090924644`*^9, 3.8309487569835896`*^9, 3.8309509453818245`*^9, 
   3.8310535802908506`*^9, 3.831062913123316*^9, {3.831063223671028*^9, 
   3.8310632468233347`*^9}, 3.8311138646693044`*^9, 3.831118129293767*^9, 
   3.8311318370271997`*^9, 3.8311319055455017`*^9, 3.8311332619140987`*^9, 
   3.831133345518193*^9, 3.8311334229801917`*^9, 3.8311478215450554`*^9, 
   3.8311480949171906`*^9, 3.8311481383761926`*^9, {3.8311486838139114`*^9, 
   3.8311486993177943`*^9}, 3.831149980730213*^9, 3.831151229334722*^9, 
   3.831151419914904*^9, 3.8311516096562243`*^9, 3.831152582896985*^9, {
   3.831153886653679*^9, 3.831153891614458*^9}, 3.8311548364967813`*^9, 
   3.83120479822985*^9, 3.831205412794499*^9, {3.831205783636875*^9, 
   3.831205797461563*^9}, {3.8312078799589863`*^9, 3.8312078881512084`*^9}, {
   3.8312079391892924`*^9, 3.8312079480897975`*^9}, 3.831207989808286*^9, 
   3.831208683961857*^9, 3.831209621676447*^9, 3.8313061057522097`*^9, 
   3.831310239487177*^9, 3.8313159936649237`*^9, {3.831462107708538*^9, 
   3.831462145014356*^9}, 3.831462844599182*^9, 3.8314637974128075`*^9, {
   3.831464284072832*^9, 3.8314642896120877`*^9}, {3.831465827551945*^9, 
   3.831465840984326*^9}, 3.8314660498471375`*^9, 3.8314747646708236`*^9, 
   3.8314748294774747`*^9, 3.831474899193644*^9, 3.8314749602787204`*^9, 
   3.831475078003682*^9, 3.8314759572746906`*^9, 3.8314778304345293`*^9, 
   3.8314781090598936`*^9, 3.831479070048974*^9, 3.831480914537033*^9, 
   3.831481027167573*^9, 3.831493930875705*^9, 3.831547248367175*^9, {
   3.8315479465112567`*^9, 3.8315479653116813`*^9}, 3.8315480075140095`*^9, 
   3.831548215450108*^9, 3.8315482707902765`*^9, 3.831548625053161*^9, 
   3.831549194519114*^9, 3.8315495561364827`*^9, 3.8315497653377748`*^9, 
   3.8315680413952236`*^9, 3.8315680833063707`*^9, 3.8315681366781416`*^9, 
   3.831572754319397*^9, 3.831572881123384*^9, 3.831573010746132*^9, 
   3.831573058799736*^9, {3.831575357567088*^9, 3.8315753699500065`*^9}, 
   3.8315754251099033`*^9, 3.831577730994399*^9, {3.831579187674114*^9, 
   3.831579215918906*^9}, 3.8315842589899874`*^9, 3.8315846244372106`*^9, 
   3.8320112132505207`*^9, 3.83201287693528*^9, 3.8320136350152354`*^9, 
   3.8320143515561147`*^9, 3.832015102756445*^9, 3.8320163312166023`*^9, 
   3.8323045207385387`*^9, 3.8323047179111094`*^9, {3.8323047538496337`*^9, 
   3.832304759804618*^9}, 3.8323049497387652`*^9, {3.834741902019503*^9, 
   3.8347419534961004`*^9}, {3.8347420775948153`*^9, 3.8347421109411635`*^9}, 
   3.8347453378750906`*^9, 3.83474924391693*^9, 3.8347496014238725`*^9, 
   3.8347497759705925`*^9, 3.834749865513006*^9, 3.8347499018263187`*^9, {
   3.834826706137601*^9, 3.834826706810838*^9}, 3.834828866586026*^9, 
   3.8348291477127385`*^9, 3.83482924634933*^9, {3.834829512965508*^9, 
   3.8348295232061467`*^9}, {3.8348295538600283`*^9, 3.8348295905080643`*^9}},
 ExpressionUUID -> "61e90243-b10c-41b6-954c-8682893863a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"number of parties (n) = \"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["number of parties (n) = ", 4],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8286972389629955`*^9, {3.8286972771228876`*^9, 3.8286973040794477`*^9}, {
   3.828697373309499*^9, 3.8286973925091314`*^9}, 3.8286989826399317`*^9, {
   3.8287002858284025`*^9, 3.828700301034376*^9}, 3.82870183096319*^9, 
   3.8287116743725815`*^9, 3.82871388022532*^9, 3.828715207215643*^9, 
   3.8287152824393983`*^9, 3.8287196309079514`*^9, {3.8287247458948193`*^9, 
   3.828724763473403*^9}, 3.8287249536090803`*^9, 3.828724997162219*^9, 
   3.8287250436352215`*^9, 3.828725459464368*^9, 3.8287261581266375`*^9, 
   3.8287262584675083`*^9, 3.828727461969286*^9, {3.8287278632693453`*^9, 
   3.828727889741331*^9}, 3.8308029795401564`*^9, 3.8308043183214397`*^9, 
   3.830805132411755*^9, {3.8308062718652515`*^9, 3.8308063153526645`*^9}, 
   3.8308065801918716`*^9, 3.8308066741676474`*^9, 3.8308067572326503`*^9, 
   3.830806928573909*^9, 3.8308555105097895`*^9, 3.830946564499009*^9, 
   3.8309469090924644`*^9, 3.8309487569835896`*^9, 3.8309509453818245`*^9, 
   3.8310535802908506`*^9, 3.831062913123316*^9, {3.831063223671028*^9, 
   3.8310632468233347`*^9}, 3.8311138646693044`*^9, 3.831118129293767*^9, 
   3.8311318370271997`*^9, 3.8311319055455017`*^9, 3.8311332619140987`*^9, 
   3.831133345518193*^9, 3.8311334229801917`*^9, 3.8311478215450554`*^9, 
   3.8311480949171906`*^9, 3.8311481383761926`*^9, {3.8311486838139114`*^9, 
   3.8311486993177943`*^9}, 3.831149980730213*^9, 3.831151229334722*^9, 
   3.831151419914904*^9, 3.8311516096562243`*^9, 3.831152582896985*^9, {
   3.831153886653679*^9, 3.831153891614458*^9}, 3.8311548364967813`*^9, 
   3.83120479822985*^9, 3.831205412794499*^9, {3.831205783636875*^9, 
   3.831205797461563*^9}, {3.8312078799589863`*^9, 3.8312078881512084`*^9}, {
   3.8312079391892924`*^9, 3.8312079480897975`*^9}, 3.831207989808286*^9, 
   3.831208683961857*^9, 3.831209621676447*^9, 3.8313061057522097`*^9, 
   3.831310239487177*^9, 3.8313159936649237`*^9, {3.831462107708538*^9, 
   3.831462145014356*^9}, 3.831462844599182*^9, 3.8314637974128075`*^9, {
   3.831464284072832*^9, 3.8314642896120877`*^9}, {3.831465827551945*^9, 
   3.831465840984326*^9}, 3.8314660498471375`*^9, 3.8314747646708236`*^9, 
   3.8314748294774747`*^9, 3.831474899193644*^9, 3.8314749602787204`*^9, 
   3.831475078003682*^9, 3.8314759572746906`*^9, 3.8314778304345293`*^9, 
   3.8314781090598936`*^9, 3.831479070048974*^9, 3.831480914537033*^9, 
   3.831481027167573*^9, 3.831493930875705*^9, 3.831547248367175*^9, {
   3.8315479465112567`*^9, 3.8315479653116813`*^9}, 3.8315480075140095`*^9, 
   3.831548215450108*^9, 3.8315482707902765`*^9, 3.831548625053161*^9, 
   3.831549194519114*^9, 3.8315495561364827`*^9, 3.8315497653377748`*^9, 
   3.8315680413952236`*^9, 3.8315680833063707`*^9, 3.8315681366781416`*^9, 
   3.831572754319397*^9, 3.831572881123384*^9, 3.831573010746132*^9, 
   3.831573058799736*^9, {3.831575357567088*^9, 3.8315753699500065`*^9}, 
   3.8315754251099033`*^9, 3.831577730994399*^9, {3.831579187674114*^9, 
   3.831579215918906*^9}, 3.8315842589899874`*^9, 3.8315846244372106`*^9, 
   3.8320112132505207`*^9, 3.83201287693528*^9, 3.8320136350152354`*^9, 
   3.8320143515561147`*^9, 3.832015102756445*^9, 3.8320163312166023`*^9, 
   3.8323045207385387`*^9, 3.8323047179111094`*^9, {3.8323047538496337`*^9, 
   3.832304759804618*^9}, 3.8323049497387652`*^9, {3.834741902019503*^9, 
   3.8347419534961004`*^9}, {3.8347420775948153`*^9, 3.8347421109411635`*^9}, 
   3.8347453378750906`*^9, 3.83474924391693*^9, 3.8347496014238725`*^9, 
   3.8347497759705925`*^9, 3.834749865513006*^9, 3.8347499018263187`*^9, {
   3.834826706137601*^9, 3.834826706810838*^9}, 3.834828866586026*^9, 
   3.8348291477127385`*^9, 3.83482924634933*^9, {3.834829512965508*^9, 
   3.8348295232061467`*^9}, {3.8348295538600283`*^9, 3.834829590514061*^9}},
 ExpressionUUID -> "61e90243-b10c-41b6-954c-8682893863a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"number of colors (d) = \"\>", "\[InvisibleSpace]", "6"}],
  SequenceForm["number of colors (d) = ", 6],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8286972389629955`*^9, {3.8286972771228876`*^9, 3.8286973040794477`*^9}, {
   3.828697373309499*^9, 3.8286973925091314`*^9}, 3.8286989826399317`*^9, {
   3.8287002858284025`*^9, 3.828700301034376*^9}, 3.82870183096319*^9, 
   3.8287116743725815`*^9, 3.82871388022532*^9, 3.828715207215643*^9, 
   3.8287152824393983`*^9, 3.8287196309079514`*^9, {3.8287247458948193`*^9, 
   3.828724763473403*^9}, 3.8287249536090803`*^9, 3.828724997162219*^9, 
   3.8287250436352215`*^9, 3.828725459464368*^9, 3.8287261581266375`*^9, 
   3.8287262584675083`*^9, 3.828727461969286*^9, {3.8287278632693453`*^9, 
   3.828727889741331*^9}, 3.8308029795401564`*^9, 3.8308043183214397`*^9, 
   3.830805132411755*^9, {3.8308062718652515`*^9, 3.8308063153526645`*^9}, 
   3.8308065801918716`*^9, 3.8308066741676474`*^9, 3.8308067572326503`*^9, 
   3.830806928573909*^9, 3.8308555105097895`*^9, 3.830946564499009*^9, 
   3.8309469090924644`*^9, 3.8309487569835896`*^9, 3.8309509453818245`*^9, 
   3.8310535802908506`*^9, 3.831062913123316*^9, {3.831063223671028*^9, 
   3.8310632468233347`*^9}, 3.8311138646693044`*^9, 3.831118129293767*^9, 
   3.8311318370271997`*^9, 3.8311319055455017`*^9, 3.8311332619140987`*^9, 
   3.831133345518193*^9, 3.8311334229801917`*^9, 3.8311478215450554`*^9, 
   3.8311480949171906`*^9, 3.8311481383761926`*^9, {3.8311486838139114`*^9, 
   3.8311486993177943`*^9}, 3.831149980730213*^9, 3.831151229334722*^9, 
   3.831151419914904*^9, 3.8311516096562243`*^9, 3.831152582896985*^9, {
   3.831153886653679*^9, 3.831153891614458*^9}, 3.8311548364967813`*^9, 
   3.83120479822985*^9, 3.831205412794499*^9, {3.831205783636875*^9, 
   3.831205797461563*^9}, {3.8312078799589863`*^9, 3.8312078881512084`*^9}, {
   3.8312079391892924`*^9, 3.8312079480897975`*^9}, 3.831207989808286*^9, 
   3.831208683961857*^9, 3.831209621676447*^9, 3.8313061057522097`*^9, 
   3.831310239487177*^9, 3.8313159936649237`*^9, {3.831462107708538*^9, 
   3.831462145014356*^9}, 3.831462844599182*^9, 3.8314637974128075`*^9, {
   3.831464284072832*^9, 3.8314642896120877`*^9}, {3.831465827551945*^9, 
   3.831465840984326*^9}, 3.8314660498471375`*^9, 3.8314747646708236`*^9, 
   3.8314748294774747`*^9, 3.831474899193644*^9, 3.8314749602787204`*^9, 
   3.831475078003682*^9, 3.8314759572746906`*^9, 3.8314778304345293`*^9, 
   3.8314781090598936`*^9, 3.831479070048974*^9, 3.831480914537033*^9, 
   3.831481027167573*^9, 3.831493930875705*^9, 3.831547248367175*^9, {
   3.8315479465112567`*^9, 3.8315479653116813`*^9}, 3.8315480075140095`*^9, 
   3.831548215450108*^9, 3.8315482707902765`*^9, 3.831548625053161*^9, 
   3.831549194519114*^9, 3.8315495561364827`*^9, 3.8315497653377748`*^9, 
   3.8315680413952236`*^9, 3.8315680833063707`*^9, 3.8315681366781416`*^9, 
   3.831572754319397*^9, 3.831572881123384*^9, 3.831573010746132*^9, 
   3.831573058799736*^9, {3.831575357567088*^9, 3.8315753699500065`*^9}, 
   3.8315754251099033`*^9, 3.831577730994399*^9, {3.831579187674114*^9, 
   3.831579215918906*^9}, 3.8315842589899874`*^9, 3.8315846244372106`*^9, 
   3.8320112132505207`*^9, 3.83201287693528*^9, 3.8320136350152354`*^9, 
   3.8320143515561147`*^9, 3.832015102756445*^9, 3.8320163312166023`*^9, 
   3.8323045207385387`*^9, 3.8323047179111094`*^9, {3.8323047538496337`*^9, 
   3.832304759804618*^9}, 3.8323049497387652`*^9, {3.834741902019503*^9, 
   3.8347419534961004`*^9}, {3.8347420775948153`*^9, 3.8347421109411635`*^9}, 
   3.8347453378750906`*^9, 3.83474924391693*^9, 3.8347496014238725`*^9, 
   3.8347497759705925`*^9, 3.834749865513006*^9, 3.8347499018263187`*^9, {
   3.834826706137601*^9, 3.834826706810838*^9}, 3.834828866586026*^9, 
   3.8348291477127385`*^9, 3.83482924634933*^9, {3.834829512965508*^9, 
   3.8348295232061467`*^9}, {3.8348295538600283`*^9, 3.8348295905220623`*^9}},
 ExpressionUUID -> "61e90243-b10c-41b6-954c-8682893863a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# basis elements = \"\>", "\[InvisibleSpace]", "6"}],
  SequenceForm["# basis elements = ", 6],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8286972389629955`*^9, {3.8286972771228876`*^9, 3.8286973040794477`*^9}, {
   3.828697373309499*^9, 3.8286973925091314`*^9}, 3.8286989826399317`*^9, {
   3.8287002858284025`*^9, 3.828700301034376*^9}, 3.82870183096319*^9, 
   3.8287116743725815`*^9, 3.82871388022532*^9, 3.828715207215643*^9, 
   3.8287152824393983`*^9, 3.8287196309079514`*^9, {3.8287247458948193`*^9, 
   3.828724763473403*^9}, 3.8287249536090803`*^9, 3.828724997162219*^9, 
   3.8287250436352215`*^9, 3.828725459464368*^9, 3.8287261581266375`*^9, 
   3.8287262584675083`*^9, 3.828727461969286*^9, {3.8287278632693453`*^9, 
   3.828727889741331*^9}, 3.8308029795401564`*^9, 3.8308043183214397`*^9, 
   3.830805132411755*^9, {3.8308062718652515`*^9, 3.8308063153526645`*^9}, 
   3.8308065801918716`*^9, 3.8308066741676474`*^9, 3.8308067572326503`*^9, 
   3.830806928573909*^9, 3.8308555105097895`*^9, 3.830946564499009*^9, 
   3.8309469090924644`*^9, 3.8309487569835896`*^9, 3.8309509453818245`*^9, 
   3.8310535802908506`*^9, 3.831062913123316*^9, {3.831063223671028*^9, 
   3.8310632468233347`*^9}, 3.8311138646693044`*^9, 3.831118129293767*^9, 
   3.8311318370271997`*^9, 3.8311319055455017`*^9, 3.8311332619140987`*^9, 
   3.831133345518193*^9, 3.8311334229801917`*^9, 3.8311478215450554`*^9, 
   3.8311480949171906`*^9, 3.8311481383761926`*^9, {3.8311486838139114`*^9, 
   3.8311486993177943`*^9}, 3.831149980730213*^9, 3.831151229334722*^9, 
   3.831151419914904*^9, 3.8311516096562243`*^9, 3.831152582896985*^9, {
   3.831153886653679*^9, 3.831153891614458*^9}, 3.8311548364967813`*^9, 
   3.83120479822985*^9, 3.831205412794499*^9, {3.831205783636875*^9, 
   3.831205797461563*^9}, {3.8312078799589863`*^9, 3.8312078881512084`*^9}, {
   3.8312079391892924`*^9, 3.8312079480897975`*^9}, 3.831207989808286*^9, 
   3.831208683961857*^9, 3.831209621676447*^9, 3.8313061057522097`*^9, 
   3.831310239487177*^9, 3.8313159936649237`*^9, {3.831462107708538*^9, 
   3.831462145014356*^9}, 3.831462844599182*^9, 3.8314637974128075`*^9, {
   3.831464284072832*^9, 3.8314642896120877`*^9}, {3.831465827551945*^9, 
   3.831465840984326*^9}, 3.8314660498471375`*^9, 3.8314747646708236`*^9, 
   3.8314748294774747`*^9, 3.831474899193644*^9, 3.8314749602787204`*^9, 
   3.831475078003682*^9, 3.8314759572746906`*^9, 3.8314778304345293`*^9, 
   3.8314781090598936`*^9, 3.831479070048974*^9, 3.831480914537033*^9, 
   3.831481027167573*^9, 3.831493930875705*^9, 3.831547248367175*^9, {
   3.8315479465112567`*^9, 3.8315479653116813`*^9}, 3.8315480075140095`*^9, 
   3.831548215450108*^9, 3.8315482707902765`*^9, 3.831548625053161*^9, 
   3.831549194519114*^9, 3.8315495561364827`*^9, 3.8315497653377748`*^9, 
   3.8315680413952236`*^9, 3.8315680833063707`*^9, 3.8315681366781416`*^9, 
   3.831572754319397*^9, 3.831572881123384*^9, 3.831573010746132*^9, 
   3.831573058799736*^9, {3.831575357567088*^9, 3.8315753699500065`*^9}, 
   3.8315754251099033`*^9, 3.831577730994399*^9, {3.831579187674114*^9, 
   3.831579215918906*^9}, 3.8315842589899874`*^9, 3.8315846244372106`*^9, 
   3.8320112132505207`*^9, 3.83201287693528*^9, 3.8320136350152354`*^9, 
   3.8320143515561147`*^9, 3.832015102756445*^9, 3.8320163312166023`*^9, 
   3.8323045207385387`*^9, 3.8323047179111094`*^9, {3.8323047538496337`*^9, 
   3.832304759804618*^9}, 3.8323049497387652`*^9, {3.834741902019503*^9, 
   3.8347419534961004`*^9}, {3.8347420775948153`*^9, 3.8347421109411635`*^9}, 
   3.8347453378750906`*^9, 3.83474924391693*^9, 3.8347496014238725`*^9, 
   3.8347497759705925`*^9, 3.834749865513006*^9, 3.8347499018263187`*^9, {
   3.834826706137601*^9, 3.834826706810838*^9}, 3.834828866586026*^9, 
   3.8348291477127385`*^9, 3.83482924634933*^9, {3.834829512965508*^9, 
   3.8348295232061467`*^9}, {3.8348295538600283`*^9, 3.8348295905290613`*^9}},
 ExpressionUUID -> "61e90243-b10c-41b6-954c-8682893863a9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate all Perfect Matchings (PM)", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.831062992045633*^9, 3.831062993547321*^9}, {
  3.831129758035858*^9, 3.8311297663083076`*^9}, {3.8311483038593845`*^9, 
  3.831148311202926*^9}, {3.831460653895191*^9, 3.8314606574323273`*^9}, {
  3.834742267424892*^9, 3.834742272991848*^9}, {3.834742725897707*^9, 
  3.834742726969103*^9}, {3.8347429527796125`*^9, 3.834742953041315*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"t0", " ", "=", " ", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Name", " ", "the", " ", "vertices", " ", "with", " ", "letters"}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"set", "=", 
    RowBox[{"FromLetterNumber", "[", 
     RowBox[{"Range", "[", "pathmax", "]"}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Generate", " ", "all", " ", "possible", " ", "Perfect", " ", "Matchings", 
    " ", 
    RowBox[{"(", 
     RowBox[{"without", " ", "colors"}], ")"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PMpaths", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Flatten", ",", 
        RowBox[{"{", 
         RowBox[{"Union", "[", 
          RowBox[{"Sort", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sort", "/@", 
               RowBox[{"Partition", "[", 
                RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "/@", 
             RowBox[{"Permutations", "[", 
              RowBox[{"set", ",", 
               RowBox[{"{", "pathmax", "}"}]}], "]"}]}], ")"}]}], "]"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "3"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Generate", " ", "all", " ", "possible", " ", "color", " ", "combinations",
     " ", "of", " ", "the", " ", "vertices"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cols", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Range", "[", "cmax", "]"}], "-", "1"}], ",", 
     RowBox[{"{", "pathmax", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VertexColorings", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"cols", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"Ordering", "@", "#"}]}], "]"}], "]"}], "&"}], "/@", 
       "PMpaths"}], ",", "1"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "List", " ", "with", " ", "all", " ", "vertex", " ", "colorings", " ", 
    "obtained", " ", "from", " ", "all", " ", "PM"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Unique", " ", "vertex", " ", "colorings"}], ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "deleting"}], " ", "the", " ", 
     "duplicates"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UniqueVertexColorings", "=", 
    RowBox[{"DeleteDuplicates", "[", "VertexColorings", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Assign", " ", "a", " ", "vertex", " ", "coloring", " ", "to", " ", "each",
     " ", "PM"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AllColoredPMsEasyEncoding", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"cols", "[", 
            RowBox[{"[", "#2", "]"}], "]"}], ",", 
           RowBox[{"PMpaths", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], ",", 
        RowBox[{"Length", "/@", 
         RowBox[{"{", 
          RowBox[{"PMpaths", ",", "cols"}], "}"}]}]}], "]"}], ",", "1"}], 
     "]"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Divide", " ", "the", " ", "PM", " ", "into", " ", "pairs", " ", 
    RowBox[{"(", 
     RowBox[{
     "that", " ", "will", " ", "correspond", " ", "to", " ", "the", " ", 
      "edge", " ", "weights"}], ")"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AllWeightsEasyEncoding", "=", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"TakeDrop", "[", 
               RowBox[{"#", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "/", "2"}]}], "]"}], 
              "&"}], "@", 
             RowBox[{"Partition", "[", 
              RowBox[{"#", ",", "2"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "2", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}]}], "}"}]}], "]"}], "&"}], ",", 
         "AllColoredPMsEasyEncoding"}], "]"}], ",", "1"}], "]"}], "]"}]}], 
   ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Translate", " ", "the", " ", "lists", " ", "into", " ", "weights"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"pathmax", "\[Equal]", "4"}], ",", 
    RowBox[{"replace", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "a1_", ",", "a2_", ",",
         "a3_", ",", "a4_"}], "}"}], "\[Rule]", 
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"c1", ",", "c2", ",", "a1", ",", "a2"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"c3", ",", "c4", ",", "a3", ",", "a4"}], "]"}]}]}]}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"pathmax", "\[Equal]", "6"}], ",", 
    RowBox[{"replace", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",",
         "a1_", ",", "a2_", ",", "a3_", ",", "a4_", ",", "a5_", ",", "a6_"}], 
       "}"}], "\[Rule]", 
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"c1", ",", "c2", ",", "a1", ",", "a2"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"c3", ",", "c4", ",", "a3", ",", "a4"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"c5", ",", "c6", ",", "a5", ",", "a6"}], "]"}]}]}]}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"pathmax", "\[Equal]", "8"}], ",", 
    RowBox[{"replace", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",",
         "c7_", ",", "c8_", ",", "a1_", ",", "a2_", ",", "a3_", ",", "a4_", 
        ",", "a5_", ",", "a6_", ",", "a7_", ",", "a8_"}], "}"}], "\[Rule]", 
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"c1", ",", "c2", ",", "a1", ",", "a2"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"c3", ",", "c4", ",", "a3", ",", "a4"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"c5", ",", "c6", ",", "a5", ",", "a6"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"c7", ",", "c8", ",", "a7", ",", "a8"}], "]"}]}]}]}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"pathmax", ">", "8"}], ",", 
    RowBox[{"Print", "[", "\"\<Write the replacement!\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllColoredPMs", " ", "=", 
   RowBox[{"AllColoredPMsEasyEncoding", "//.", "replace"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AllWeights", "=", 
    RowBox[{"AllWeightsEasyEncoding", "//.", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c1_", ",", "c2_", ",", "a1_", ",", "a2_"}], "}"}], "\[Rule]", 
      RowBox[{"w", "[", 
       RowBox[{"c1", ",", "c2", ",", "a1", ",", "a2"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", " ", "=", " ", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimePMgeneration", "=", 
   RowBox[{"t1", "-", "t0"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.830955378229126*^9, 3.830955403535102*^9}, {
   3.8310544603609095`*^9, 3.8310545941245127`*^9}, {3.8310547305195436`*^9, 
   3.831054744727934*^9}, {3.831054786338956*^9, 3.831054893177637*^9}, {
   3.8310549425679665`*^9, 3.831054954462621*^9}, {3.831056534656253*^9, 
   3.8310565468009377`*^9}, {3.8311297753751054`*^9, 
   3.8311298037027073`*^9}, {3.8311318550722294`*^9, 
   3.8311318581939774`*^9}, {3.8311481056668963`*^9, 
   3.8311481139653783`*^9}, {3.831148161197668*^9, 3.8311481853647747`*^9}, {
   3.8311483263895392`*^9, 3.8311484213691287`*^9}, 3.8311484532051306`*^9, {
   3.8311487262474904`*^9, 3.8311487271458435`*^9}, {3.8313061203962727`*^9, 
   3.8313061221383977`*^9}, {3.8314607048070884`*^9, 
   3.8314607140212345`*^9}, {3.831462160556904*^9, 3.8314621699803476`*^9}, {
   3.831546276257436*^9, 3.8315462925295825`*^9}, {3.8347422873814144`*^9, 
   3.834742437865074*^9}, {3.83474296399945*^9, 3.834743307001506*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", " ", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllColoredPMsOrdered", "=", 
   RowBox[{"AllColoredPMs", "[", 
    RowBox[{"[", 
     RowBox[{"Ordering", "@", "VertexColorings"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VertexColoringsOrdered", "=", 
    RowBox[{"Sort", "[", "VertexColorings", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Position", " ", "in", " ", "the", " ", "ordered", " ", "list", " ", "of", 
    " ", "those", " ", "PM", " ", "that", " ", "generate", " ", "an", " ", 
    "element", " ", "of", " ", "the", " ", "target", " ", "state"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PosState", " ", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"VertexColoringsOrdered", ",", 
         RowBox[{"state", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "state", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Sum", " ", "each", " ", "combination", " ", "of", " ", "PM", " ", "that", 
    " ", "generate", " ", "each", " ", "basis", " ", "element", " ", "from", 
    " ", "the", " ", "target", " ", "state"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StateColoringW", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"AllColoredPMsOrdered", "[", 
         RowBox[{"[", 
          RowBox[{"PosState", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"PosState", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", "state", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeat", " ", "the", " ", "process", " ", "to", " ", "identify", " ", 
    "those", " ", "PM", " ", "that", " ", "generate", " ", "states", " ", 
    "that", " ", "do", " ", "not", " ", "belong", " ", "to", " ", "the", " ", 
    "target", " ", "state"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NoState", "=", 
   RowBox[{"Complement", "[", 
    RowBox[{"UniqueVertexColorings", ",", "state"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PosObstructions", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{"VertexColoringsOrdered", ",", 
        RowBox[{"NoState", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "NoState", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConstraintsList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"AllColoredPMsOrdered", "[", 
      RowBox[{"[", 
       RowBox[{"PosObstructions", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "NoState", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"PosObstructions", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConstraintsListW", "=", 
    RowBox[{"Total", "[", 
     RowBox[{"ConstraintsList", ",", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", " ", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TimePMstate", "=", 
    RowBox[{"t1", "-", "t0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Number of PM: \>\"", ",", 
    RowBox[{"Length", "[", "PMpaths", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Number of PM with all color combinations: \>\"", ",", 
    RowBox[{"Length", "[", "AllColoredPMs", "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Number of different PM (= # of basis elements): \>\"", ",", 
    RowBox[{"Length", "[", "UniqueVertexColorings", "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Total number of weights (edges): \>\"", ",", 
    RowBox[{"Length", "[", "AllWeights", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimePM", "=", 
   RowBox[{"TimePMgeneration", "+", "TimePMstate"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\[CapitalDelta]t = \>\"", ",", 
   RowBox[{"TimePM", "/", "60"}], ",", "\"\< min\>\""}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.830955378229126*^9, 3.830955403535102*^9}, {
   3.8310544603609095`*^9, 3.8310545941245127`*^9}, {3.8310547305195436`*^9, 
   3.831054744727934*^9}, {3.831054786338956*^9, 3.831054893177637*^9}, {
   3.8310549425679665`*^9, 3.831054954462621*^9}, {3.831056534656253*^9, 
   3.8310565468009377`*^9}, {3.8311297753751054`*^9, 
   3.8311298037027073`*^9}, {3.8311318550722294`*^9, 
   3.8311318581939774`*^9}, {3.8311481056668963`*^9, 
   3.8311481139653783`*^9}, {3.831148161197668*^9, 3.8311481853647747`*^9}, {
   3.8311483263895392`*^9, 3.8311484213691287`*^9}, 3.8311484532051306`*^9, {
   3.8311487262474904`*^9, 3.8311487271458435`*^9}, {3.8313061203962727`*^9, 
   3.8313061221383977`*^9}, {3.8314607048070884`*^9, 
   3.8314607140212345`*^9}, {3.831462160556904*^9, 3.8314621699803476`*^9}, {
   3.831546276257436*^9, 3.8315462925295825`*^9}, {3.8347422873814144`*^9, 
   3.834742437865074*^9}, {3.83474296399945*^9, 3.834743307001506*^9}, {
   3.8347434245228853`*^9, 3.834743518632822*^9}, {3.8347435701196847`*^9, 
   3.8347436056566725`*^9}, 3.834743658695713*^9, 3.834743877452259*^9, {
   3.8347439231272936`*^9, 3.8347439380953045`*^9}, {3.834825214875106*^9, 
   3.8348252154408827`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of PM: \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["Number of PM: ", 3],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8348267063055987`*^9, 3.834826706956532*^9}, 
   3.8348288667300243`*^9, 3.83482914817575*^9, 3.834829246821334*^9, {
   3.83482951348449*^9, 3.8348295236821423`*^9}, {3.8348295543772497`*^9, 
   3.834829590965218*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of PM with all color combinations: \"\>", 
   "\[InvisibleSpace]", "3888"}],
  SequenceForm["Number of PM with all color combinations: ", 3888],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8348267063055987`*^9, 3.834826706956532*^9}, 
   3.8348288667300243`*^9, 3.83482914817575*^9, 3.834829246821334*^9, {
   3.83482951348449*^9, 3.8348295236821423`*^9}, {3.8348295543772497`*^9, 
   3.8348295909702196`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of different PM (= # of basis elements): \"\>", 
   "\[InvisibleSpace]", "1296"}],
  SequenceForm["Number of different PM (= # of basis elements): ", 1296],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8348267063055987`*^9, 3.834826706956532*^9}, 
   3.8348288667300243`*^9, 3.83482914817575*^9, 3.834829246821334*^9, {
   3.83482951348449*^9, 3.8348295236821423`*^9}, {3.8348295543772497`*^9, 
   3.834829590978219*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total number of weights (edges): \"\>", "\[InvisibleSpace]", 
   "216"}],
  SequenceForm["Total number of weights (edges): ", 216],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8348267063055987`*^9, 3.834826706956532*^9}, 
   3.8348288667300243`*^9, 3.83482914817575*^9, 3.834829246821334*^9, {
   3.83482951348449*^9, 3.8348295236821423`*^9}, {3.8348295543772497`*^9, 
   3.834829590985219*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[CapitalDelta]t = \"\>", "\[InvisibleSpace]", 
   "0.0063359333333333333`6.730476847176209", 
   "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "\[CapitalDelta]t = ", 0.0063359333333333333`6.730476847176209, " min"],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8348267063055987`*^9, 3.834826706956532*^9}, 
   3.8348288667300243`*^9, 3.83482914817575*^9, 3.834829246821334*^9, {
   3.83482951348449*^9, 3.8348295236821423`*^9}, {3.8348295543772497`*^9, 
   3.8348295909932184`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Logic", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.828637707638624*^9, 3.828637708242789*^9}},
 ExpressionUUID -> "82c10cfd-d648-4854-8a7c-a7bbd312d660"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"t1", " ", "=", " ", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"State", " ", "clauses"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StateColoring", "=", 
    RowBox[{
     RowBox[{"StateColoringW", "/.", 
      RowBox[{"{", 
       RowBox[{"Times", "\[Rule]", "And"}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{"Plus", "\[Rule]", "Or"}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Obstruction", " ", "clauses"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ObstructionFunction", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"MapAt", "[", 
         RowBox[{"Not", ",", 
          RowBox[{"(", 
           RowBox[{"Not", "/@", 
            RowBox[{"(", 
             RowBox[{"#", "/.", 
              RowBox[{"{", 
               RowBox[{"Times", "\[Rule]", "And"}], "}"}]}], ")"}]}], ")"}], 
          ",", "i"}], "]"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"Plus", "\[Rule]", "And"}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "PMpaths", "]"}]}], "}"}]}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Obstruction", " ", "=", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{"(", 
      RowBox[{"ObstructionFunction", "/@", "ConstraintsList"}], ")"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Total", " ", "clauses"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Klauses", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Total", "[", "StateColoring", "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"Plus", "\[Rule]", "And"}], "}"}]}], ")"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"Not", "/@", "Obstruction"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"Plus", "\[Rule]", "And"}], "}"}]}], ")"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", " ", "=", " ", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Total number of clauses: \>\"", ",", " ", 
   RowBox[{
    RowBox[{"Length", "[", "StateColoring", "]"}], "+", 
    RowBox[{"Length", "[", 
     RowBox[{"Flatten", "[", "Obstruction", "]"}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Total number of obstructions: \>\"", ",", " ", 
   RowBox[{"Length", "[", 
    RowBox[{"Flatten", "[", "Obstruction", "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeKlauses", "=", 
   RowBox[{"(", 
    RowBox[{"t0", "-", "t1"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\[CapitalDelta]t = \>\"", ",", 
   RowBox[{"TimeKlauses", "/", "60"}], ",", "\"\< min\>\""}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.831059135988624*^9, 3.8310591597807274`*^9}, {
   3.831059233147565*^9, 3.8310592897367573`*^9}, {3.8310593199275208`*^9, 
   3.8310593291814218`*^9}, {3.8310599103223686`*^9, 3.831059910507539*^9}, {
   3.8310625320083647`*^9, 3.831062710431288*^9}, {3.8311302134972353`*^9, 
   3.831130232476247*^9}, {3.831130299832204*^9, 3.8311303423065143`*^9}, {
   3.831130375441205*^9, 3.831130422176016*^9}, 3.831130455074936*^9, {
   3.831130552177726*^9, 3.831130552335964*^9}, {3.8311306016967716`*^9, 
   3.8311306029800935`*^9}, {3.831130980208892*^9, 3.8311309897143707`*^9}, {
   3.8311311913350573`*^9, 3.831131206637516*^9}, {3.8311314229948816`*^9, 
   3.8311314548988285`*^9}, {3.831131510721588*^9, 3.831131521688359*^9}, {
   3.8311317111401815`*^9, 3.8311317433137283`*^9}, {3.831131778284724*^9, 
   3.8311317805856504`*^9}, {3.8311321395009923`*^9, 
   3.8311321413315916`*^9}, {3.8311322022866645`*^9, 3.831132230413149*^9}, {
   3.831132276951795*^9, 3.8311322985607557`*^9}, {3.8311329320172153`*^9, 
   3.8311329505464783`*^9}, {3.8311330212656393`*^9, 3.831133039977806*^9}, {
   3.831148874378708*^9, 3.831148878209306*^9}, {3.831149089368143*^9, 
   3.831149092676135*^9}, {3.8311493952093124`*^9, 3.8311494430904455`*^9}, {
   3.8311494802960835`*^9, 3.8311495480861244`*^9}, {3.831149722425914*^9, 
   3.831149742132253*^9}, {3.8311498410751867`*^9, 3.8311498510079165`*^9}, {
   3.8311501573072133`*^9, 3.8311501592329473`*^9}, {3.8311503067273874`*^9, 
   3.8311503130039344`*^9}, {3.831150790058716*^9, 3.831150797340901*^9}, {
   3.8311510018872957`*^9, 3.8311510235688486`*^9}, {3.831151074585258*^9, 
   3.831151077244302*^9}, {3.831151191431346*^9, 3.831151197375412*^9}, 
   3.831151482559017*^9, {3.8311525974608603`*^9, 3.8311526105052643`*^9}, {
   3.831208703322982*^9, 3.8312087374740057`*^9}, {3.8313061142671967`*^9, 
   3.831306116377751*^9}, {3.831460695618352*^9, 3.8314606997982016`*^9}, {
   3.831486451979162*^9, 3.831486476164006*^9}, {3.8347438860590935`*^9, 
   3.834743886965946*^9}, {3.8347439596050453`*^9, 3.8347440008381777`*^9}, {
   3.834744036559851*^9, 3.834744057483046*^9}, {3.834745242116027*^9, 
   3.8347452546943073`*^9}, {3.8347454493126965`*^9, 
   3.8347454509524117`*^9}, {3.834746209359201*^9, 3.834746257779213*^9}, {
   3.834746466634221*^9, 3.834746537127431*^9}, 3.8348252208253307`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total number of clauses: \"\>", "\[InvisibleSpace]", "3876"}],
  SequenceForm["Total number of clauses: ", 3876],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8311495504181447`*^9, 3.8311498534897757`*^9, 3.8311499934300814`*^9, 
   3.8311501612994757`*^9, 3.8311503141122255`*^9, 3.8311507989657984`*^9, 
   3.831151024670587*^9, 3.8311510864221754`*^9, {3.831151204419138*^9, 
   3.831151210056799*^9}, 3.8311512421038113`*^9, 3.8311514540192814`*^9, 
   3.831151509263491*^9, 3.8311516196486845`*^9, 3.8311526121430326`*^9, 
   3.831153901847838*^9, 3.8311548454119177`*^9, 3.831204942050864*^9, 
   3.8312054195276327`*^9, 3.831205801310563*^9, 3.8312078956184225`*^9, {
   3.8312079838227987`*^9, 3.8312079952321463`*^9}, 3.831208773081914*^9, 
   3.831209641818919*^9, 3.8313061713144627`*^9, 3.831310244912937*^9, 
   3.8313159991045933`*^9, 3.83146224762948*^9, 3.8314628474041104`*^9, 
   3.831463804238323*^9, 3.83146429756949*^9, 3.8314658466657047`*^9, 
   3.83146609551538*^9, 3.831474770137847*^9, 3.8314748370623293`*^9, 
   3.8314749037711754`*^9, 3.8314749650271945`*^9, 3.831475108121333*^9, 
   3.8314759620505915`*^9, 3.8314778634106073`*^9, 3.8314781154797482`*^9, 
   3.83148091996122*^9, 3.831481031130595*^9, 3.831486265409855*^9, 
   3.83148647824447*^9, 3.831494003245455*^9, 3.831575204488969*^9, {
   3.831575362061023*^9, 3.8315753738138514`*^9}, 3.831575429038741*^9, 
   3.831577019311116*^9, 3.8315777433899517`*^9, {3.831579204440149*^9, 
   3.8315792307922077`*^9}, 3.831584265368087*^9, 3.8315846766979394`*^9, 
   3.832011220694343*^9, 3.8320128802522483`*^9, 3.832013639539221*^9, 
   3.832014356768571*^9, 3.8320151403124323`*^9, 3.8320163433220835`*^9, 
   3.8323045326274853`*^9, 3.8323047756653814`*^9, 3.8323049973281064`*^9, 
   3.8347440602098045`*^9, 3.8347453522819147`*^9, 3.8347454513283887`*^9, 
   3.8347465391831055`*^9, 3.8347492442222147`*^9, 3.8347496020137157`*^9, 
   3.8347497764185925`*^9, 3.8347498658185697`*^9, 3.8347499021303205`*^9, {
   3.834826706368025*^9, 3.8348267070155325`*^9}, 3.8348288668080378`*^9, 
   3.8348291483607397`*^9, 3.834829247014326*^9, {3.834829513669337*^9, 
   3.83482952387014*^9}, {3.834829554558249*^9, 3.8348295911495047`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total number of obstructions: \"\>", "\[InvisibleSpace]", 
   "3870"}],
  SequenceForm["Total number of obstructions: ", 3870],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8311495504181447`*^9, 3.8311498534897757`*^9, 3.8311499934300814`*^9, 
   3.8311501612994757`*^9, 3.8311503141122255`*^9, 3.8311507989657984`*^9, 
   3.831151024670587*^9, 3.8311510864221754`*^9, {3.831151204419138*^9, 
   3.831151210056799*^9}, 3.8311512421038113`*^9, 3.8311514540192814`*^9, 
   3.831151509263491*^9, 3.8311516196486845`*^9, 3.8311526121430326`*^9, 
   3.831153901847838*^9, 3.8311548454119177`*^9, 3.831204942050864*^9, 
   3.8312054195276327`*^9, 3.831205801310563*^9, 3.8312078956184225`*^9, {
   3.8312079838227987`*^9, 3.8312079952321463`*^9}, 3.831208773081914*^9, 
   3.831209641818919*^9, 3.8313061713144627`*^9, 3.831310244912937*^9, 
   3.8313159991045933`*^9, 3.83146224762948*^9, 3.8314628474041104`*^9, 
   3.831463804238323*^9, 3.83146429756949*^9, 3.8314658466657047`*^9, 
   3.83146609551538*^9, 3.831474770137847*^9, 3.8314748370623293`*^9, 
   3.8314749037711754`*^9, 3.8314749650271945`*^9, 3.831475108121333*^9, 
   3.8314759620505915`*^9, 3.8314778634106073`*^9, 3.8314781154797482`*^9, 
   3.83148091996122*^9, 3.831481031130595*^9, 3.831486265409855*^9, 
   3.83148647824447*^9, 3.831494003245455*^9, 3.831575204488969*^9, {
   3.831575362061023*^9, 3.8315753738138514`*^9}, 3.831575429038741*^9, 
   3.831577019311116*^9, 3.8315777433899517`*^9, {3.831579204440149*^9, 
   3.8315792307922077`*^9}, 3.831584265368087*^9, 3.8315846766979394`*^9, 
   3.832011220694343*^9, 3.8320128802522483`*^9, 3.832013639539221*^9, 
   3.832014356768571*^9, 3.8320151403124323`*^9, 3.8320163433220835`*^9, 
   3.8323045326274853`*^9, 3.8323047756653814`*^9, 3.8323049973281064`*^9, 
   3.8347440602098045`*^9, 3.8347453522819147`*^9, 3.8347454513283887`*^9, 
   3.8347465391831055`*^9, 3.8347492442222147`*^9, 3.8347496020137157`*^9, 
   3.8347497764185925`*^9, 3.8347498658185697`*^9, 3.8347499021303205`*^9, {
   3.834826706368025*^9, 3.8348267070155325`*^9}, 3.8348288668080378`*^9, 
   3.8348291483607397`*^9, 3.834829247014326*^9, {3.834829513669337*^9, 
   3.83482952387014*^9}, {3.834829554558249*^9, 3.8348295911555047`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[CapitalDelta]t = \"\>", "\[InvisibleSpace]", 
   "0.0022220466666666667`6.5764494194849155", 
   "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "\[CapitalDelta]t = ", 0.0022220466666666667`6.5764494194849155, " min"],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8311495504181447`*^9, 3.8311498534897757`*^9, 3.8311499934300814`*^9, 
   3.8311501612994757`*^9, 3.8311503141122255`*^9, 3.8311507989657984`*^9, 
   3.831151024670587*^9, 3.8311510864221754`*^9, {3.831151204419138*^9, 
   3.831151210056799*^9}, 3.8311512421038113`*^9, 3.8311514540192814`*^9, 
   3.831151509263491*^9, 3.8311516196486845`*^9, 3.8311526121430326`*^9, 
   3.831153901847838*^9, 3.8311548454119177`*^9, 3.831204942050864*^9, 
   3.8312054195276327`*^9, 3.831205801310563*^9, 3.8312078956184225`*^9, {
   3.8312079838227987`*^9, 3.8312079952321463`*^9}, 3.831208773081914*^9, 
   3.831209641818919*^9, 3.8313061713144627`*^9, 3.831310244912937*^9, 
   3.8313159991045933`*^9, 3.83146224762948*^9, 3.8314628474041104`*^9, 
   3.831463804238323*^9, 3.83146429756949*^9, 3.8314658466657047`*^9, 
   3.83146609551538*^9, 3.831474770137847*^9, 3.8314748370623293`*^9, 
   3.8314749037711754`*^9, 3.8314749650271945`*^9, 3.831475108121333*^9, 
   3.8314759620505915`*^9, 3.8314778634106073`*^9, 3.8314781154797482`*^9, 
   3.83148091996122*^9, 3.831481031130595*^9, 3.831486265409855*^9, 
   3.83148647824447*^9, 3.831494003245455*^9, 3.831575204488969*^9, {
   3.831575362061023*^9, 3.8315753738138514`*^9}, 3.831575429038741*^9, 
   3.831577019311116*^9, 3.8315777433899517`*^9, {3.831579204440149*^9, 
   3.8315792307922077`*^9}, 3.831584265368087*^9, 3.8315846766979394`*^9, 
   3.832011220694343*^9, 3.8320128802522483`*^9, 3.832013639539221*^9, 
   3.832014356768571*^9, 3.8320151403124323`*^9, 3.8320163433220835`*^9, 
   3.8323045326274853`*^9, 3.8323047756653814`*^9, 3.8323049973281064`*^9, 
   3.8347440602098045`*^9, 3.8347453522819147`*^9, 3.8347454513283887`*^9, 
   3.8347465391831055`*^9, 3.8347492442222147`*^9, 3.8347496020137157`*^9, 
   3.8347497764185925`*^9, 3.8347498658185697`*^9, 3.8347499021303205`*^9, {
   3.834826706368025*^9, 3.8348267070155325`*^9}, 3.8348288668080378`*^9, 
   3.8348291483607397`*^9, 3.834829247014326*^9, {3.834829513669337*^9, 
   3.83482952387014*^9}, {3.834829554558249*^9, 3.834829591162513*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Compute the weights that generate the state (Theseus loss function)\
\>", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.8286377239247093`*^9, 3.828637733206765*^9}, {
   3.831204898768972*^9, 3.831204923258934*^9}, 3.8314607298970003`*^9, {
   3.834748305151391*^9, 3.8347483203799458`*^9}, {3.834825226027751*^9, 
   3.834825230569711*^9}},
 ExpressionUUID -> "170a78b5-0857-495f-a736-8e69215ad9ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AllPMs", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"ConstraintsListW", ",", "StateColoringW"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fidelity", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"Total", "[", "StateColoringW", "]"}], "]"}], "^", "2"}], 
    RowBox[{
     RowBox[{"Length", "[", "StateColoringW", "]"}], 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"Abs", "[", "AllPMs", "]"}], "^", "2"}], "]"}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TotalLoss", "=", 
   RowBox[{"(", 
    RowBox[{"1", "-", "Fidelity"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8286373098489923`*^9, 3.828637319359046*^9}, {
   3.82863738118167*^9, 3.8286373816161313`*^9}, {3.8286376433758774`*^9, 
   3.8286376447775545`*^9}, {3.8286377130567408`*^9, 3.828637714511885*^9}, {
   3.828698661426916*^9, 3.82869866558639*^9}, {3.830804365581701*^9, 
   3.830804373625125*^9}, 3.8308044801060658`*^9, 3.8308050443302555`*^9, 
   3.8309467893991475`*^9, {3.8309470386315193`*^9, 3.830947085961702*^9}, {
   3.8309472105854864`*^9, 3.8309472142466245`*^9}, {3.8311333001789665`*^9, 
   3.8311333099776373`*^9}, {3.8311334937456512`*^9, 
   3.8311334999386935`*^9}, {3.8314607330874147`*^9, 
   3.8314607565626693`*^9}, {3.8347483281831017`*^9, 3.834748330781062*^9}},
 ExpressionUUID -> "8696a7b3-2525-46ec-922b-87c912bbce2d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Klaus algorithm", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.830802959598922*^9, 3.8308029638814487`*^9}, {
   3.834746871417601*^9, 3.8347468747855406`*^9}, 3.8347472603896985`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BestKlauses", " ", "=", "  ", "Klauses"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReplacementList", "=", 
    RowBox[{"{", "}"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BestCurrentWeights", "=", "AllWeights"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CurrentWeights", "=", "BestCurrentWeights"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AvailableWeights", " ", "=", " ", "CurrentWeights"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "AvailableWeights", "]"}], ">", "0"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Select", " ", "one", " ", "edge", " ", "at", " ", "random", " ", "from",
       " ", "the", " ", "pool", " ", "of", " ", "available", " ", "edges"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"falsetmp", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "AvailableWeights", "]"}]}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"deleteedge", "=", 
      RowBox[{"AvailableWeights", "[", 
       RowBox[{"[", "falsetmp", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "This", " ", "edge", " ", "will", " ", "not", " ", "be", " ", 
        "available", " ", "for", " ", "the", " ", "next", " ", "iteration"}], 
       ",", " ", 
       RowBox[{
       "either", " ", "because", " ", "it", " ", "can", " ", "be", " ", "set",
         " ", "to", " ", "False", " ", "or", " ", "because", " ", "it", " ", 
        "has", " ", "to", " ", "exist", " ", "or", " ", "the", " ", 
        "expression", " ", "will", " ", "not", " ", "be", " ", 
        "satisfiable"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"AvailableWeights", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"AvailableWeights", ",", "deleteedge"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "We", " ", "impose", " ", "that", " ", "edge", " ", "as", " ", "False", 
       " ", "and", " ", "compute", " ", "the", " ", "total", " ", "logical", 
       " ", "expression", " ", "from", " ", "the", " ", "previous", " ", 
       "iteration"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CurrentKlauses", "=", 
      RowBox[{"BestKlauses", "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"deleteedge", "\[Rule]", "False"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "the", " ", "expression", " ", "is", " ", 
       "still", " ", "satisfiable"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"logicVal", "=", 
      RowBox[{"SatisfiableQ", "[", 
       RowBox[{"CurrentKlauses", ",", 
        RowBox[{"BooleanVariables", "[", "CurrentKlauses", "]"}], ",", 
        RowBox[{"Method", "\[Rule]", "\"\<SAT\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"logicVal", "\[Equal]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Remove", " ", "it", " ", 
         RowBox[{"(", 
          RowBox[{
          "append", " ", "it", " ", "to", " ", "the", " ", "ReplacementList", 
           " ", "where", " ", "previous", " ", "removed", " ", "edges", " ", 
           "are"}], " "}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"ReplacementList", ",", "deleteedge"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CurrentWeights", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"AllWeights", ",", "ReplacementList"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"BestReplacementList", "=", "ReplacementList"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"BestCurrentWeights", "=", "CurrentWeights"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"BestKlauses", "=", "CurrentKlauses"}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"if", " ", "logicVal"}], " ", "=", " ", "False"}], ",", " ", 
        RowBox[{
         RowBox[{
         "that", " ", "weight", " ", "is", " ", "necessary", " ", "to", " ", 
          "SAT"}], "=", 
         RowBox[{
          RowBox[{"True", "!"}], " ", "keep", " ", "it"}]}], ",", " ", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", 
          RowBox[{"it", "'"}]}], "s", " ", "not", " ", "available", " ", 
         "for", " ", "removing", " ", 
         RowBox[{"it", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TimeLogicOpt", "=", 
    RowBox[{"t1", "-", "t0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Logic reduction completed.\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EdgesKlaus", "=", 
   RowBox[{"Length", "[", "BestCurrentWeights", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Solution = \>\"", ",", "EdgesKlaus", ",", "\"\</\>\"", ",", 
    RowBox[{"Length", "[", "AllWeights", "]"}], ",", 
    "\"\< weights, \[CapitalDelta]t = \>\"", ",", 
    RowBox[{"TimeLogicOpt", "/", "60"}], ",", " ", "\"\< min\>\""}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Once", " ", "we", " ", "have", " ", "the", " ", "logical", " ", 
     "minimal", " ", "solution"}], ",", " ", 
    RowBox[{
    "we", " ", "minimize", " ", "the", " ", "infidelity", " ", "of", " ", 
     "the", " ", "state", " ", "generated", " ", "by", " ", "the", " ", 
     "remaining", " ", "PM", " ", 
     RowBox[{"w", ".", "r", ".", "t", ".", " ", "the"}], " ", "target", " ", 
     "state", " ", "to", " ", "obtain", " ", "the", " ", "weights"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Deleted", " ", "edges", " ", "will", " ", "be", " ", "set", " ", "with", 
    " ", "0", " ", "weights"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CurrentLoss", "=", 
   RowBox[{"TotalLoss", "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{"BestReplacementList", "\[Rule]", "0"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initvar", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"BestCurrentWeights", ",", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"Length", "[", "BestCurrentWeights", "]"}]}], "]"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sol", "=", 
    RowBox[{"FindMinimum", "[", 
     RowBox[{"CurrentLoss", ",", "initvar", ",", 
      RowBox[{"AccuracyGoal", "\[Rule]", "3"}], ",", 
      RowBox[{"PrecisionGoal", "\[Rule]", "3"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TimeOpt", "=", 
    RowBox[{"t1", "-", "t0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fid", " ", "=", 
   RowBox[{
    RowBox[{"Fidelity", "//.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
    RowBox[{"Thread", "[", 
     RowBox[{"BestReplacementList", "\[Rule]", "0"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Optimization completed. \>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", " ", 
    RowBox[{
    "\"\<Fidelity = \>\"", ",", "fid", ",", " ", 
     "\"\<, \[CapitalDelta]t = \>\"", ",", 
     RowBox[{"TimeOpt", "/", "60"}], ",", " ", "\"\< min\>\""}], "]"}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"fid", "<", "0.9"}], ",", " ", 
     RowBox[{
     "Print", "[", 
      "\"\<Logic failed. A crucial edge was deleted. Try again.\>\"", "]"}], 
     ",", 
     RowBox[{"Print", "[", "\"\<Target state found!\>\"", "]"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Print", " ", "the", " ", "solution"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coef", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"AllColoredPMs", "//.", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
     RowBox[{"Thread", "[", 
      RowBox[{"ReplacementList", "\[Rule]", "0"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonzero", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"AllColoredPMs", "//.", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
       RowBox[{"Thread", "[", 
        RowBox[{"ReplacementList", "\[Rule]", "0"}], "]"}]}], "]"}], "[", 
     "\"\<NonzeroPositions\>\"", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"norm", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"coef", "[", 
       RowBox[{"[", 
        RowBox[{"nonzero", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "^", "2"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "nonzero", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resstate", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"coeftmp", " ", "=", " ", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"coef", "[", 
          RowBox[{"[", 
           RowBox[{"nonzero", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "/", 
         RowBox[{"Sqrt", "[", "norm", "]"}]}], ",", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "3"}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"coeftmp", "\[NotEqual]", "0"}], ",", 
       RowBox[{"resstate", " ", "=", 
        RowBox[{
         RowBox[{"resstate", "+", 
          RowBox[{"coeftmp", 
           RowBox[{"(", 
            RowBox[{"AllColoredPMs", "[", 
             RowBox[{"[", 
              RowBox[{"nonzero", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ")"}]}]}], "//.", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"cc1_", ",", "cc2_", ",", "a_", ",", "b_"}], "]"}], 
          "\[Rule]", 
          RowBox[{
           RowBox[{"a", "[", "cc1", "]"}], "*", 
           RowBox[{"b", "[", "cc2", "]"}]}]}]}]}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "nonzero", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Target state =\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "state", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Obtained state = \>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Chop", "[", "resstate", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Graph weights:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"sol", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Total time Klaus = \>\"", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"TimeLogicOpt", "+", "TimeOpt"}], ")"}], "/", "60"}], ",", 
   "\"\< min\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Total time(problem generation + Klaus) = \>\"", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
     "TimePM", "+", "TimeKlauses", "+", "TimeLogicOpt", "+", "TimeOpt"}], 
     ")"}], "/", "60"}], ",", "\"\< min\>\""}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8308034883771353`*^9, 3.830803640037247*^9}, {
   3.830803700314139*^9, 3.8308038542768235`*^9}, {3.830803916736555*^9, 
   3.8308039963028917`*^9}, {3.830804042303156*^9, 3.830804045838134*^9}, {
   3.8308040867200756`*^9, 3.8308041613702717`*^9}, {3.83080420043372*^9, 
   3.8308042680112267`*^9}, 3.8308044155050507`*^9, {3.8308045524433775`*^9, 
   3.8308046814520235`*^9}, {3.83080472345652*^9, 3.8308048057563353`*^9}, {
   3.8308048834954576`*^9, 3.8308049172208004`*^9}, {3.8308050023701735`*^9, 
   3.830805023515823*^9}, {3.8308070093992047`*^9, 3.8308070538202057`*^9}, {
   3.830946669914465*^9, 3.8309466715198975`*^9}, {3.8309467178627634`*^9, 
   3.830946769477664*^9}, {3.830946853107229*^9, 3.8309468561630015`*^9}, {
   3.83094700544755*^9, 3.830947008516204*^9}, {3.8309472995341387`*^9, 
   3.830947301168871*^9}, {3.8309473920348067`*^9, 3.8309476353277807`*^9}, {
   3.830947830910516*^9, 3.8309478316838093`*^9}, {3.8309486273887925`*^9, 
   3.830948638922086*^9}, {3.8309489417642803`*^9, 3.8309489879668694`*^9}, {
   3.8309510516165276`*^9, 3.8309510804751215`*^9}, {3.8309511263737392`*^9, 
   3.830951229385968*^9}, 3.831133086828349*^9, 3.831133163961599*^9, 
   3.831133514845869*^9, 3.831151265301836*^9, {3.8311513371676226`*^9, 
   3.831151356063946*^9}, {3.831151712100889*^9, 3.8311517491331306`*^9}, {
   3.831151833537751*^9, 3.831151862308417*^9}, {3.831151931886153*^9, 
   3.8311519320281906`*^9}, {3.8311521954776044`*^9, 
   3.8311522340132265`*^9}, {3.831152273936866*^9, 3.8311522910491047`*^9}, {
   3.831152621631105*^9, 3.8311526234752636`*^9}, {3.8311527929830575`*^9, 
   3.8311528459181623`*^9}, {3.8311528767656827`*^9, 3.831152891127142*^9}, {
   3.83115486402612*^9, 3.8311548778991294`*^9}, {3.8312079232165756`*^9, 
   3.831207923758317*^9}, {3.831306166342755*^9, 3.8313061916527886`*^9}, {
   3.831306223507221*^9, 3.8313062323084326`*^9}, {3.8313062658434067`*^9, 
   3.8313063182537236`*^9}, {3.831306460604813*^9, 3.8313065752894745`*^9}, {
   3.831306674267243*^9, 3.831306785802181*^9}, {3.8313068222816467`*^9, 
   3.8313069292752457`*^9}, {3.8313102696005754`*^9, 
   3.8313104295424957`*^9}, {3.8313104788237314`*^9, 
   3.8313105980251036`*^9}, {3.831310649772814*^9, 3.8313106558233356`*^9}, {
   3.8313107098963394`*^9, 3.831310768224683*^9}, {3.8347468776694264`*^9, 
   3.8347468991323056`*^9}, {3.8347484174705424`*^9, 
   3.8347487306227493`*^9}, {3.834748770805995*^9, 3.8347488580753202`*^9}, {
   3.834748888265519*^9, 3.834749217634731*^9}, {3.834749265698225*^9, 
   3.834749289745623*^9}, {3.834749323702216*^9, 3.834749496978363*^9}, {
   3.834749534634535*^9, 3.834749562804103*^9}, {3.8347496680786676`*^9, 
   3.834749704310213*^9}, {3.8347497908910794`*^9, 3.8347497994005427`*^9}, {
   3.8348269982863255`*^9, 3.834827006120496*^9}, {3.834829018950118*^9, 
   3.83482902934453*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Logic reduction completed.\"\>"], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024050865`*^9}, 
   3.834826706520985*^9, 3.834827006857625*^9, 3.834828866958025*^9, 
   3.834829152612014*^9, 3.8348292518850403`*^9, 3.8348295281221437`*^9, {
   3.8348295592038097`*^9, 3.834829595316399*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Solution = \"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"/\"\>", "\[InvisibleSpace]", "216", 
   "\[InvisibleSpace]", "\<\" weights, \[CapitalDelta]t = \"\>", 
   "\[InvisibleSpace]", "0.0681331633333333333`8.0630547970098", 
   "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "Solution = ", 9, "/", 216, " weights, \[CapitalDelta]t = ", 
   0.0681331633333333333`8.0630547970098, " min"],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024050865`*^9}, 
   3.834826706520985*^9, 3.834827006857625*^9, 3.834828866958025*^9, 
   3.834829152612014*^9, 3.8348292518850403`*^9, 3.8348295281221437`*^9, {
   3.8348295592038097`*^9, 3.834829595323391*^9}}],

Cell[BoxData["\<\"Optimization completed. \"\>"], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024050865`*^9}, 
   3.834826706520985*^9, 3.834827006857625*^9, 3.834828866958025*^9, 
   3.834829152612014*^9, 3.8348292518850403`*^9, 3.8348295281221437`*^9, {
   3.8348295592038097`*^9, 3.8348295958193893`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fidelity = \"\>", "\[InvisibleSpace]", "0.9999999858979685`", 
   "\[InvisibleSpace]", "\<\", \[CapitalDelta]t = \"\>", "\[InvisibleSpace]", 
   "0.00428322`6.8614666256150185", "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "Fidelity = ", 0.9999999858979685, ", \[CapitalDelta]t = ", 
   0.00428322`6.8614666256150185, " min"],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024050865`*^9}, 
   3.834826706520985*^9, 3.834827006857625*^9, 3.834828866958025*^9, 
   3.834829152612014*^9, 3.8348292518850403`*^9, 3.8348295281221437`*^9, {
   3.8348295592038097`*^9, 3.834829595826388*^9}}],

Cell[BoxData["\<\"Target state found!\"\>"], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024050865`*^9}, 
   3.834826706520985*^9, 3.834827006857625*^9, 3.834828866958025*^9, 
   3.834829152612014*^9, 3.8348292518850403`*^9, 3.8348295281221437`*^9, {
   3.8348295592038097`*^9, 3.834829595832387*^9}}],

Cell[BoxData["\<\"Target state =\"\>"], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024050865`*^9}, 
   3.834826706520985*^9, 3.834827006857625*^9, 3.834828866958025*^9, 
   3.834829152612014*^9, 3.8348292518850403`*^9, 3.8348295281221437`*^9, {
   3.8348295592038097`*^9, 3.8348295962193866`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1", ",", "3", ",", "0"}], "}"}]}], "}"}]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024050865`*^9}, 
   3.834826706520985*^9, 3.834827006857625*^9, 3.834828866958025*^9, 
   3.834829152612014*^9, 3.8348292518850403`*^9, 3.8348295281221437`*^9, {
   3.8348295592038097`*^9, 3.8348295962293863`*^9}}],

Cell[BoxData["\<\"Obtained state = \"\>"], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024050865`*^9}, 
   3.834826706520985*^9, 3.834827006857625*^9, 3.834828866958025*^9, 
   3.834829152612014*^9, 3.8348292518850403`*^9, 3.8348295281221437`*^9, {
   3.8348295592038097`*^9, 3.8348295962343874`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "0.40827850892059553`"}], " ", 
   RowBox[{"\<\"a\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "-", 
  RowBox[{"0.40827971361060295`", " ", 
   RowBox[{"\<\"a\"\>", "[", "3", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "3", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "-", 
  RowBox[{"0.4082534779681856`", " ", 
   RowBox[{"\<\"a\"\>", "[", "4", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "4", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "-", 
  RowBox[{"0.408266354677238`", " ", 
   RowBox[{"\<\"a\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "-", 
  RowBox[{"0.40827003536808587`", " ", 
   RowBox[{"\<\"a\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "-", 
  RowBox[{"0.4081416349670803`", " ", 
   RowBox[{"\<\"a\"\>", "[", "5", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "3", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}]}]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024050865`*^9}, 
   3.834826706520985*^9, 3.834827006857625*^9, 3.834828866958025*^9, 
   3.834829152612014*^9, 3.8348292518850403`*^9, 3.8348295281221437`*^9, {
   3.8348295592038097`*^9, 3.8348295962483883`*^9}}],

Cell[BoxData["\<\"Graph weights:\"\>"], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024050865`*^9}, 
   3.834826706520985*^9, 3.834827006857625*^9, 3.834828866958025*^9, 
   3.834829152612014*^9, 3.8348292518850403`*^9, 3.8348295281221437`*^9, {
   3.8348295592038097`*^9, 3.83482959625439*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "0", ",", "\<\"a\"\>", ",", "\<\"b\"\>"}], "]"}], 
    "\[Rule]", "2.0049464243461417`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "0", ",", "\<\"c\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "8.0284748615258`"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "0", ",", "\<\"b\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", "3.92352722292938`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "1", ",", "\<\"a\"\>", ",", "\<\"c\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "4.102477659150616`"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"2", ",", "0", ",", "\<\"a\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "4.870125171622071`"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"2", ",", "2", ",", "\<\"b\"\>", ",", "\<\"c\"\>"}], "]"}], 
    "\[Rule]", "3.3051158489120778`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"3", ",", "3", ",", "\<\"a\"\>", ",", "\<\"b\"\>"}], "]"}], 
    "\[Rule]", "2.004952340256164`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"4", ",", "4", ",", "\<\"a\"\>", ",", "\<\"b\"\>"}], "]"}], 
    "\[Rule]", "2.0048235040418994`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"5", ",", "3", ",", "\<\"a\"\>", ",", "\<\"c\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "4.101224409112459`"}]}]}], "}"}]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024050865`*^9}, 
   3.834826706520985*^9, 3.834827006857625*^9, 3.834828866958025*^9, 
   3.834829152612014*^9, 3.8348292518850403`*^9, 3.8348295281221437`*^9, {
   3.8348295592038097`*^9, 3.8348295962683873`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time Klaus = \"\>", "\[InvisibleSpace]", 
   "0.0724163833333333333`7.788503079417447", 
   "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "Total time Klaus = ", 0.0724163833333333333`7.788503079417447, " min"],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024050865`*^9}, 
   3.834826706520985*^9, 3.834827006857625*^9, 3.834828866958025*^9, 
   3.834829152612014*^9, 3.8348292518850403`*^9, 3.8348295281221437`*^9, {
   3.8348295592038097`*^9, 3.834829596276388*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time(problem generation + Klaus) = \"\>", 
   "\[InvisibleSpace]", "0.0809743633333333333`7.439073781568111", 
   "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "Total time(problem generation + Klaus) = ", 
   0.0809743633333333333`7.439073781568111, " min"],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8313104983556857`*^9, 3.8313105650176716`*^9, 3.8313106000589523`*^9, {
   3.831310657484271*^9, 3.8313106819677787`*^9}, 3.8313107252907157`*^9, 
   3.8313107715710073`*^9, 3.8347492197917967`*^9, {3.8347492559856634`*^9, 
   3.8347492905855937`*^9}, {3.834749543200189*^9, 3.8347495675045266`*^9}, 
   3.834749603683045*^9, 3.834749707810229*^9, {3.83474977815231*^9, 
   3.8347498021165657`*^9}, {3.834749881978837*^9, 3.8347499024050865`*^9}, 
   3.834826706520985*^9, 3.834827006857625*^9, 3.834828866958025*^9, 
   3.834829152612014*^9, 3.8348292518850403`*^9, 3.8348295281221437`*^9, {
   3.8348295592038097`*^9, 3.834829596283386*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Theseus algorithm", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.8348252629294634`*^9, 3.8348252741725206`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"t0", "=", " ", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"{", 
    RowBox[{"666", ",", "666"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ">", "0.001"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"initvar", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"AllWeights", ",", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"Length", "[", "AllWeights", "]"}]}], "]"}]}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"FindMinimum", "[", 
       RowBox[{"TotalLoss", ",", "initvar", ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "3"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "3"}]}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Time1Min", "=", 
    RowBox[{"t1", "-", "t0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AllWeightValues", "=", 
    RowBox[{"AllWeights", "/.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestSol", "=", "sol"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestReplacementList", "=", 
    RowBox[{"{", "}"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BestCurrentWeights", "=", "AllWeights"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestFullVar", "=", "AllWeightValues"}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Set", " ", "the", " ", "precision", " ", "to", " ", "delete", " ", "the", 
    " ", "weights", " ", "to", " ", "0.1"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"presinitial", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"presIndex", "=", "presinitial"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"precision", "=", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "presIndex"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"presIndex", "<", "8"}], "&&", 
     RowBox[{"presIndex", "\[GreaterEqual]", "presinitial"}]}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"repeat", " ", "until", " ", "precision", " ", "reaches", " ", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "8"}], ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ReplacementList", "=", "BestReplacementList"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sol", "=", "BestSol"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Normalize", " ", "the", " ", "weights"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"CurrentWeightsNorm", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"BestCurrentWeights", "//.", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
        RowBox[{"Thread", "[", 
         RowBox[{"ReplacementList", "\[Rule]", "0"}], "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"norm", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"CurrentWeightsNorm", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "^", "2"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "CurrentWeightsNorm", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Round", " ", "the", " ", "weights", " ", "to", " ", "the", " ", 
       "desired", " ", "precision"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CurrentWeightsNorm", " ", "=", " ", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"CurrentWeightsNorm", "/", 
         RowBox[{"Sqrt", "[", "norm", "]"}]}], ",", "precision"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Delete", " ", "all", " ", "weights"}], " ", "=", " ", "0"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"delete", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"CurrentWeightsNorm", ",", "0"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"LengthDelete", "=", 
      RowBox[{"Length", "[", "delete", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"LengthDelete", ">", "0"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Remove", " ", "all", " ", "weights"}], " ", "=", " ", "0"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"ReplacementList", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"BestCurrentWeights", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "[", "delete", "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ReplacementList", "=", 
         RowBox[{"Flatten", "[", "ReplacementList", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Prepare", " ", "to", " ", "minimize", " ", "the", " ", "Loss", " ", 
          "function", " ", "again"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"Abs", "[", "AllPMs", "]"}], "^", "2"}], "]"}], "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{"ReplacementList", "\[Rule]", "0"}], "]"}]}], ")"}], "==",
            "0"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"To", " ", "prevent", " ", 
          RowBox[{"1", "/", "0"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Remaining", " ", "weights", " ", "after", " ", "the", " ", 
          "removal"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"CurrentWeights", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"AllWeights", ",", "ReplacementList"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"New", " ", "Loss", " ", "Function"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"CurrentLoss", "=", 
         RowBox[{"TotalLoss", "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{"ReplacementList", "\[Rule]", "0"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Minimization", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fullvars", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"CurrentWeights", ",", 
            RowBox[{"RandomReal", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"Length", "[", "CurrentWeights", "]"}]}], "]"}]}], 
           "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sol", "=", 
         RowBox[{"FindMinimum", "[", 
          RowBox[{"CurrentLoss", ",", "fullvars", ",", 
           RowBox[{"AccuracyGoal", "\[Rule]", "3"}], ",", 
           RowBox[{"PrecisionGoal", "\[Rule]", "3"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sol", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<", "0.001"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "Keep", " ", "the", " ", "solution", " ", "and", " ", "remove", 
             " ", "the", " ", "weights"}], " ", "<", " ", "precision"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"BestReplacementList", "=", "ReplacementList"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"BestSol", "=", "sol"}], ";", "\[IndentingNewLine]", 
           RowBox[{"BestCurrentWeights", "=", "CurrentWeights"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"presIndex", "=", "presinitial"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"precision", "=", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "presIndex"}], ")"}]}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "Increase", " ", "the", " ", "precision", " ", "and", " ", "this",
              " ", "time", " ", "remove", " ", "the", " ", "weights"}], " ", 
            "<", " ", 
            RowBox[{"new", "-", "precision"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"presIndex", "=", 
            RowBox[{"presIndex", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"precision", "=", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "presIndex"}], ")"}]}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "we", " ", 
          RowBox[{"haven", "'"}], "t", " ", "removed", " ", "any", " ", 
          "weight"}], ",", " ", 
         RowBox[{
         "decrease", " ", "the", " ", "precision", " ", "and", " ", "try", 
          " ", "again"}]}], " ", "*)"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"presIndex", "=", 
         RowBox[{"presIndex", "-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"precision", "=", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "presIndex"}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TimeTheseus", "=", 
    RowBox[{"t1", "-", "t0"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Save", " ", "results", " ", "Theseus"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BCWTheseusPro", " ", "=", " ", "BestCurrentWeights"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BRLTheseusPro", " ", "=", " ", "BestReplacementList"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EdgesDeleted", "=", 
   RowBox[{"Length", "[", "BestCurrentWeights", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fid", " ", "=", 
   RowBox[{
    RowBox[{"Fidelity", "//.", 
     RowBox[{"BestSol", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
    RowBox[{"Thread", "[", 
     RowBox[{"BestReplacementList", "\[Rule]", "0"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", " ", 
  RowBox[{
  "\"\<Fidelity = \>\"", ",", "fid", ",", " ", "\"\<, \>\"", ",", 
   "EdgesDeleted", ",", "\"\</\>\"", ",", 
   RowBox[{"Length", "[", "AllWeights", "]"}], ",", "\"\< weights\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"fid", ">", "0.99"}], ",", 
     RowBox[{"Print", "[", "\"\<Target state found!\>\"", "]"}], ",", " ", 
     RowBox[{"Print", "[", "\"\<Target state don't found :-(\>\"", "]"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Print", " ", "the", " ", "solution"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coef", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"AllColoredPMs", "//.", 
      RowBox[{"BestSol", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
     RowBox[{"Thread", "[", 
      RowBox[{"BestReplacementList", "\[Rule]", "0"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonzero", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"AllColoredPMs", "//.", 
        RowBox[{"BestSol", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
       RowBox[{"Thread", "[", 
        RowBox[{"BestReplacementList", "\[Rule]", "0"}], "]"}]}], "]"}], "[", 
     "\"\<NonzeroPositions\>\"", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"norm", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"coef", "[", 
       RowBox[{"[", 
        RowBox[{"nonzero", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "^", "2"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "nonzero", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resstate", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"coeftmp", " ", "=", " ", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"coef", "[", 
          RowBox[{"[", 
           RowBox[{"nonzero", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "/", 
         RowBox[{"Sqrt", "[", "norm", "]"}]}], ",", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "3"}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"coeftmp", "\[NotEqual]", "0"}], ",", 
       RowBox[{"resstate", " ", "=", 
        RowBox[{
         RowBox[{"resstate", "+", 
          RowBox[{"coeftmp", 
           RowBox[{"(", 
            RowBox[{"AllColoredPMs", "[", 
             RowBox[{"[", 
              RowBox[{"nonzero", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ")"}]}]}], "//.", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"cc1_", ",", "cc2_", ",", "a_", ",", "b_"}], "]"}], 
          "\[Rule]", 
          RowBox[{
           RowBox[{"a", "[", "cc1", "]"}], "*", 
           RowBox[{"b", "[", "cc2", "]"}]}]}]}]}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "nonzero", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Target state =\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "state", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Obtained state = \>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Chop", "[", "resstate", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Graph weights:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Chop", "[", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Total time Theseus = \>\"", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Time1Min", "+", "TimeTheseus"}], ")"}], "/", "60"}], ",", " ", 
    "\"\< min (\>\"", ",", " ", 
    RowBox[{"Time1Min", "/", "60"}], ",", "\"\< min 1st minimization)\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Total time (problem generation + Theseus) = \>\"", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"TimePM", "+", "Time1Min", "+", "TimeTheseus"}], ")"}], "/", 
     "60"}]}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8309478644570446`*^9, 3.8309480310073285`*^9}, {
   3.8309480633969994`*^9, 3.830948130639885*^9}, {3.830948178890829*^9, 
   3.83094823895417*^9}, {3.8309483017579603`*^9, 3.8309483182692137`*^9}, {
   3.8309484398202567`*^9, 3.8309484633871713`*^9}, 3.830948675333593*^9, {
   3.8309490903161554`*^9, 3.830949152932618*^9}, {3.830950506464693*^9, 
   3.8309505378048954`*^9}, {3.8309508774554725`*^9, 3.830950896612367*^9}, {
   3.830951258559014*^9, 3.8309513026709476`*^9}, {3.8309513471761775`*^9, 
   3.830951347686555*^9}, 3.8309514148336086`*^9, {3.8309514474806376`*^9, 
   3.830951502564475*^9}, {3.8311518860410824`*^9, 3.831151892419629*^9}, 
   3.8311526558759437`*^9, {3.83115293599135*^9, 3.831152987407381*^9}, {
   3.831203107802867*^9, 3.83120333704239*^9}, {3.831203607001011*^9, 
   3.831203705267688*^9}, {3.8312037797797155`*^9, 3.8312038130322247`*^9}, {
   3.831204330963352*^9, 3.8312044703841734`*^9}, {3.8312047595635433`*^9, 
   3.831204771159259*^9}, {3.8312050460165224`*^9, 3.8312050796302247`*^9}, 
   3.831205954753884*^9, {3.8312059913117123`*^9, 3.831206018071303*^9}, {
   3.8312060578307743`*^9, 3.8312060878747206`*^9}, {3.8312061904153337`*^9, 
   3.831206240772571*^9}, {3.8312062762417865`*^9, 3.831206276418541*^9}, {
   3.8312063072103353`*^9, 3.8312063516018724`*^9}, {3.8312064133232775`*^9, 
   3.831206433109419*^9}, {3.831206502773299*^9, 3.8312065073168344`*^9}, 
   3.8312065772489834`*^9, {3.8312066567726793`*^9, 3.831206695572908*^9}, {
   3.8312067518153296`*^9, 3.8312067617150416`*^9}, {3.83120679727411*^9, 
   3.831206834882843*^9}, {3.831206865612053*^9, 3.831206866242468*^9}, {
   3.8312069039700737`*^9, 3.831206934794944*^9}, {3.831207003001876*^9, 
   3.831207013432584*^9}, {3.831207074209902*^9, 3.831207105386342*^9}, {
   3.831207136587242*^9, 3.8312071895537577`*^9}, {3.83120830955324*^9, 
   3.8312083298894396`*^9}, {3.8312085522315173`*^9, 3.831208572744294*^9}, {
   3.8312086099829545`*^9, 3.831208640791545*^9}, {3.83120973720391*^9, 
   3.8312097519115033`*^9}, {3.831310847326622*^9, 3.831310897804577*^9}, {
   3.8313109576293807`*^9, 3.8313109984787097`*^9}, {3.831311235980232*^9, 
   3.8313112457682734`*^9}, {3.831311301968511*^9, 3.831311303422453*^9}, 
   3.8313113659069567`*^9, {3.8313114053031993`*^9, 3.831311504046356*^9}, {
   3.8313115410147963`*^9, 3.8313117065422363`*^9}, {3.831311741167303*^9, 
   3.8313117941584616`*^9}, {3.8313119404828854`*^9, 
   3.8313119743588266`*^9}, {3.8313121463600082`*^9, 3.831312250520357*^9}, {
   3.831312282431999*^9, 3.8313122904884787`*^9}, {3.831312320686658*^9, 
   3.831312392053521*^9}, {3.8313124248552723`*^9, 3.8313125233667345`*^9}, {
   3.831312758316329*^9, 3.8313127705081325`*^9}, {3.8313158563934097`*^9, 
   3.8313159149490957`*^9}, {3.8313159617289634`*^9, 3.831315974382061*^9}, {
   3.8313160378504686`*^9, 3.8313160812041826`*^9}, {3.831316147871075*^9, 
   3.8313161951563683`*^9}, {3.8313162506892195`*^9, 
   3.8313163523861995`*^9}, {3.831316415794927*^9, 3.831316452033534*^9}, {
   3.8313165663030815`*^9, 3.8313166045151787`*^9}, {3.8313166529768925`*^9, 
   3.8313166780242443`*^9}, {3.831316753285367*^9, 3.8313167669618635`*^9}, {
   3.8313168776081495`*^9, 3.831316908600581*^9}, {3.8313169481745024`*^9, 
   3.8313169838675404`*^9}, {3.831317052950453*^9, 3.8313170605511265`*^9}, {
   3.831317096836656*^9, 3.831317125079355*^9}, {3.8313171713246994`*^9, 
   3.831317309386969*^9}, {3.831317409396702*^9, 3.831317471799264*^9}, {
   3.831317554754881*^9, 3.8313175598419123`*^9}, {3.8314610196103644`*^9, 
   3.8314612070332947`*^9}, {3.831461243194666*^9, 3.831461396936679*^9}, {
   3.8314630711651163`*^9, 3.831463073368627*^9}, {3.8314632934026756`*^9, 
   3.8314633348709536`*^9}, 3.8314633679211407`*^9, {3.8314634006334257`*^9, 
   3.8314634220054245`*^9}, {3.831464101578203*^9, 3.8314641120137663`*^9}, 
   3.831464503974387*^9, {3.832011094931587*^9, 3.83201118250236*^9}, {
   3.8320112311274195`*^9, 3.832011231397633*^9}, {3.832011749092416*^9, 
   3.8320118030214024`*^9}, {3.8320120096223116`*^9, 3.832012374277231*^9}, {
   3.8320124087304535`*^9, 3.8320128641553745`*^9}, {3.8320129184152966`*^9, 
   3.83201306736129*^9}, {3.832013415296479*^9, 3.8320134164755836`*^9}, {
   3.8348254351835732`*^9, 3.834825799280345*^9}, {3.8348260260603724`*^9, 
   3.834826203516141*^9}, {3.8348262406237497`*^9, 3.8348262653324833`*^9}, {
   3.8348263105336237`*^9, 3.8348266325636806`*^9}, {3.8348266780757985`*^9, 
   3.834826693545583*^9}, {3.8348267297924213`*^9, 3.834826889153105*^9}, {
   3.8348269202891364`*^9, 3.8348269576151233`*^9}, {3.8348270178706007`*^9, 
   3.834827084021693*^9}, {3.83482712213068*^9, 3.8348271501029263`*^9}, {
   3.8348279156261687`*^9, 3.8348279261622143`*^9}, 3.834828013782766*^9, {
   3.8348282422844*^9, 3.8348282476143312`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "FindMinimum","cvmit",
   "\"Failed to converge to the requested accuracy or precision within \\!\\(\
\\*RowBox[{\\\"100\\\"}]\\) iterations.\"",2,283,2,17870585089476735305,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.834828867189026*^9, 3.8348291560150146`*^9, 3.834829322228923*^9, 
   3.8348295316401434`*^9, {3.8348295628917923`*^9, 3.834829598473709*^9}}],

Cell[BoxData[
 TemplateBox[{
  "FindMinimum","fmgz",
   "\"Encountered a gradient that is effectively zero. The result returned \
may not be a minimum; it may be a maximum or a saddle point.\"",2,295,3,
   17870585089476735305,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.834828867189026*^9, 3.8348291560150146`*^9, 3.834829322228923*^9, 
   3.8348295316401434`*^9, {3.8348295628917923`*^9, 3.834829599804629*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fidelity = \"\>", "\[InvisibleSpace]", "0.9999999967659288`", 
   "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"/\"\>", "\[InvisibleSpace]", "216", 
   "\[InvisibleSpace]", "\<\" weights\"\>"}],
  SequenceForm[
  "Fidelity = ", 0.9999999967659288, ", ", 9, "/", 216, " weights"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.83482958138264*^9, 3.834829601228629*^9}}],

Cell[BoxData["\<\"Target state found!\"\>"], "Print",
 CellChangeTimes->{{3.83482958138264*^9, 3.834829601232627*^9}}],

Cell[BoxData["\<\"Target state =\"\>"], "Print",
 CellChangeTimes->{{3.83482958138264*^9, 3.8348296016226287`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1", ",", "3", ",", "0"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.83482958138264*^9, 3.8348296016316257`*^9}}],

Cell[BoxData["\<\"Obtained state = \"\>"], "Print",
 CellChangeTimes->{{3.83482958138264*^9, 3.834829601638647*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.40826586430738177`", " ", 
   RowBox[{"\<\"a\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.4081995887378048`", " ", 
   RowBox[{"\<\"a\"\>", "[", "3", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "3", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.408270737633454`", " ", 
   RowBox[{"\<\"a\"\>", "[", "4", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "4", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.40825037149492893`", " ", 
   RowBox[{"\<\"a\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.40824816668908903`", " ", 
   RowBox[{"\<\"a\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.40825500995960734`", " ", 
   RowBox[{"\<\"a\"\>", "[", "5", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "3", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}]}]], "Print",
 CellChangeTimes->{{3.83482958138264*^9, 3.834829601650626*^9}}],

Cell[BoxData["\<\"Graph weights:\"\>"], "Print",
 CellChangeTimes->{{3.83482958138264*^9, 3.834829601657626*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "0", ",", "\<\"a\"\>", ",", "\<\"b\"\>"}], "]"}], 
    "\[Rule]", "3.5857393681509855`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "0", ",", "\<\"c\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", "2.1304325843453933`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "0", ",", "\<\"b\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", "5.365344312474534`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "1", ",", "\<\"a\"\>", ",", "\<\"c\"\>"}], "]"}], 
    "\[Rule]", "1.4237457381441851`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"2", ",", "0", ",", "\<\"a\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "2.7893920968761012`"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"2", ",", "2", ",", "\<\"b\"\>", ",", "\<\"c\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "2.7385339093712124`"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"3", ",", "3", ",", "\<\"a\"\>", ",", "\<\"b\"\>"}], "]"}], 
    "\[Rule]", "3.5851572795176834`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"4", ",", "4", ",", "\<\"a\"\>", ",", "\<\"b\"\>"}], "]"}], 
    "\[Rule]", "3.585782169861045`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"5", ",", "3", ",", "\<\"a\"\>", ",", "\<\"c\"\>"}], "]"}], 
    "\[Rule]", "1.4237619144780689`"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.83482958138264*^9, 3.8348296016706266`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time Theseus = \"\>", "\[InvisibleSpace]", 
   "0.076898655`7.814584992032845", "\[InvisibleSpace]", "\<\" min (\"\>", 
   "\[InvisibleSpace]", "0.035133385`7.775416238704368", 
   "\[InvisibleSpace]", "\<\" min 1st minimization)\"\>"}],
  SequenceForm[
  "Total time Theseus = ", 0.076898655`7.814584992032845, " min (", 
   0.035133385`7.775416238704368, " min 1st minimization)"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.83482958138264*^9, 3.834829601677643*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time (problem generation + Theseus) = \"\>", 
   "\[InvisibleSpace]", "0.0832345883333333334`7.5479400884668655"}],
  SequenceForm[
  "Total time (problem generation + Theseus) = ", 
   0.0832345883333333334`7.5479400884668655],
  Editable->False]], "Print",
 CellChangeTimes->{{3.83482958138264*^9, 3.8348296016846256`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Theseus minimal solution", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.834827213889515*^9, 3.8348272212015495`*^9}}],

Cell["\<\
How can we be sure that Theseus solution is minimal and not a local minima? 
One way is to try to remove each of the remaining edges to see if we still \
obtain the target state (original Theseus strategy).\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.834827226701226*^9, 3.8348272926347694`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Reload", " ", "Theseus", " ", "solution"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BestCurrentWeights", "=", "BCWTheseusPro"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestReplacementList", "=", "BRLTheseusPro"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t0", "=", 
     RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AllWeightValues", "=", "BestCurrentWeights"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ccNumOfCurrentRuns", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{"ccNumOfCurrentRuns", "<", 
       RowBox[{"Length", "[", "AllWeightValues", "]"}]}], ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Try", " ", "until", " ", "we", " ", "have", " ", "tried", " ", "to", 
        " ", "remove", " ", "all", " ", "edges"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReplacementList", "=", "BestReplacementList"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CurrentWeights", "=", "BestCurrentWeights"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sol", "=", "BestSol"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AllWeightValues", "=", 
        RowBox[{"CurrentWeights", "/.", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "delete", " ", "the", " ", "\"\<ccNumOfCurrentRuns\>\"", " ", 
         "smallest", " ", "edge"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"IdxSmallestWeight", "=", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Abs", "[", "AllWeightValues", "]"}], ",", 
            RowBox[{"RankedMin", "[", 
             RowBox[{
              RowBox[{"Abs", "[", "AllWeightValues", "]"}], ",", 
              "ccNumOfCurrentRuns"}], "]"}]}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"ReplacementList", ",", 
         RowBox[{"CurrentWeights", "[", 
          RowBox[{"[", "IdxSmallestWeight", "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"CurrentWeights", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"AllWeights", ",", "ReplacementList"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"Abs", "[", "AllPMs", "]"}], "^", "2"}], "]"}], "/.", 
            RowBox[{"Thread", "[", 
             RowBox[{"ReplacementList", "\[Rule]", "0"}], "]"}]}], ")"}], "==",
           "0"}], ",", " ", 
         RowBox[{
          RowBox[{"ccNumOfCurrentRuns", "=", 
           RowBox[{"ccNumOfCurrentRuns", "+", "1"}]}], ";", 
          RowBox[{"Goto", "[", "\"\<skip\>\"", "]"}]}]}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"To", " ", "prevent", " ", 
         RowBox[{"1", "/", "0"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Minimization", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"CurrentLoss", "=", 
        RowBox[{"TotalLoss", "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"ReplacementList", "\[Rule]", "0"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fullvars", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"CurrentWeights", ",", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"Length", "[", "CurrentWeights", "]"}]}], "]"}]}], "}"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sol", "=", 
        RowBox[{"FindMinimum", "[", 
         RowBox[{"CurrentLoss", ",", "fullvars", ",", 
          RowBox[{"AccuracyGoal", "\[Rule]", "3"}], ",", 
          RowBox[{"PrecisionGoal", "\[Rule]", "3"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sol", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<", "0.001"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Remove", " ", "that", " ", "edge", " ", "and", " ", "try", " ", 
           "to", " ", "remove", " ", "the", " ", "next", " ", "one"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"BestReplacementList", "=", "ReplacementList"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"BestSol", "=", "sol"}], ";", "\[IndentingNewLine]", 
          RowBox[{"BestCurrentWeights", "=", "CurrentWeights"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AllWeightValues", "=", "BestCurrentWeights"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ccNumOfCurrentRuns", "=", "1"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ccNumOfCurrentRuns", "=", 
           RowBox[{"ccNumOfCurrentRuns", "+", "1"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<skip\>\"", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t1", "=", 
     RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TimeTheseusMin", "=", 
     RowBox[{"t1", "-", "t0"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Once", " ", "we", " ", "have", " ", "tried", " ", "all", " ", "edges"}],
      ",", " ", 
     RowBox[{"we", " ", "are", " ", 
      RowBox[{"done", ".", " ", "Check"}], " ", "the", " ", "solution"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solTheseus", "=", "BestSol"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fidTheseus", "=", 
     RowBox[{
      RowBox[{"Fidelity", "//.", 
       RowBox[{"solTheseus", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
      RowBox[{"Thread", "[", 
       RowBox[{"BestReplacementList", "\[Rule]", "0"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EdgesTheseus", " ", "=", 
     RowBox[{"Length", "[", "BestCurrentWeights", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", " ", 
    RowBox[{
    "\"\<Fidelity = \>\"", ",", "fidTheseus", ",", " ", "\"\<, \>\"", ",", 
     "EdgesTheseus", ",", "\"\</\>\"", ",", 
     RowBox[{"Length", "[", "AllWeights", "]"}], ",", "\"\< weights (\>\"", 
     ",", " ", 
     RowBox[{"Abs", "[", 
      RowBox[{"EdgesDeleted", "-", "EdgesTheseus"}], "]"}], ",", 
     "\"\< more edges deleted)\>\""}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"fidTheseus", ">", "0.99"}], ",", 
      RowBox[{"Print", "[", "\"\<Target state found!\>\"", "]"}], ",", " ", 
      RowBox[{"Print", "[", "\"\<Target state don't found :-(\>\"", "]"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Print", " ", "the", " ", "solution"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coef", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"AllColoredPMs", "//.", 
        RowBox[{"solTheseus", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
       RowBox[{"Thread", "[", 
        RowBox[{"BestReplacementList", "\[Rule]", "0"}], "]"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nonzero", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"AllColoredPMs", "//.", 
          RowBox[{"solTheseus", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
         RowBox[{"Thread", "[", 
          RowBox[{"BestReplacementList", "\[Rule]", "0"}], "]"}]}], "]"}], 
       "[", "\"\<NonzeroPositions\>\"", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"norm", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"coef", "[", 
         RowBox[{"[", 
          RowBox[{"nonzero", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "^", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "nonzero", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resstate", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"coeftmp", " ", "=", " ", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"coef", "[", 
            RowBox[{"[", 
             RowBox[{"nonzero", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "/", 
           RowBox[{"Sqrt", "[", "norm", "]"}]}], ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "3"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"coeftmp", "\[NotEqual]", "0"}], ",", 
         RowBox[{"resstate", " ", "=", 
          RowBox[{
           RowBox[{"resstate", "+", 
            RowBox[{"coeftmp", 
             RowBox[{"(", 
              RowBox[{"AllColoredPMs", "[", 
               RowBox[{"[", 
                RowBox[{"nonzero", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ")"}]}]}], "//.", 
           RowBox[{
            RowBox[{"w", "[", 
             RowBox[{"cc1_", ",", "cc2_", ",", "a_", ",", "b_"}], "]"}], 
            "\[Rule]", 
            RowBox[{
             RowBox[{"a", "[", "cc1", "]"}], "*", 
             RowBox[{"b", "[", "cc2", "]"}]}]}]}]}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "nonzero", "]"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Target state =\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "state", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Obtained state = \>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"Chop", "[", "resstate", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Graph weights:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"Chop", "[", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Total time Theseus further optimization = \>\"", ",", 
      RowBox[{"TimeTheseusMin", "/", "60"}], ",", " ", "\"\< min\>\""}], "]"}]
     , ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Total time (problem generation + Theseus + further opt) = \>\"", 
      ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "TimePM", "+", "Time1Min", "+", "TimeTheseus", "+", " ", 
         "TimeTheseusMin"}], ")"}], "/", "60"}]}], "]"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8309478644570446`*^9, 3.8309480310073285`*^9}, {
   3.8309480633969994`*^9, 3.830948130639885*^9}, {3.830948178890829*^9, 
   3.83094823895417*^9}, {3.8309483017579603`*^9, 3.8309483182692137`*^9}, {
   3.8309484398202567`*^9, 3.8309484633871713`*^9}, 3.830948675333593*^9, {
   3.8309490903161554`*^9, 3.830949152932618*^9}, {3.830950506464693*^9, 
   3.8309505378048954`*^9}, {3.8309508774554725`*^9, 3.830950896612367*^9}, {
   3.830951258559014*^9, 3.8309513026709476`*^9}, {3.8309513471761775`*^9, 
   3.830951347686555*^9}, 3.8309514148336086`*^9, {3.8309514474806376`*^9, 
   3.830951502564475*^9}, {3.8311518860410824`*^9, 3.831151892419629*^9}, 
   3.8311526558759437`*^9, {3.83115293599135*^9, 3.831152987407381*^9}, {
   3.831203107802867*^9, 3.83120333704239*^9}, {3.831203607001011*^9, 
   3.831203705267688*^9}, {3.8312037797797155`*^9, 3.8312038130322247`*^9}, {
   3.831204330963352*^9, 3.8312044703841734`*^9}, {3.8312047595635433`*^9, 
   3.831204771159259*^9}, {3.8312050460165224`*^9, 3.8312050796302247`*^9}, 
   3.831205954753884*^9, {3.8312059913117123`*^9, 3.831206018071303*^9}, {
   3.8312060578307743`*^9, 3.8312060878747206`*^9}, {3.8312061904153337`*^9, 
   3.831206240772571*^9}, {3.8312062762417865`*^9, 3.831206276418541*^9}, {
   3.8312063072103353`*^9, 3.8312063516018724`*^9}, {3.8312064133232775`*^9, 
   3.831206433109419*^9}, {3.831206502773299*^9, 3.8312065073168344`*^9}, 
   3.8312065772489834`*^9, {3.8312066567726793`*^9, 3.831206695572908*^9}, {
   3.8312067518153296`*^9, 3.8312067617150416`*^9}, {3.83120679727411*^9, 
   3.831206834882843*^9}, {3.831206865612053*^9, 3.831206866242468*^9}, {
   3.8312069039700737`*^9, 3.831206934794944*^9}, {3.831207003001876*^9, 
   3.831207013432584*^9}, {3.831207074209902*^9, 3.831207105386342*^9}, {
   3.831207136587242*^9, 3.8312071895537577`*^9}, {3.83120830955324*^9, 
   3.8312083298894396`*^9}, {3.8312085522315173`*^9, 3.831208572744294*^9}, {
   3.8312086099829545`*^9, 3.831208640791545*^9}, {3.83120973720391*^9, 
   3.8312097519115033`*^9}, {3.831310847326622*^9, 3.831310897804577*^9}, {
   3.8313109576293807`*^9, 3.8313109984787097`*^9}, {3.831311235980232*^9, 
   3.8313112457682734`*^9}, {3.831311301968511*^9, 3.831311303422453*^9}, 
   3.8313113659069567`*^9, {3.8313114053031993`*^9, 3.831311504046356*^9}, {
   3.8313115410147963`*^9, 3.8313117065422363`*^9}, {3.831311741167303*^9, 
   3.8313117941584616`*^9}, {3.8313119404828854`*^9, 
   3.8313119743588266`*^9}, {3.8313121463600082`*^9, 3.831312250520357*^9}, {
   3.831312282431999*^9, 3.8313122904884787`*^9}, {3.831312320686658*^9, 
   3.831312392053521*^9}, {3.8313124248552723`*^9, 3.8313125233667345`*^9}, {
   3.831312758316329*^9, 3.8313127705081325`*^9}, {3.8313158563934097`*^9, 
   3.8313159149490957`*^9}, {3.8313159617289634`*^9, 3.831315974382061*^9}, {
   3.8313160378504686`*^9, 3.8313160812041826`*^9}, {3.831316147871075*^9, 
   3.8313161951563683`*^9}, {3.8313162506892195`*^9, 
   3.8313163523861995`*^9}, {3.831316415794927*^9, 3.831316452033534*^9}, {
   3.8313165663030815`*^9, 3.8313166045151787`*^9}, {3.8313166529768925`*^9, 
   3.8313166780242443`*^9}, {3.831316753285367*^9, 3.8313167669618635`*^9}, {
   3.8313168776081495`*^9, 3.831316908600581*^9}, {3.8313169481745024`*^9, 
   3.8313169838675404`*^9}, {3.831317052950453*^9, 3.8313170605511265`*^9}, {
   3.831317096836656*^9, 3.831317125079355*^9}, {3.8313171713246994`*^9, 
   3.831317309386969*^9}, {3.831317409396702*^9, 3.831317471799264*^9}, {
   3.831317554754881*^9, 3.8313175598419123`*^9}, {3.8314610196103644`*^9, 
   3.8314612070332947`*^9}, {3.831461243194666*^9, 3.831461396936679*^9}, {
   3.8314630711651163`*^9, 3.831463073368627*^9}, {3.8314632934026756`*^9, 
   3.8314633348709536`*^9}, 3.8314633679211407`*^9, {3.8314634006334257`*^9, 
   3.8314634220054245`*^9}, {3.831464101578203*^9, 3.8314641120137663`*^9}, 
   3.831464503974387*^9, {3.832011094931587*^9, 3.83201118250236*^9}, {
   3.8320112311274195`*^9, 3.832011231397633*^9}, {3.832011749092416*^9, 
   3.8320118030214024`*^9}, {3.8320120096223116`*^9, 3.832012374277231*^9}, {
   3.8320124087304535`*^9, 3.8320128641553745`*^9}, {3.8320129184152966`*^9, 
   3.83201306736129*^9}, {3.832013415296479*^9, 3.8320134164755836`*^9}, {
   3.8348254351835732`*^9, 3.834825799280345*^9}, {3.8348260260603724`*^9, 
   3.834826203516141*^9}, {3.8348262406237497`*^9, 3.8348262653324833`*^9}, {
   3.8348263105336237`*^9, 3.834826505009081*^9}, {3.834827298829116*^9, 
   3.834827463845374*^9}, {3.8348278339418716`*^9, 3.834827898265825*^9}, {
   3.8348279464028215`*^9, 3.834828000145525*^9}, {3.8348280558434525`*^9, 
   3.834828107229652*^9}, {3.8348282355433016`*^9, 3.8348282363583612`*^9}, {
   3.8348282759297853`*^9, 3.834828310994727*^9}, 3.8348294947061963`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fidelity = \"\>", "\[InvisibleSpace]", "0.9999999967659288`", 
   "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"/\"\>", "\[InvisibleSpace]", "216", 
   "\[InvisibleSpace]", "\<\" weights (\"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\" more edges deleted)\"\>"}],
  SequenceForm[
  "Fidelity = ", 0.9999999967659288, ", ", 9, "/", 216, " weights (", 0, 
   " more edges deleted)"],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8348280353924894`*^9, 3.834828109343624*^9, 3.8348288674210243`*^9, 
   3.8348291614700174`*^9, 3.8348295427601414`*^9, {3.834829588359483*^9, 
   3.834829605239624*^9}}],

Cell[BoxData["\<\"Target state found!\"\>"], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8348280353924894`*^9, 3.834828109343624*^9, 3.8348288674210243`*^9, 
   3.8348291614700174`*^9, 3.8348295427601414`*^9, {3.834829588359483*^9, 
   3.834829605244629*^9}}],

Cell[BoxData["\<\"Target state =\"\>"], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8348280353924894`*^9, 3.834828109343624*^9, 3.8348288674210243`*^9, 
   3.8348291614700174`*^9, 3.8348295427601414`*^9, {3.834829588359483*^9, 
   3.834829605649684*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1", ",", "3", ",", "0"}], "}"}]}], "}"}]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8348280353924894`*^9, 3.834828109343624*^9, 3.8348288674210243`*^9, 
   3.8348291614700174`*^9, 3.8348295427601414`*^9, {3.834829588359483*^9, 
   3.834829605659537*^9}}],

Cell[BoxData["\<\"Obtained state = \"\>"], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8348280353924894`*^9, 3.834828109343624*^9, 3.8348288674210243`*^9, 
   3.8348291614700174`*^9, 3.8348295427601414`*^9, {3.834829588359483*^9, 
   3.834829605664525*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.40826586430738177`", " ", 
   RowBox[{"\<\"a\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.4081995887378048`", " ", 
   RowBox[{"\<\"a\"\>", "[", "3", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "3", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.408270737633454`", " ", 
   RowBox[{"\<\"a\"\>", "[", "4", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "4", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.40825037149492893`", " ", 
   RowBox[{"\<\"a\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.40824816668908903`", " ", 
   RowBox[{"\<\"a\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.40825500995960734`", " ", 
   RowBox[{"\<\"a\"\>", "[", "5", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "3", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}]}]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8348280353924894`*^9, 3.834828109343624*^9, 3.8348288674210243`*^9, 
   3.8348291614700174`*^9, 3.8348295427601414`*^9, {3.834829588359483*^9, 
   3.8348296056775265`*^9}}],

Cell[BoxData["\<\"Graph weights:\"\>"], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8348280353924894`*^9, 3.834828109343624*^9, 3.8348288674210243`*^9, 
   3.8348291614700174`*^9, 3.8348295427601414`*^9, {3.834829588359483*^9, 
   3.834829605683527*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "0", ",", "\<\"a\"\>", ",", "\<\"b\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "1.4108493462849439`"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "0", ",", "\<\"c\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", "8.98943686097733`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "0", ",", "\<\"b\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", "0.9523045426091827`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "1", ",", "\<\"a\"\>", ",", "\<\"c\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "13.31778899686175`"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"2", ",", "0", ",", "\<\"a\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", "1.249697885715362`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"2", ",", "2", ",", "\<\"b\"\>", ",", "\<\"c\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "10.148316441948445`"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"3", ",", "3", ",", "\<\"a\"\>", ",", "\<\"b\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "1.41084900796212`"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"5", ",", "3", ",", "\<\"a\"\>", ",", "\<\"c\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "13.317884127315914`"}]}]}], "}"}]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8348280353924894`*^9, 3.834828109343624*^9, 3.8348288674210243`*^9, 
   3.8348291614700174`*^9, 3.8348295427601414`*^9, {3.834829588359483*^9, 
   3.8348296056965265`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time Theseus further optimization = \"\>", 
   "\[InvisibleSpace]", "0.0533833083333333333`7.9571017287748775", 
   "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "Total time Theseus further optimization = ", 
   0.0533833083333333333`7.9571017287748775, " min"],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8348280353924894`*^9, 3.834828109343624*^9, 3.8348288674210243`*^9, 
   3.8348291614700174`*^9, 3.8348295427601414`*^9, {3.834829588359483*^9, 
   3.8348296057035446`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time (problem generation + Theseus + further opt) = \
\"\>", "\[InvisibleSpace]", "0.1366178966666666666`7.666233834309825"}],
  SequenceForm[
  "Total time (problem generation + Theseus + further opt) = ", 
   0.1366178966666666666`7.666233834309825],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{
  3.8348280353924894`*^9, 3.834828109343624*^9, 3.8348288674210243`*^9, 
   3.8348291614700174`*^9, 3.8348295427601414`*^9, {3.834829588359483*^9, 
   3.8348296057105694`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Theseus minimal solution using Klaus", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.834827213889515*^9, 3.8348272212015495`*^9}, {
  3.8348281436237497`*^9, 3.834828145137184*^9}}],

Cell["\<\
How can we be sure that Theseus solution is minimal and not a local minima? 
Another way is to try to remove each of the remaining edges to see if we \
still obtain the target state using Klaus to check if the solutivo is \
satisfible.

This approach also ensures that the solution obtained is not an approximation \
(forbidden basis states with weights \[Rule] 0)\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.834827226701226*^9, 3.8348272926347694`*^9}, {
  3.834828150903451*^9, 3.8348282106241584`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Reload", " ", "Theseus", " ", "solution"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BestReplacementList", "=", "BRLTheseusPro"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestCurrentWeights", "=", "BCWTheseusPro"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t0", "=", 
     RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Initial", " ", "logic", " ", "by", " ", "setting", " ", "all", " ", 
     "already", " ", "deleted", " ", "edges", " ", "to", " ", "False"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestKlauses", " ", "=", "  ", 
     RowBox[{"Klauses", "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"BestReplacementList", "\[Rule]", "False"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReplacementList", "=", "BestReplacementList"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CurrentWeights", "=", "BestCurrentWeights"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AvailableWeights", " ", "=", " ", "CurrentWeights"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "AvailableWeights", "]"}], ">", "0"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Delete", " ", "one", " ", "edge", " ", "randomly"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"falsetmp", "=", 
        RowBox[{"RandomInteger", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "AvailableWeights", "]"}]}], "}"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"deleteedge", "=", 
        RowBox[{"AvailableWeights", "[", 
         RowBox[{"[", "falsetmp", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"ReplacementList", ",", "deleteedge"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"CurrentWeights", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"AllWeights", ",", "ReplacementList"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"CurrentKlauses", "=", 
        RowBox[{"BestKlauses", "/.", 
         RowBox[{"deleteedge", "\[Rule]", "False"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
          "If", " ", "the", " ", "edge", " ", "that", " ", "we", " ", 
           "deleted", " ", "made", " ", "the", " ", "Clauses"}], " ", "=", 
          " ", 
          RowBox[{"False", " ", "or", " ", "True"}]}], ",", " ", 
         RowBox[{
         "there", " ", "is", " ", "no", " ", "need", " ", "to", " ", "check", 
          " ", "the", " ", "SAT"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"BooleanVariables", "[", "CurrentKlauses", "]"}], "]"}], 
          "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"logicVal", "=", "CurrentKlauses"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Solve", " ", "the", " ", "SAT"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"logicVal", "=", 
          RowBox[{"SatisfiableQ", "[", 
           RowBox[{"CurrentKlauses", ",", 
            RowBox[{"BooleanVariables", "[", "CurrentWeights", "]"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<SAT\>\""}]}], "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"logicVal", "\[Equal]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"BestReplacementList", "=", "ReplacementList"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"BestCurrentWeights", "=", "CurrentWeights"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"BestKlauses", "=", "CurrentKlauses"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AvailableWeights", "=", "CurrentWeights"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Try", " ", "again", " ", "with", " ", "anothed", " ", "edge"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ReplacementList", "=", "BestReplacementList"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AvailableWeights", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"AvailableWeights", ",", "deleteedge"}], "]"}]}], ";"}]}],
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Once", " ", "we", " ", "have", " ", "tried", " ", "all", " ", "edges"}],
      ",", " ", 
     RowBox[{
     "we", " ", "have", " ", "to", " ", "compute", " ", "the", " ", "weights",
       " ", "by", " ", "minimizing", " ", "the", " ", "Loss", " ", 
      "Function"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CurrentLoss", "=", 
     RowBox[{"TotalLoss", "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"BestReplacementList", "\[Rule]", "0"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initvar", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"BestCurrentWeights", ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"Length", "[", "BestCurrentWeights", "]"}]}], "]"}]}], 
       "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solKlaus", "=", 
     RowBox[{"FindMinimum", "[", 
      RowBox[{"CurrentLoss", ",", "initvar", ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "3"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "3"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t1", "=", 
     RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TimeKlaus", "=", 
     RowBox[{"t1", "-", "t0"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"We", " ", "are", " ", 
     RowBox[{"done", "!"}], " ", "Print", " ", "the", " ", "solution"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fidKlaus", "=", 
     RowBox[{
      RowBox[{"Fidelity", "//.", 
       RowBox[{"solKlaus", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
      RowBox[{"Thread", "[", 
       RowBox[{"BestReplacementList", "\[Rule]", "0"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EdgesTheseusKlaus", "=", 
     RowBox[{"Length", "[", "BestCurrentWeights", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", " ", 
    RowBox[{
    "\"\<Fidelity = \>\"", ",", "fidKlaus", ",", " ", "\"\<, \>\"", ",", 
     "EdgesTheseusKlaus", ",", "\"\</\>\"", ",", 
     RowBox[{"Length", "[", "AllWeights", "]"}], ",", "\"\< weights (\>\"", 
     ",", " ", 
     RowBox[{"Abs", "[", 
      RowBox[{"EdgesDeleted", "-", "EdgesTheseusKlaus"}], "]"}], ",", 
     "\"\< more edges deleted)\>\""}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"fidKlaus", ">", "0.99"}], ",", 
      RowBox[{"Print", "[", "\"\<Target state found!\>\"", "]"}], ",", " ", 
      RowBox[{"Print", "[", "\"\<Target state don't found :-(\>\"", "]"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Print", " ", "the", " ", "solution"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coef", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"AllColoredPMs", "//.", 
        RowBox[{"solKlaus", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
       RowBox[{"Thread", "[", 
        RowBox[{"BestReplacementList", "\[Rule]", "0"}], "]"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nonzero", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"AllColoredPMs", "//.", 
          RowBox[{"solKlaus", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
         RowBox[{"Thread", "[", 
          RowBox[{"BestReplacementList", "\[Rule]", "0"}], "]"}]}], "]"}], 
       "[", "\"\<NonzeroPositions\>\"", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"norm", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"coef", "[", 
         RowBox[{"[", 
          RowBox[{"nonzero", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "^", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "nonzero", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resstate", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"coeftmp", " ", "=", " ", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"coef", "[", 
            RowBox[{"[", 
             RowBox[{"nonzero", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "/", 
           RowBox[{"Sqrt", "[", "norm", "]"}]}], ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "3"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"coeftmp", "\[NotEqual]", "0"}], ",", 
         RowBox[{"resstate", " ", "=", 
          RowBox[{
           RowBox[{"resstate", "+", 
            RowBox[{"coeftmp", 
             RowBox[{"(", 
              RowBox[{"AllColoredPMs", "[", 
               RowBox[{"[", 
                RowBox[{"nonzero", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ")"}]}]}], "//.", 
           RowBox[{
            RowBox[{"w", "[", 
             RowBox[{"cc1_", ",", "cc2_", ",", "a_", ",", "b_"}], "]"}], 
            "\[Rule]", 
            RowBox[{
             RowBox[{"a", "[", "cc1", "]"}], "*", 
             RowBox[{"b", "[", "cc2", "]"}]}]}]}]}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "nonzero", "]"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Target state =\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "state", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Obtained state = \>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"Chop", "[", "resstate", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Graph weights:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"Chop", "[", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Total time Theseus further optimization with Klaus = \>\"", ",", 
      RowBox[{"TimeKlaus", "/", "60"}], ",", " ", "\"\< min\>\""}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Total time (problem generation + Theseus + further opt Klaus) = \
\>\"", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "TimePM", "+", "Time1Min", "+", "TimeTheseus", "+", " ", 
         "TimeKlaus"}], ")"}], "/", "60"}]}], "]"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8309478644570446`*^9, 3.8309480310073285`*^9}, {
   3.8309480633969994`*^9, 3.830948130639885*^9}, {3.830948178890829*^9, 
   3.83094823895417*^9}, {3.8309483017579603`*^9, 3.8309483182692137`*^9}, {
   3.8309484398202567`*^9, 3.8309484633871713`*^9}, 3.830948675333593*^9, {
   3.8309490903161554`*^9, 3.830949152932618*^9}, {3.830950506464693*^9, 
   3.8309505378048954`*^9}, {3.8309508774554725`*^9, 3.830950896612367*^9}, {
   3.830951258559014*^9, 3.8309513026709476`*^9}, {3.8309513471761775`*^9, 
   3.830951347686555*^9}, 3.8309514148336086`*^9, {3.8309514474806376`*^9, 
   3.830951502564475*^9}, {3.8311518860410824`*^9, 3.831151892419629*^9}, 
   3.8311526558759437`*^9, {3.83115293599135*^9, 3.831152987407381*^9}, {
   3.831203107802867*^9, 3.83120333704239*^9}, {3.831203607001011*^9, 
   3.831203705267688*^9}, {3.8312037797797155`*^9, 3.8312038130322247`*^9}, {
   3.831204330963352*^9, 3.8312044703841734`*^9}, {3.8312047595635433`*^9, 
   3.831204771159259*^9}, {3.8312050460165224`*^9, 3.8312050796302247`*^9}, 
   3.831205954753884*^9, {3.8312059913117123`*^9, 3.831206018071303*^9}, {
   3.8312060578307743`*^9, 3.8312060878747206`*^9}, {3.8312061904153337`*^9, 
   3.831206240772571*^9}, {3.8312062762417865`*^9, 3.831206276418541*^9}, {
   3.8312063072103353`*^9, 3.8312063516018724`*^9}, {3.8312064133232775`*^9, 
   3.831206433109419*^9}, {3.831206502773299*^9, 3.8312065073168344`*^9}, 
   3.8312065772489834`*^9, {3.8312066567726793`*^9, 3.831206695572908*^9}, {
   3.8312067518153296`*^9, 3.8312067617150416`*^9}, {3.83120679727411*^9, 
   3.831206834882843*^9}, {3.831206865612053*^9, 3.831206866242468*^9}, {
   3.8312069039700737`*^9, 3.831206934794944*^9}, {3.831207003001876*^9, 
   3.831207013432584*^9}, {3.831207074209902*^9, 3.831207105386342*^9}, {
   3.831207136587242*^9, 3.8312071895537577`*^9}, {3.83120830955324*^9, 
   3.8312083298894396`*^9}, {3.8312085522315173`*^9, 3.831208572744294*^9}, {
   3.8312086099829545`*^9, 3.831208640791545*^9}, {3.83120973720391*^9, 
   3.8312097519115033`*^9}, {3.831310847326622*^9, 3.831310897804577*^9}, {
   3.8313109576293807`*^9, 3.8313109984787097`*^9}, {3.831311235980232*^9, 
   3.8313112457682734`*^9}, {3.831311301968511*^9, 3.831311303422453*^9}, 
   3.8313113659069567`*^9, {3.8313114053031993`*^9, 3.831311504046356*^9}, {
   3.8313115410147963`*^9, 3.8313117065422363`*^9}, {3.831311741167303*^9, 
   3.8313117941584616`*^9}, {3.8313119404828854`*^9, 
   3.8313119743588266`*^9}, {3.8313121463600082`*^9, 3.831312250520357*^9}, {
   3.831312282431999*^9, 3.8313122904884787`*^9}, {3.831312320686658*^9, 
   3.831312392053521*^9}, {3.8313124248552723`*^9, 3.8313125233667345`*^9}, {
   3.831312758316329*^9, 3.8313127705081325`*^9}, {3.8313158563934097`*^9, 
   3.8313159149490957`*^9}, {3.8313159617289634`*^9, 3.831315974382061*^9}, {
   3.8313160378504686`*^9, 3.8313160812041826`*^9}, {3.831316147871075*^9, 
   3.8313161951563683`*^9}, {3.8313162506892195`*^9, 
   3.8313163523861995`*^9}, {3.831316415794927*^9, 3.831316452033534*^9}, {
   3.8313165663030815`*^9, 3.8313166045151787`*^9}, {3.8313166529768925`*^9, 
   3.8313166780242443`*^9}, {3.831316753285367*^9, 3.8313167669618635`*^9}, {
   3.8313168776081495`*^9, 3.831316908600581*^9}, {3.8313169481745024`*^9, 
   3.8313169838675404`*^9}, {3.831317052950453*^9, 3.8313170605511265`*^9}, {
   3.831317096836656*^9, 3.831317125079355*^9}, {3.8313171713246994`*^9, 
   3.831317309386969*^9}, {3.831317409396702*^9, 3.831317471799264*^9}, {
   3.831317554754881*^9, 3.8313175598419123`*^9}, {3.8314610196103644`*^9, 
   3.8314612070332947`*^9}, {3.831461243194666*^9, 3.831461396936679*^9}, {
   3.8314630711651163`*^9, 3.831463073368627*^9}, {3.8314632934026756`*^9, 
   3.8314633348709536`*^9}, 3.8314633679211407`*^9, {3.8314634006334257`*^9, 
   3.8314634220054245`*^9}, {3.831464101578203*^9, 3.8314641120137663`*^9}, 
   3.831464503974387*^9, {3.832011094931587*^9, 3.83201118250236*^9}, {
   3.8320112311274195`*^9, 3.832011231397633*^9}, {3.832011749092416*^9, 
   3.8320118030214024`*^9}, {3.8320120096223116`*^9, 3.832012374277231*^9}, {
   3.8320124087304535`*^9, 3.8320128641553745`*^9}, {3.8320129184152966`*^9, 
   3.83201306736129*^9}, {3.832013415296479*^9, 3.8320134164755836`*^9}, {
   3.8348254351835732`*^9, 3.834825799280345*^9}, {3.8348260260603724`*^9, 
   3.834826203516141*^9}, {3.8348262406237497`*^9, 3.8348262653324833`*^9}, {
   3.8348263105336237`*^9, 3.834826505009081*^9}, {3.834827298829116*^9, 
   3.834827463845374*^9}, {3.8348278339418716`*^9, 3.8348278515764756`*^9}, {
   3.8348282156492276`*^9, 3.8348282273909516`*^9}, {3.834828262243083*^9, 
   3.834828263127*^9}, {3.8348282975377235`*^9, 3.8348283408364873`*^9}, {
   3.834828445255847*^9, 3.8348288392352486`*^9}, {3.8348290546886387`*^9, 
   3.8348290624788227`*^9}, 3.8348294994014254`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fidelity = \"\>", "\[InvisibleSpace]", "0.999999914618103`", 
   "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"/\"\>", "\[InvisibleSpace]", "216", 
   "\[InvisibleSpace]", "\<\" weights (\"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\" more edges deleted)\"\>"}],
  SequenceForm[
  "Fidelity = ", 0.999999914618103, ", ", 9, "/", 216, " weights (", 0, 
   " more edges deleted)"],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8314644920550814`*^9, 3.831464515470874*^9}, 
   3.8314658886468177`*^9, 3.831473604250889*^9, 3.831578002374696*^9, 
   3.831581319724784*^9, 3.831584326034483*^9, 3.831584785371073*^9, 
   3.8320112344939604`*^9, 3.8320118125834417`*^9, 3.8320128871897483`*^9, 
   3.832012943634443*^9, {3.8320130458574533`*^9, 3.832013070533887*^9}, 
   3.832013421401016*^9, 3.8320136520559225`*^9, 3.8320143703291006`*^9, 
   3.832015295831103*^9, 3.8320164366330867`*^9, 3.832304541523565*^9, 
   3.8323047830769053`*^9, 3.832305486828342*^9, {3.8348287998013415`*^9, 
   3.834828825000557*^9}, 3.8348288676260233`*^9, 3.8348291630063925`*^9, {
   3.834829589911657*^9, 3.8348296068045335`*^9}}],

Cell[BoxData["\<\"Target state found!\"\>"], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8314644920550814`*^9, 3.831464515470874*^9}, 
   3.8314658886468177`*^9, 3.831473604250889*^9, 3.831578002374696*^9, 
   3.831581319724784*^9, 3.831584326034483*^9, 3.831584785371073*^9, 
   3.8320112344939604`*^9, 3.8320118125834417`*^9, 3.8320128871897483`*^9, 
   3.832012943634443*^9, {3.8320130458574533`*^9, 3.832013070533887*^9}, 
   3.832013421401016*^9, 3.8320136520559225`*^9, 3.8320143703291006`*^9, 
   3.832015295831103*^9, 3.8320164366330867`*^9, 3.832304541523565*^9, 
   3.8323047830769053`*^9, 3.832305486828342*^9, {3.8348287998013415`*^9, 
   3.834828825000557*^9}, 3.8348288676260233`*^9, 3.8348291630063925`*^9, {
   3.834829589911657*^9, 3.834829606808527*^9}}],

Cell[BoxData["\<\"Target state =\"\>"], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8314644920550814`*^9, 3.831464515470874*^9}, 
   3.8314658886468177`*^9, 3.831473604250889*^9, 3.831578002374696*^9, 
   3.831581319724784*^9, 3.831584326034483*^9, 3.831584785371073*^9, 
   3.8320112344939604`*^9, 3.8320118125834417`*^9, 3.8320128871897483`*^9, 
   3.832012943634443*^9, {3.8320130458574533`*^9, 3.832013070533887*^9}, 
   3.832013421401016*^9, 3.8320136520559225`*^9, 3.8320143703291006`*^9, 
   3.832015295831103*^9, 3.8320164366330867`*^9, 3.832304541523565*^9, 
   3.8323047830769053`*^9, 3.832305486828342*^9, {3.8348287998013415`*^9, 
   3.834828825000557*^9}, 3.8348288676260233`*^9, 3.8348291630063925`*^9, {
   3.834829589911657*^9, 3.8348296071785264`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1", ",", "3", ",", "0"}], "}"}]}], "}"}]], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8314644920550814`*^9, 3.831464515470874*^9}, 
   3.8314658886468177`*^9, 3.831473604250889*^9, 3.831578002374696*^9, 
   3.831581319724784*^9, 3.831584326034483*^9, 3.831584785371073*^9, 
   3.8320112344939604`*^9, 3.8320118125834417`*^9, 3.8320128871897483`*^9, 
   3.832012943634443*^9, {3.8320130458574533`*^9, 3.832013070533887*^9}, 
   3.832013421401016*^9, 3.8320136520559225`*^9, 3.8320143703291006`*^9, 
   3.832015295831103*^9, 3.8320164366330867`*^9, 3.832304541523565*^9, 
   3.8323047830769053`*^9, 3.832305486828342*^9, {3.8348287998013415`*^9, 
   3.834828825000557*^9}, 3.8348288676260233`*^9, 3.8348291630063925`*^9, {
   3.834829589911657*^9, 3.8348296071875277`*^9}}],

Cell[BoxData["\<\"Obtained state = \"\>"], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8314644920550814`*^9, 3.831464515470874*^9}, 
   3.8314658886468177`*^9, 3.831473604250889*^9, 3.831578002374696*^9, 
   3.831581319724784*^9, 3.831584326034483*^9, 3.831584785371073*^9, 
   3.8320112344939604`*^9, 3.8320118125834417`*^9, 3.8320128871897483`*^9, 
   3.832012943634443*^9, {3.8320130458574533`*^9, 3.832013070533887*^9}, 
   3.832013421401016*^9, 3.8320136520559225`*^9, 3.8320143703291006`*^9, 
   3.832015295831103*^9, 3.8320164366330867`*^9, 3.832304541523565*^9, 
   3.8323047830769053`*^9, 3.832305486828342*^9, {3.8348287998013415`*^9, 
   3.834828825000557*^9}, 3.8348288676260233`*^9, 3.8348291630063925`*^9, {
   3.834829589911657*^9, 3.8348296071942196`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.4083125213286706`", " ", 
   RowBox[{"\<\"a\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.4082899249177576`", " ", 
   RowBox[{"\<\"a\"\>", "[", "3", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "3", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.4083072881478377`", " ", 
   RowBox[{"\<\"a\"\>", "[", "4", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "4", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "0", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.4079822126836631`", " ", 
   RowBox[{"\<\"a\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.4083070039533262`", " ", 
   RowBox[{"\<\"a\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "2", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}], "+", 
  RowBox[{"0.4082906871808802`", " ", 
   RowBox[{"\<\"a\"\>", "[", "5", "]"}], " ", 
   RowBox[{"\<\"b\"\>", "[", "1", "]"}], " ", 
   RowBox[{"\<\"c\"\>", "[", "3", "]"}], " ", 
   RowBox[{"\<\"d\"\>", "[", "0", "]"}]}]}]], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8314644920550814`*^9, 3.831464515470874*^9}, 
   3.8314658886468177`*^9, 3.831473604250889*^9, 3.831578002374696*^9, 
   3.831581319724784*^9, 3.831584326034483*^9, 3.831584785371073*^9, 
   3.8320112344939604`*^9, 3.8320118125834417`*^9, 3.8320128871897483`*^9, 
   3.832012943634443*^9, {3.8320130458574533`*^9, 3.832013070533887*^9}, 
   3.832013421401016*^9, 3.8320136520559225`*^9, 3.8320143703291006`*^9, 
   3.832015295831103*^9, 3.8320164366330867`*^9, 3.832304541523565*^9, 
   3.8323047830769053`*^9, 3.832305486828342*^9, {3.8348287998013415`*^9, 
   3.834828825000557*^9}, 3.8348288676260233`*^9, 3.8348291630063925`*^9, {
   3.834829589911657*^9, 3.8348296072062087`*^9}}],

Cell[BoxData["\<\"Graph weights:\"\>"], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8314644920550814`*^9, 3.831464515470874*^9}, 
   3.8314658886468177`*^9, 3.831473604250889*^9, 3.831578002374696*^9, 
   3.831581319724784*^9, 3.831584326034483*^9, 3.831584785371073*^9, 
   3.8320112344939604`*^9, 3.8320118125834417`*^9, 3.8320128871897483`*^9, 
   3.832012943634443*^9, {3.8320130458574533`*^9, 3.832013070533887*^9}, 
   3.832013421401016*^9, 3.8320136520559225`*^9, 3.8320143703291006`*^9, 
   3.832015295831103*^9, 3.8320164366330867`*^9, 3.832304541523565*^9, 
   3.8323047830769053`*^9, 3.832305486828342*^9, {3.8348287998013415`*^9, 
   3.834828825000557*^9}, 3.8348288676260233`*^9, 3.8348291630063925`*^9, {
   3.834829589911657*^9, 3.8348296072122097`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "0", ",", "\<\"a\"\>", ",", "\<\"b\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "1.4108493462849439`"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "0", ",", "\<\"c\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", "8.98943686097733`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "0", ",", "\<\"b\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", "0.9523045426091827`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "1", ",", "\<\"a\"\>", ",", "\<\"c\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "13.31778899686175`"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"2", ",", "0", ",", "\<\"a\"\>", ",", "\<\"d\"\>"}], "]"}], 
    "\[Rule]", "1.249697885715362`"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"2", ",", "2", ",", "\<\"b\"\>", ",", "\<\"c\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "10.148316441948445`"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"3", ",", "3", ",", "\<\"a\"\>", ",", "\<\"b\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "1.41084900796212`"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"5", ",", "3", ",", "\<\"a\"\>", ",", "\<\"c\"\>"}], "]"}], 
    "\[Rule]", 
    RowBox[{"-", "13.317884127315914`"}]}]}], "}"}]], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8314644920550814`*^9, 3.831464515470874*^9}, 
   3.8314658886468177`*^9, 3.831473604250889*^9, 3.831578002374696*^9, 
   3.831581319724784*^9, 3.831584326034483*^9, 3.831584785371073*^9, 
   3.8320112344939604`*^9, 3.8320118125834417`*^9, 3.8320128871897483`*^9, 
   3.832012943634443*^9, {3.8320130458574533`*^9, 3.832013070533887*^9}, 
   3.832013421401016*^9, 3.8320136520559225`*^9, 3.8320143703291006`*^9, 
   3.832015295831103*^9, 3.8320164366330867`*^9, 3.832304541523565*^9, 
   3.8323047830769053`*^9, 3.832305486828342*^9, {3.8348287998013415`*^9, 
   3.834828825000557*^9}, 3.8348288676260233`*^9, 3.8348291630063925`*^9, {
   3.834829589911657*^9, 3.834829607223215*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time Theseus further optimization with Klaus = \"\>", 
   "\[InvisibleSpace]", "0.0127667066666666666`7.335775123840229", 
   "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "Total time Theseus further optimization with Klaus = ", 
   0.0127667066666666666`7.335775123840229, " min"],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8314644920550814`*^9, 3.831464515470874*^9}, 
   3.8314658886468177`*^9, 3.831473604250889*^9, 3.831578002374696*^9, 
   3.831581319724784*^9, 3.831584326034483*^9, 3.831584785371073*^9, 
   3.8320112344939604`*^9, 3.8320118125834417`*^9, 3.8320128871897483`*^9, 
   3.832012943634443*^9, {3.8320130458574533`*^9, 3.832013070533887*^9}, 
   3.832013421401016*^9, 3.8320136520559225`*^9, 3.8320143703291006`*^9, 
   3.832015295831103*^9, 3.8320164366330867`*^9, 3.832304541523565*^9, 
   3.8323047830769053`*^9, 3.832305486828342*^9, {3.8348287998013415`*^9, 
   3.834828825000557*^9}, 3.8348288676260233`*^9, 3.8348291630063925`*^9, {
   3.834829589911657*^9, 3.8348296072302136`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time (problem generation + Theseus + further opt Klaus) \
= \"\>", "\[InvisibleSpace]", "0.096001295`7.513003330995257"}],
  SequenceForm[
  "Total time (problem generation + Theseus + further opt Klaus) = ", 
   0.096001295`7.513003330995257],
  Editable->False]], "Print",
 InitializationCell->True,
 CellChangeTimes->{{3.8314644920550814`*^9, 3.831464515470874*^9}, 
   3.8314658886468177`*^9, 3.831473604250889*^9, 3.831578002374696*^9, 
   3.831581319724784*^9, 3.831584326034483*^9, 3.831584785371073*^9, 
   3.8320112344939604`*^9, 3.8320118125834417`*^9, 3.8320128871897483`*^9, 
   3.832012943634443*^9, {3.8320130458574533`*^9, 3.832013070533887*^9}, 
   3.832013421401016*^9, 3.8320136520559225`*^9, 3.8320143703291006`*^9, 
   3.832015295831103*^9, 3.8320164366330867`*^9, 3.832304541523565*^9, 
   3.8323047830769053`*^9, 3.832305486828342*^9, {3.8348287998013415`*^9, 
   3.834828825000557*^9}, 3.8348288676260233`*^9, 3.8348291630063925`*^9, {
   3.834829589911657*^9, 3.834829607237221*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparison", "Section",
 CellChangeTimes->{{3.8348289014164495`*^9, 3.8348289026374097`*^9}}],

Cell[CellGroupData[{

Cell["Edges solution", "Subsection",
 CellChangeTimes->{{3.8348289895353947`*^9, 3.834828996582829*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Edges Klaus = \>\"", ",", "EdgesKlaus"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Edges Theseus = \>\"", ",", "EdgesDeleted"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Edges Theseus with further optimization = \>\"", ",", "EdgesTheseus"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Edges Theseus with further optimization with Klaus = \>\"", ",", 
   "EdgesTheseusKlaus"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8348290667842116`*^9, 3.83482913605298*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Edges Klaus = \"\>", "\[InvisibleSpace]", "9"}],
  SequenceForm["Edges Klaus = ", 9],
  Editable->False]], "Print",
 CellChangeTimes->{3.8348291635292234`*^9, 3.8348296073171988`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Edges Theseus = \"\>", "\[InvisibleSpace]", "9"}],
  SequenceForm["Edges Theseus = ", 9],
  Editable->False]], "Print",
 CellChangeTimes->{3.8348291635292234`*^9, 3.834829607322197*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Edges Theseus with further optimization = \"\>", 
   "\[InvisibleSpace]", "9"}],
  SequenceForm["Edges Theseus with further optimization = ", 9],
  Editable->False]], "Print",
 CellChangeTimes->{3.8348291635292234`*^9, 3.8348296073281984`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Edges Theseus with further optimization with Klaus = \"\>", 
   "\[InvisibleSpace]", "9"}],
  SequenceForm["Edges Theseus with further optimization with Klaus = ", 9],
  Editable->False]], "Print",
 CellChangeTimes->{3.8348291635292234`*^9, 3.8348296073361945`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Time", "Subsection",
 CellChangeTimes->{{3.834828983202424*^9, 3.8348289837377634`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Total time(problem generation + Klaus) = \>\"", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
     "TimePM", "+", "TimeKlauses", "+", "TimeLogicOpt", "+", "TimeOpt"}], 
     ")"}], "/", "60"}], ",", "\"\< min\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Total time (problem generation + Theseus) = \>\"", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"TimePM", "+", "Time1Min", "+", "TimeTheseus"}], ")"}], "/", 
     "60"}], ",", "\"\< min\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Total time (problem generation + Theseus + further opt) = \>\"", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "TimePM", "+", "Time1Min", "+", "TimeTheseus", "+", " ", 
       "TimeTheseusMin"}], ")"}], "/", "60"}], ",", "\"\< min\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Total time (problem generation + Theseus + further opt Klaus) = \>\"",
     ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "TimePM", "+", "Time1Min", "+", "TimeTheseus", "+", " ", "TimeKlaus"}], 
      ")"}], "/", "60"}], ",", "\"\< min\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.834828925162857*^9, 3.8348289408345766`*^9}, {
  3.8348289744907675`*^9, 3.8348289778261037`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time(problem generation + Klaus) = \"\>", 
   "\[InvisibleSpace]", "0.0809743633333333333`7.439073781568111", 
   "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "Total time(problem generation + Klaus) = ", 
   0.0809743633333333333`7.439073781568111, " min"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8348289422091*^9, 3.8348291635872164`*^9, 
  3.8348296073789444`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time (problem generation + Theseus) = \"\>", 
   "\[InvisibleSpace]", "0.0832345883333333334`7.5479400884668655", 
   "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "Total time (problem generation + Theseus) = ", 
   0.0832345883333333334`7.5479400884668655, " min"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8348289422091*^9, 3.8348291635872164`*^9, 
  3.8348296073829403`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time (problem generation + Theseus + further opt) = \
\"\>", "\[InvisibleSpace]", "0.1366178966666666666`7.666233834309825", 
   "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "Total time (problem generation + Theseus + further opt) = ", 
   0.1366178966666666666`7.666233834309825, " min"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8348289422091*^9, 3.8348291635872164`*^9, 
  3.8348296073909407`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time (problem generation + Theseus + further opt Klaus) \
= \"\>", "\[InvisibleSpace]", "0.096001295`7.513003330995257", 
   "\[InvisibleSpace]", "\<\" min\"\>"}],
  SequenceForm[
  "Total time (problem generation + Theseus + further opt Klaus) = ", 
   0.096001295`7.513003330995257, " min"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8348289422091*^9, 3.8348291635872164`*^9, 
  3.8348296073957043`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1898, 956},
WindowMargins->{{-11, Automatic}, {Automatic, 0}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.0 para Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 178, 3, 150, "Title",
 InitializationCell->True],
Cell[761, 27, 313, 4, 84, "Subtitle",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1099, 35, 192, 3, 106, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1316, 42, 127, 2, 72, "Subsection",
 InitializationCell->True],
Cell[1446, 46, 3664, 96, 186, "Input",
 InitializationCell->True],
Cell[5113, 144, 384, 7, 69, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[5522, 155, 7167, 117, 244, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[12714, 276, 4688, 74, 34, "Print",
 InitializationCell->True],
Cell[17405, 352, 4073, 58, 34, "Print",
 InitializationCell->True],
Cell[21481, 412, 4073, 58, 34, "Print",
 InitializationCell->True],
Cell[25557, 472, 4065, 58, 34, "Print",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29683, 537, 446, 6, 72, "Subsection",
 InitializationCell->True],
Cell[30132, 545, 8795, 236, 853, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[38952, 785, 6571, 166, 708, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[45548, 955, 433, 9, 34, "Print",
 InitializationCell->True],
Cell[45984, 966, 501, 10, 34, "Print",
 InitializationCell->True],
Cell[46488, 978, 511, 10, 34, "Print",
 InitializationCell->True],
Cell[47002, 990, 479, 10, 34, "Print",
 InitializationCell->True],
Cell[47484, 1002, 577, 12, 34, "Print",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48122, 1021, 179, 3, 72, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[48326, 1028, 5549, 124, 505, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[53900, 1156, 2304, 34, 34, "Print",
 InitializationCell->True],
Cell[56207, 1192, 2318, 35, 34, "Print",
 InitializationCell->True],
Cell[58528, 1229, 2418, 37, 34, "Print",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61007, 1273, 427, 8, 72, "Subsection",
 InitializationCell->True],
Cell[61437, 1283, 1495, 34, 163, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62981, 1323, 205, 3, 106, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[63211, 1330, 15810, 378, 2216, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[79046, 1712, 755, 11, 34, "Print",
 InitializationCell->True],
Cell[79804, 1725, 1189, 21, 34, "Print",
 InitializationCell->True],
Cell[80996, 1748, 755, 11, 34, "Print",
 InitializationCell->True],
Cell[81754, 1761, 1112, 19, 34, "Print",
 InitializationCell->True],
Cell[82869, 1782, 748, 11, 34, "Print",
 InitializationCell->True],
Cell[83620, 1795, 745, 11, 34, "Print",
 InitializationCell->True],
Cell[84368, 1808, 1223, 25, 34, "Print",
 InitializationCell->True],
Cell[85594, 1835, 748, 11, 34, "Print",
 InitializationCell->True],
Cell[86345, 1848, 2121, 43, 34, "Print",
 InitializationCell->True],
Cell[88469, 1893, 742, 11, 34, "Print",
 InitializationCell->True],
Cell[89214, 1906, 2215, 53, 63, "Print",
 InitializationCell->True],
Cell[91432, 1961, 1001, 18, 34, "Print",
 InitializationCell->True],
Cell[92436, 1981, 1049, 19, 34, "Print",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93546, 2007, 133, 2, 106, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[93704, 2013, 21442, 501, 2999, "Input",
 InitializationCell->True],
Cell[115149, 2516, 426, 9, 35, "Message"],
Cell[115578, 2527, 444, 9, 35, "Message"],
Cell[CellGroupData[{
Cell[116047, 2540, 468, 9, 34, "Print"],
Cell[116518, 2551, 118, 1, 34, "Print"],
Cell[116639, 2554, 115, 1, 34, "Print"],
Cell[116757, 2557, 593, 15, 34, "Print"],
Cell[117353, 2574, 116, 1, 34, "Print"],
Cell[117472, 2577, 1471, 32, 34, "Print"],
Cell[118946, 2611, 113, 1, 34, "Print"],
Cell[119062, 2614, 1552, 41, 63, "Print"],
Cell[120617, 2657, 533, 10, 34, "Print"],
Cell[121153, 2669, 380, 8, 34, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[121582, 2683, 141, 2, 72, "Subsection",
 InitializationCell->True],
Cell[121726, 2687, 325, 6, 74, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[122076, 2697, 16662, 361, 2042, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[138763, 3062, 743, 15, 34, "Print",
 InitializationCell->True],
Cell[139509, 3079, 275, 5, 34, "Print",
 InitializationCell->True],
Cell[139787, 3086, 270, 5, 34, "Print",
 InitializationCell->True],
Cell[140060, 3093, 748, 19, 34, "Print",
 InitializationCell->True],
Cell[140811, 3114, 273, 5, 34, "Print",
 InitializationCell->True],
Cell[141087, 3121, 1630, 36, 34, "Print",
 InitializationCell->True],
Cell[142720, 3159, 270, 5, 34, "Print",
 InitializationCell->True],
Cell[142993, 3166, 1610, 44, 63, "Print",
 InitializationCell->True],
Cell[144606, 3212, 582, 13, 34, "Print",
 InitializationCell->True],
Cell[145191, 3227, 561, 12, 34, "Print",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[145813, 3246, 204, 3, 72, "Subsection",
 InitializationCell->True],
Cell[146020, 3251, 534, 11, 131, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[146579, 3266, 17001, 373, 2129, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[163605, 3643, 1254, 21, 34, "Print",
 InitializationCell->True],
Cell[164862, 3666, 786, 11, 34, "Print",
 InitializationCell->True],
Cell[165651, 3679, 783, 11, 34, "Print",
 InitializationCell->True],
Cell[166437, 3692, 1261, 25, 34, "Print",
 InitializationCell->True],
Cell[167701, 3719, 786, 11, 34, "Print",
 InitializationCell->True],
Cell[168490, 3732, 2138, 42, 34, "Print",
 InitializationCell->True],
Cell[170631, 3776, 783, 11, 34, "Print",
 InitializationCell->True],
Cell[171417, 3789, 2119, 50, 63, "Print",
 InitializationCell->True],
Cell[173539, 3841, 1113, 19, 34, "Print",
 InitializationCell->True],
Cell[174655, 3862, 1062, 18, 34, "Print",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[175790, 3888, 99, 1, 106, "Section"],
Cell[CellGroupData[{
Cell[175914, 3893, 104, 1, 72, "Subsection"],
Cell[CellGroupData[{
Cell[176043, 3898, 615, 15, 133, "Input"],
Cell[CellGroupData[{
Cell[176683, 3917, 232, 5, 34, "Print"],
Cell[176918, 3924, 234, 5, 34, "Print"],
Cell[177155, 3931, 292, 6, 34, "Print"],
Cell[177450, 3939, 314, 6, 34, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[177825, 3952, 94, 1, 72, "Subsection"],
Cell[CellGroupData[{
Cell[177944, 3957, 1401, 36, 133, "Input"],
Cell[CellGroupData[{
Cell[179370, 3997, 445, 10, 34, "Print"],
Cell[179818, 4009, 453, 10, 34, "Print"],
Cell[180274, 4021, 477, 10, 34, "Print"],
Cell[180754, 4033, 469, 10, 34, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

